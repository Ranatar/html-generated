<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—É–∑–Ω–∏—Ü–∞ –§–µ–∞–Ω–æ—Ä–∞: –°–æ–∑–¥–∞–Ω–∏–µ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .game-container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #444;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(100, 100, 255, 0.3);
        }
        
        h1 {
            text-align: center;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .stats-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #555;
            border-radius: 5px;
        }
        
        .stat-group h3 {
            color: #87ceeb;
            margin-bottom: 10px;
            text-shadow: 0 0 5px rgba(135, 206, 235, 0.5);
        }
        
        .stat {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }
        
        .stat-value {
            color: #ffd700;
            font-weight: bold;
        }
        
        .game-text {
            background: rgba(0, 0, 0, 0.4);
            padding: 25px;
            border-radius: 5px;
            margin-bottom: 25px;
            line-height: 1.8;
            font-size: 1.1em;
            border: 1px solid #333;
        }
        
        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .choice-btn {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            border: 1px solid #4a69bd;
            padding: 15px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            text-align: left;
        }
        
        .choice-btn:hover {
            background: linear-gradient(135deg, #2a5298, #3a62a8);
            box-shadow: 0 0 15px rgba(74, 105, 189, 0.5);
            transform: translateX(5px);
        }
        
        .phase-indicator {
            text-align: center;
            color: #87ceeb;
            margin-bottom: 20px;
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .silmaril-glow {
            display: inline-block;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ffd700; }
            to { text-shadow: 0 0 20px #fff, 0 0 30px #ffd700, 0 0 40px #ffd700; }
        }
        
        .ending-title {
            font-size: 2em;
            color: #ffd700;
            text-align: center;
            margin: 20px 0;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }
        
        .restart-btn {
            display: block;
            margin: 30px auto;
            background: linear-gradient(135deg, #8b0000, #dc143c);
            color: white;
            border: 2px solid #ff6347;
            padding: 15px 40px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
        }
        
        .restart-btn:hover {
            background: linear-gradient(135deg, #dc143c, #ff1744);
            box-shadow: 0 0 20px rgba(220, 20, 60, 0.5);
        }
        
        .event-alert {
            background: linear-gradient(135deg, #4a0080, #6a0dad);
            border: 2px solid #9370db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 5px rgba(147, 112, 219, 0.5); }
            50% { box-shadow: 0 0 20px rgba(147, 112, 219, 0.8); }
            100% { box-shadow: 0 0 5px rgba(147, 112, 219, 0.5); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>‚öíÔ∏è –ö—É–∑–Ω–∏—Ü–∞ –§–µ–∞–Ω–æ—Ä–∞ ‚öíÔ∏è</h1>
        <div class="phase-indicator" id="phase">–§–∞–∑–∞: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</div>
        
        <div class="stats-panel">
            <div class="stat-group">
                <h3>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –§–µ–∞–Ω–æ—Ä–∞</h3>
                <div class="stat">
                    <span>–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ:</span>
                    <span class="stat-value" id="skill">50</span>
                </div>
                <div class="stat">
                    <span>–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ:</span>
                    <span class="stat-value" id="inspiration">50</span>
                </div>
                <div class="stat">
                    <span>–ì–æ—Ä–¥—ã–Ω—è:</span>
                    <span class="stat-value" id="pride">30</span>
                </div>
                <div class="stat">
                    <span>–°–≤—è–∑—å —Å –í–∞–ª–∞—Ä:</span>
                    <span class="stat-value" id="valar">70</span>
                </div>
                <div class="stat">
                    <span>–£—Å—Ç–∞–ª–æ—Å—Ç—å:</span>
                    <span class="stat-value" id="fatigue">0</span>
                </div>
            </div>
            
            <div class="stat-group">
                <h3>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤</h3>
                <div class="stat">
                    <span>–Ø—Ä–∫–æ—Å—Ç—å —Å–≤–µ—Ç–∞:</span>
                    <span class="stat-value" id="brightness">0</span>
                </div>
                <div class="stat">
                    <span>–ß–∏—Å—Ç–æ—Ç–∞:</span>
                    <span class="stat-value" id="purity">0</span>
                </div>
                <div class="stat">
                    <span>–ú–∞–≥–∏—á–µ—Å–∫–∞—è —Å–∏–ª–∞:</span>
                    <span class="stat-value" id="magic">0</span>
                </div>
                <div class="stat">
                    <span>–ü—Ä–æ—á–Ω–æ—Å—Ç—å:</span>
                    <span class="stat-value" id="durability">0</span>
                </div>
                <div class="stat">
                    <span>–ì–∞—Ä–º–æ–Ω–∏—è:</span>
                    <span class="stat-value" id="harmony">0</span>
                </div>
            </div>
        </div>
        
        <div class="game-text" id="gameText">
            <p>–í—ã - –§–µ–∞–Ω–æ—Ä, –≤–µ–ª–∏—á–∞–π—à–∏–π –∏–∑ —ç–ª—å—Ñ–∏–π—Å–∫–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤. –í –≤–∞—à–µ–π –∫—É–∑–Ω–∏—Ü–µ –≤ –¢–∏—Ä–∏–æ–Ω–µ –≤—ã –≥–æ—Ç–æ–≤–∏—Ç–µ—Å—å –∫ —Å–æ–∑–¥–∞–Ω–∏—é –≤–µ–ª–∏—á–∞–π—à–µ–≥–æ —Ç–≤–æ—Ä–µ–Ω–∏—è –≤—Å–µ—Ö –≤—Ä–µ–º—ë–Ω - –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤. –°–≤–µ—Ç –î–≤—É—Ö –î—Ä–µ–≤ –í–∞–ª–∏–Ω–æ—Ä–∞ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –≤–∞—Å –Ω–∞ —ç—Ç–æ—Ç –±–µ—Å–ø—Ä–µ—Ü–µ–¥–µ–Ω—Ç–Ω—ã–π –ø–æ–¥–≤–∏–≥ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞.</p>
            <p>–ù–æ –ø–æ–º–Ω–∏—Ç–µ: –∫–∞–∂–¥–æ–µ –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∞–º–∏ –∫–∞–º–Ω–∏, –Ω–æ –∏ –Ω–∞ –≤–∞—à—É —Å—É–¥—å–±—É –∏ —Å—É–¥—å–±—É –≤—Å–µ–≥–æ –ê—Ä–¥—ã...</p>
        </div>
        
        <div class="choices" id="choices"></div>
    </div>
    
    <script>
        // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let gameState = {
            phase: 0,
            step: 0,
            // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –§–µ–∞–Ω–æ—Ä–∞
            skill: 50,
            inspiration: 50,
            pride: 30,
            valar: 70,
            fatigue: 0,
            // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤
            brightness: 0,
            purity: 0,
            magic: 0,
            durability: 0,
            harmony: 0,
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏
            materials: [],
            methods: [],
            events: [],
            oathTaken: false,
            helpFromValar: false,
            secretKnowledge: false
        };
        
        // –§–∞–∑—ã –∏–≥—Ä—ã
        const phases = [
            '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞',
            '–í—ã–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤',
            '–ü–µ—Ä–≤—ã–π –°–∏–ª—å–º–∞—Ä–∏–ª',
            '–í—Ç–æ—Ä–æ–π –°–∏–ª—å–º–∞—Ä–∏–ª',
            '–¢—Ä–µ—Ç–∏–π –°–∏–ª—å–º–∞—Ä–∏–ª',
            '–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞',
            '–°—É–¥—å–±–∞'
        ];
        
        // –ò–≥—Ä–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
        const scenarios = {
            0: { // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
                0: {
                    text: `<p>–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤–µ–ª–∏–∫–æ–π —Ä–∞–±–æ—Ç—ã –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è. –ß—Ç–æ –±—É–¥–µ—Ç –≤–∞—à–∏–º –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º?</p>`,
                    choices: [
                        {
                            text: "–ü–æ–º–æ–ª–∏—Ç—å—Å—è –í–∞–ª–∞—Ä –∏ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –∏—Ö –±–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏—è",
                            effect: () => {
                                gameState.valar += 20;
                                gameState.inspiration += 10;
                                gameState.pride -= 10;
                                gameState.helpFromValar = true;
                            },
                            next: 1
                        },
                        {
                            text: "–ò–∑—É—á–∏—Ç—å –¥—Ä–µ–≤–Ω–∏–µ –º–∞–Ω—É—Å–∫—Ä–∏–ø—Ç—ã –ê—É–ª–µ –æ —Ç–∞–π–Ω–∞—Ö —Ç–≤–æ—Ä–µ–Ω–∏—è",
                            effect: () => {
                                gameState.skill += 15;
                                gameState.inspiration += 5;
                                gameState.secretKnowledge = true;
                            },
                            next: 1
                        },
                        {
                            text: "–ü–æ–ª–æ–∂–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–ª—ã –∏ —Ç–∞–ª–∞–Ω—Ç",
                            effect: () => {
                                gameState.pride += 20;
                                gameState.skill += 10;
                                gameState.valar -= 15;
                            },
                            next: 1
                        },
                        {
                            text: "–ú–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —É –∫–æ—Ä–Ω–µ–π –î—Ä–µ–≤, –≤–ø–∏—Ç—ã–≤–∞—è –∏—Ö —Å–≤–µ—Ç",
                            effect: () => {
                                gameState.inspiration += 20;
                                gameState.brightness += 10;
                                gameState.harmony += 5;
                            },
                            next: 1
                        }
                    ]
                },
                1: {
                    text: `<p>–í–∞—à–∞ –∂–µ–Ω–∞ –ù–µ—Ä–¥–∞–Ω–µ–ª—å –±–µ—Å–ø–æ–∫–æ–∏—Ç—Å—è –æ –≤–∞—à–µ–º –∑–∞–º—ã—Å–ª–µ. –û–Ω–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç, —á—Ç–æ —ç—Ç–æ —Ç–≤–æ—Ä–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–µ—Å—Ç–∏ –±–µ–¥—É. –ö–∞–∫ –≤—ã –æ—Ç–≤–µ—Ç–∏—Ç–µ?</p>`,
                    choices: [
                        {
                            text: "–í—ã—Å–ª—É—à–∞—Ç—å –µ—ë –æ–ø–∞—Å–µ–Ω–∏—è –∏ –æ–±–µ—â–∞—Ç—å –±—ã—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–º",
                            effect: () => {
                                gameState.pride -= 5;
                                gameState.harmony += 10;
                                gameState.fatigue -= 5;
                            },
                            next: 2
                        },
                        {
                            text: "–£–±–µ–¥–∏—Ç—å –µ—ë –≤ –≤–µ–ª–∏—á–∏–∏ –∑–∞–º—ã—Å–ª–∞ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∏—Å–∫–∞",
                            effect: () => {
                                gameState.pride += 10;
                                gameState.inspiration += 10;
                            },
                            next: 2
                        },
                        {
                            text: "–ü—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ—ë —Å–ª–æ–≤–∞ - –∂–µ–Ω—â–∏–Ω—ã –Ω–µ –ø–æ–Ω–∏–º–∞—é—Ç –∏—Å–∫—É—Å—Å—Ç–≤–∞",
                            effect: () => {
                                gameState.pride += 15;
                                gameState.valar -= 10;
                                gameState.harmony -= 15;
                            },
                            next: 2
                        }
                    ]
                },
                2: {
                    text: `<p class="event-alert">‚ö° –°–û–ë–´–¢–ò–ï: –ú–∞–Ω–≤—ç –ø–æ—Å—ã–ª–∞–µ—Ç –≤–∞–º –≤–∏–¥–µ–Ω–∏–µ!</p>
                    <p>–í–æ —Å–Ω–µ –≤—ã –≤–∏–¥–∏—Ç–µ —Ç—Ä–∏ —Å–∏—è—é—â–∏—Ö –∫–∞–º–Ω—è, –Ω–æ —Ç–∞–∫–∂–µ —Ç–µ–Ω—å –∏ –æ–≥–æ–Ω—å. –ö–∞–∫ –≤—ã –∏—Å—Ç–æ–ª–∫—É–µ—Ç–µ —ç—Ç–æ –≤–∏–¥–µ–Ω–∏–µ?</p>`,
                    choices: [
                        {
                            text: "–≠—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ - –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞—â–∏—Ç—É –¥–ª—è –∫–∞–º–Ω–µ–π",
                            effect: () => {
                                gameState.durability += 15;
                                gameState.magic += 10;
                                gameState.valar += 5;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–≠—Ç–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –º–æ–µ–π –≤–æ–ª–∏ - —è –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤–∑–æ–π—Ç–∏ –≤–∏–¥–µ–Ω–∏–µ",
                            effect: () => {
                                gameState.pride += 15;
                                gameState.skill += 10;
                                gameState.valar -= 5;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–≠—Ç–æ –∑–Ω–∞–∫ –æ–¥–æ–±—Ä–µ–Ω–∏—è, –Ω–æ —Å –ø—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏–µ–º –æ —Ü–µ–Ω–µ",
                            effect: () => {
                                gameState.inspiration += 10;
                                gameState.harmony += 10;
                            },
                            next: 'nextPhase'
                        }
                    ]
                }
            },
            1: { // –í—ã–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
                0: {
                    text: `<p>–ù–∞—Å—Ç–∞–ª–æ –≤—Ä–µ–º—è –≤—ã–±—Ä–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤. –ß—Ç–æ —Å—Ç–∞–Ω–µ—Ç –∏—Ö –æ—Å–Ω–æ–≤–æ–π?</p>`,
                    choices: [
                        {
                            text: "–ß–∏—Å—Ç–µ–π—à–∏–π –∫—Ä–∏—Å—Ç–∞–ª–ª –∏–∑ –ø–µ—â–µ—Ä –§–æ—Ä–º–µ–Ω–æ—Å–∞",
                            effect: () => {
                                gameState.purity += 20;
                                gameState.durability += 10;
                                gameState.materials.push('crystal');
                            },
                            next: 1
                        },
                        {
                            text: "–ê–¥–∞–º–∞–Ω—Ç - –Ω–µ—Å–æ–∫—Ä—É—à–∏–º–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ –∑–µ–º–ª–∏",
                            effect: () => {
                                gameState.durability += 25;
                                gameState.brightness += 5;
                                gameState.materials.push('adamant');
                            },
                            next: 1
                        },
                        {
                            text: "–°–ø–ª–∞–≤ –º–∏—Ñ—Ä–∏–ª–∞ –∏ –∑–≤—ë–∑–¥–Ω–æ–π –ø—ã–ª–∏",
                            effect: () => {
                                gameState.magic += 20;
                                gameState.brightness += 15;
                                gameState.materials.push('mithril');
                            },
                            next: 1
                        },
                        {
                            text: "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ, –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –≤ –º–µ—Ç–µ–æ—Ä–∏—Ç–µ",
                            effect: () => {
                                gameState.magic += 15;
                                gameState.purity += 10;
                                gameState.durability += 15;
                                gameState.pride += 10;
                                gameState.materials.push('meteor');
                            },
                            next: 1
                        }
                    ]
                },
                1: {
                    text: `<p>–ö–∞–∫ –≤—ã –±—É–¥–µ—Ç–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å–≤–µ—Ç –î—Ä–µ–≤?</p>`,
                    choices: [
                        {
                            text: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤—è—â–µ–Ω–Ω—ã–µ —Å–æ—Å—É–¥—ã –í–∞—Ä–¥—ã",
                            effect: () => {
                                gameState.brightness += 25;
                                gameState.purity += 15;
                                gameState.valar += 10;
                                gameState.methods.push('varda_vessels');
                            },
                            next: 2
                        },
                        {
                            text: "–°–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏–Ω–∑—ã –¥–ª—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ —Å–≤–µ—Ç–∞",
                            effect: () => {
                                gameState.brightness += 20;
                                gameState.skill += 10;
                                gameState.pride += 5;
                                gameState.methods.push('lenses');
                            },
                            next: 2
                        },
                        {
                            text: "–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–∏—Ç—É–∞–ª –≤ —á–∞—Å —Å–º–µ—à–µ–Ω–∏—è —Å–≤–µ—Ç–∞ –æ–±–æ–∏—Ö –î—Ä–µ–≤",
                            effect: () => {
                                gameState.brightness += 30;
                                gameState.harmony += 20;
                                gameState.fatigue += 10;
                                gameState.methods.push('ritual');
                            },
                            next: 2
                        }
                    ]
                },
                2: {
                    text: `<p class="event-alert">‚ö° –°–û–ë–´–¢–ò–ï: –ú–µ–ª—å–∫–æ—Ä –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–º–æ—â—å!</p>
                    <p>–ú–µ–ª—å–∫–æ—Ä —Ç–∞–π–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫ –≤–∞–º –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∑–Ω–∞–Ω–∏—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç–≤–æ—Ä–µ–Ω–∏–π. –ß—Ç–æ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ?</p>`,
                    choices: [
                        {
                            text: "–†–µ—à–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –∏ —Å–æ–æ–±—â–∏—Ç—å –í–∞–ª–∞—Ä",
                            effect: () => {
                                gameState.valar += 20;
                                gameState.pride -= 10;
                                gameState.purity += 15;
                                gameState.events.push('melkor_rejected');
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–í—ã—Å–ª—É—à–∞—Ç—å, –Ω–æ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–æ–º–æ—â—å",
                            effect: () => {
                                gameState.skill += 10;
                                gameState.pride += 5;
                                gameState.valar -= 5;
                                gameState.events.push('melkor_listened');
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–ü—Ä–∏–Ω—è—Ç—å –∑–Ω–∞–Ω–∏—è - —Ü–µ–ª—å –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞",
                            effect: () => {
                                gameState.skill += 20;
                                gameState.magic += 15;
                                gameState.valar -= 30;
                                gameState.purity -= 20;
                                gameState.pride += 20;
                                gameState.events.push('melkor_helped');
                            },
                            next: 'nextPhase'
                        }
                    ]
                }
            },
            2: { // –ü–µ—Ä–≤—ã–π –°–∏–ª—å–º–∞—Ä–∏–ª
                0: {
                    text: `<p>–í—ã –Ω–∞—á–∏–Ω–∞–µ—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –°–∏–ª—å–º–∞—Ä–∏–ª–∞. –ö—É–∑–Ω–∏—Ü–∞ —Ä–∞—Å–∫–∞–ª–µ–Ω–∞, –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≥–æ—Ç–æ–≤—ã. –ö–∞–∫—É—é —Ç–µ—Ö–Ω–∏–∫—É –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ?</p>`,
                    choices: [
                        {
                            text: "–ú–µ–¥–ª–µ–Ω–Ω–∞—è –∫—Ä–∏—Å—Ç–∞–ª–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º –Ω–∞—Å—ã—â–µ–Ω–∏–µ–º —Å–≤–µ—Ç–æ–º",
                            effect: () => {
                                gameState.purity += 15;
                                gameState.brightness += 10;
                                gameState.fatigue += 15;
                            },
                            next: 1
                        },
                        {
                            text: "–í–∑—Ä—ã–≤–Ω–æ–µ —Å–ª–∏—è–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–æ–º–µ–Ω—Ç –Ω–∞–∏–≤—ã—Å—à–µ–π —Å–∏–ª—ã",
                            effect: () => {
                                gameState.magic += 20;
                                gameState.durability += 10;
                                gameState.fatigue += 20;
                                gameState.pride += 10;
                            },
                            next: 1
                        },
                        {
                            text: "–ü–µ–Ω–∏–µ –ø–µ—Å–Ω–∏ —Ç–≤–æ—Ä–µ–Ω–∏—è, –∫–∞–∫ –¥–µ–ª–∞–ª –ò–ª—É–≤–∞—Ç–∞—Ä",
                            effect: () => {
                                gameState.harmony += 25;
                                gameState.magic += 15;
                                gameState.inspiration += 10;
                            },
                            next: 1
                        }
                    ]
                },
                1: {
                    text: `<p>–ü–µ—Ä–≤—ã–π –∫–∞–º–µ–Ω—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å—Å—è, –Ω–æ –ø—Ä–æ—Ü–µ—Å—Å –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω! –ß—Ç–æ –¥–µ–ª–∞—Ç—å?</p>`,
                    choices: [
                        {
                            text: "–°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∂–∏–∑–Ω–µ–Ω–Ω–æ–π —Å–∏–ª–æ–π",
                            effect: () => {
                                gameState.fatigue += 25;
                                gameState.durability += 15;
                                gameState.magic += 10;
                            },
                            next: 2
                        },
                        {
                            text: "–ü—Ä–∏–∑–≤–∞—Ç—å –Ω–∞ –ø–æ–º–æ—â—å —Å–∏–ª—É –î—Ä–µ–≤ –Ω–∞–ø—Ä—è–º—É—é",
                            effect: () => {
                                gameState.brightness += 20;
                                gameState.purity += 10;
                                gameState.valar -= 10;
                            },
                            next: 2
                        },
                        {
                            text: "–ü–æ–∑–≤–æ–ª–∏—Ç—å —Ö–∞–æ—Å—É –Ω–∞–π—Ç–∏ —Å–≤–æ–π –ø–æ—Ä—è–¥–æ–∫",
                            effect: () => {
                                gameState.harmony += 15;
                                gameState.magic += 25;
                                gameState.purity -= 5;
                            },
                            next: 2
                        }
                    ]
                },
                2: {
                    text: `<p>‚ú® –ü–µ—Ä–≤—ã–π –°–∏–ª—å–º–∞—Ä–∏–ª —Å–æ–∑–¥–∞–Ω! –û–Ω —Å–∏—è–µ—Ç –Ω–µ–≤–∏–¥–∞–Ω–Ω—ã–º —Å–≤–µ—Ç–æ–º. –ö–∞–∫ –≤—ã –µ–≥–æ –Ω–∞–∑–æ–≤—ë—Ç–µ?</p>`,
                    choices: [
                        {
                            text: "–≠–ª–ª–µ–Ω–Ω–∞ - –ó–≤–µ–∑–¥–∞ –ù–∞–¥–µ–∂–¥—ã",
                            effect: () => {
                                gameState.inspiration += 15;
                                gameState.harmony += 10;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–§–µ–∞–Ω–∞—Ä–æ - –≤ —á–µ—Å—Ç—å —Å–µ–±—è",
                            effect: () => {
                                gameState.pride += 25;
                                gameState.skill += 5;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–ò–ª—É–≤–∞–æ - –≤ —á–µ—Å—Ç—å –ï–¥–∏–Ω–æ–≥–æ",
                            effect: () => {
                                gameState.valar += 15;
                                gameState.purity += 10;
                            },
                            next: 'nextPhase'
                        }
                    ]
                }
            },
            3: { // –í—Ç–æ—Ä–æ–π –°–∏–ª—å–º–∞—Ä–∏–ª
                0: {
                    text: `<p>–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –°–∏–ª—å–º–∞—Ä–∏–ª–∞. –í–∞—à–∏ —Å—ã–Ω–æ–≤—å—è –ø—Ä–æ—Å—è—Ç –ø–æ–∑–≤–æ–ª–∏—Ç—å –∏–º –ø–æ–º–æ—á—å. –ß—Ç–æ –≤—ã —Ä–µ—à–∏—Ç–µ?</p>`,
                    choices: [
                        {
                            text: "–ü–æ–∑–≤–æ–ª–∏—Ç—å –≤—Å–µ–º —Å–µ–º–µ—Ä—ã–º —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ",
                            effect: () => {
                                gameState.harmony += 20;
                                gameState.fatigue -= 10;
                                gameState.skill -= 5;
                            },
                            next: 1
                        },
                        {
                            text: "–í–∑—è—Ç—å —Ç–æ–ª—å–∫–æ –ú–∞—ç–¥—Ä–æ—Å–∞ - —Å—Ç–∞—Ä—à–µ–≥–æ –∏ –º—É–¥—Ä–µ–π—à–µ–≥–æ",
                            effect: () => {
                                gameState.skill += 10;
                                gameState.fatigue -= 5;
                                gameState.harmony += 5;
                            },
                            next: 1
                        },
                        {
                            text: "–†–∞–±–æ—Ç–∞—Ç—å –≤ –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ - —ç—Ç–æ —Ç–æ–ª—å–∫–æ –º–æ—ë —Ç–≤–æ—Ä–µ–Ω–∏–µ",
                            effect: () => {
                                gameState.pride += 15;
                                gameState.skill += 15;
                                gameState.fatigue += 10;
                            },
                            next: 1
                        }
                    ]
                },
                1: {
                    text: `<p class="event-alert">‚ö° –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –°–û–ë–´–¢–ò–ï!</p>
                    <p>–í —Ä–∞–∑–≥–∞—Ä —Ä–∞–±–æ—Ç—ã –∫—É–∑–Ω–∏—Ü–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä—É—à–∏—Ç—å—Å—è –æ—Ç –≤—ã–¥–µ–ª—è–µ–º–æ–π —ç–Ω–µ—Ä–≥–∏–∏! –ß—Ç–æ –≤–∞–∂–Ω–µ–µ —Å–ø–∞—Å—Ç–∏?</p>`,
                    choices: [
                        {
                            text: "–°–ø–∞—Å—Ç–∏ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π –∫–∞–º–µ–Ω—å –ª—é–±–æ–π —Ü–µ–Ω–æ–π",
                            effect: () => {
                                gameState.durability += 20;
                                gameState.fatigue += 30;
                                gameState.skill += 10;
                                gameState.events.push('saved_stone');
                            },
                            next: 2
                        },
                        {
                            text: "–ó–∞—â–∏—Ç–∏—Ç—å –ø–æ–º–æ—â–Ω–∏–∫–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã",
                            effect: () => {
                                gameState.harmony += 25;
                                gameState.valar += 10;
                                gameState.durability -= 10;
                                gameState.events.push('saved_people');
                            },
                            next: 2
                        },
                        {
                            text: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ –∫–∞–∫ —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è",
                            effect: () => {
                                gameState.magic += 30;
                                gameState.pride += 20;
                                gameState.purity -= 10;
                                gameState.events.push('used_destruction');
                            },
                            next: 2
                        }
                    ]
                },
                2: {
                    text: `<p>‚ú® –í—Ç–æ—Ä–æ–π –°–∏–ª—å–º–∞—Ä–∏–ª –∑–∞–≤–µ—Ä—à—ë–Ω! –û–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–µ—Ä–≤–æ–≥–æ. –í —á—ë–º –µ–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å?</p>`,
                    choices: [
                        {
                            text: "–û–Ω –ø—É–ª—å—Å–∏—Ä—É–µ—Ç –∫–∞–∫ –∂–∏–≤–æ–µ —Å–µ—Ä–¥—Ü–µ",
                            effect: () => {
                                gameState.magic += 15;
                                gameState.harmony += 10;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–ï–≥–æ —Å–≤–µ—Ç –º–æ–∂–µ—Ç –∏—Å—Ü–µ–ª—è—Ç—å –∏–ª–∏ —Ä–∞–Ω–∏—Ç—å",
                            effect: () => {
                                gameState.magic += 20;
                                gameState.durability += 10;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–û–Ω –æ—Ç—Ä–∞–∂–∞–µ—Ç –¥—É—à—É —Å–º–æ—Ç—Ä—è—â–µ–≥–æ",
                            effect: () => {
                                gameState.purity += 15;
                                gameState.magic += 10;
                            },
                            next: 'nextPhase'
                        }
                    ]
                }
            },
            4: { // –¢—Ä–µ—Ç–∏–π –°–∏–ª—å–º–∞—Ä–∏–ª
                0: {
                    text: `<p>–î–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ –°–∏–ª—å–º–∞—Ä–∏–ª–∞ –ø–æ—á—Ç–∏ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å —Å–∏–ª. –í–∞—Ä–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–≤–æ—é –ø–æ–º–æ—â—å. –ü—Ä–∏–º–µ—Ç–µ –ª–∏ –≤—ã –µ—ë?</p>`,
                    choices: [
                        {
                            text: "–° –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é –ø—Ä–∏–Ω—è—Ç—å –ø–æ–º–æ—â—å –ó–≤—ë–∑–¥–Ω–æ–π –ö–æ—Ä–æ–ª–µ–≤—ã",
                            effect: () => {
                                gameState.brightness += 30;
                                gameState.valar += 20;
                                gameState.pride -= 15;
                                gameState.fatigue -= 20;
                            },
                            next: 1
                        },
                        {
                            text: "–í–µ–∂–ª–∏–≤–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è - —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–æ—ë —Ç–≤–æ—Ä–µ–Ω–∏–µ",
                            effect: () => {
                                gameState.pride += 20;
                                gameState.fatigue += 20;
                                gameState.skill += 10;
                            },
                            next: 1
                        },
                        {
                            text: "–ü—Ä–∏–Ω—è—Ç—å –ø–æ–º–æ—â—å, –Ω–æ —Ç–∞–π–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –µ—ë –¥–∞—Ä",
                            effect: () => {
                                gameState.brightness += 20;
                                gameState.magic += 15;
                                gameState.valar -= 15;
                                gameState.pride += 10;
                            },
                            next: 1
                        }
                    ]
                },
                1: {
                    text: `<p>–í—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ, —á—Ç–æ —Ç—Ä–µ—Ç–∏–π –∫–∞–º–µ–Ω—å –±—É–¥–µ—Ç –æ—Å–æ–±–µ–Ω–Ω—ã–º. –ö–∞–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É—Å–∏–ª–∏—Ç—å?</p>`,
                    choices: [
                        {
                            text: "–í–ª–æ–∂–∏—Ç—å –≤ –Ω–µ–≥–æ –≤—Å—é –æ—Å—Ç–∞–≤—à—É—é—Å—è –ª—é–±–æ–≤—å –∫ –ê—Ä–¥–µ",
                            effect: () => {
                                gameState.harmony += 30;
                                gameState.purity += 20;
                                gameState.fatigue += 15;
                            },
                            next: 2
                        },
                        {
                            text: "–°–¥–µ–ª–∞—Ç—å –µ–≥–æ —Å–∏–ª—å–Ω–µ–π—à–∏–º –∏–∑ —Ç—Ä—ë—Ö",
                            effect: () => {
                                gameState.magic += 25;
                                gameState.durability += 20;
                                gameState.pride += 15;
                                gameState.fatigue += 25;
                            },
                            next: 2
                        },
                        {
                            text: "–°–æ–∑–¥–∞—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø–µ—Ä–≤—ã–º–∏ –¥–≤—É–º—è",
                            effect: () => {
                                gameState.harmony += 20;
                                gameState.brightness += 15;
                                gameState.purity += 15;
                            },
                            next: 2
                        }
                    ]
                },
                2: {
                    text: `<p>‚ú® –¢—Ä–µ—Ç–∏–π –°–∏–ª—å–º–∞—Ä–∏–ª –≥–æ—Ç–æ–≤! –¢—Ä–∏ –∫–∞–º–Ω—è —Å–æ–∑–¥–∞–Ω—ã! –ù–æ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å—Ç—Ä–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—á—É–≤—Å—Ç–≤–∏–µ...</p>`,
                    choices: [
                        {
                            text: "–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞—â–∏—Ç–Ω—ã–µ —á–∞—Ä—ã",
                            effect: () => {
                                gameState.durability += 20;
                                gameState.magic += 15;
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–ü–æ–∫–∞–∑–∞—Ç—å —Ç–≤–æ—Ä–µ–Ω–∏–µ –≤—Å–µ–º—É –í–∞–ª–∏–Ω–æ—Ä—É",
                            effect: () => {
                                gameState.pride += 25;
                                gameState.inspiration += 10;
                                gameState.events.push('showed_all');
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–°–ø—Ä—è—Ç–∞—Ç—å –∏—Ö –∏ –Ω–∏–∫–æ–º—É –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç—å",
                            effect: () => {
                                gameState.purity += 10;
                                gameState.valar -= 10;
                                gameState.events.push('hidden');
                            },
                            next: 'nextPhase'
                        }
                    ]
                }
            },
            5: { // –§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
                0: {
                    text: `<p>–°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ —Ç—Ä–µ–±—É—é—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ú–µ–ª—å–∫–æ—Ä –≤–æ—Å—Ö–∏—â–∞–µ—Ç—Å—è –≤–∞—à–µ–π —Ä–∞–±–æ—Ç–æ–π –∏ –ø—Ä–æ—Å–∏—Ç –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞–º–Ω–∏ –±–ª–∏–∂–µ...</p>`,
                    choices: [
                        {
                            text: "–ü–æ–∫–∞–∑–∞—Ç—å –∏–∑–¥–∞–ª–µ–∫–∞, –Ω–µ –ø–æ–∑–≤–æ–ª—è—è –ø—Ä–∏–∫–æ—Å–Ω—É—Ç—å—Å—è",
                            effect: () => {
                                gameState.pride += 10;
                                gameState.events.push('melkor_shown');
                            },
                            next: 1
                        },
                        {
                            text: "–†–µ–∑–∫–æ –æ—Ç–∫–∞–∑–∞—Ç—å –∏ –æ–±–≤–∏–Ω–∏—Ç—å –≤ –∑–ª—ã—Ö –Ω–∞–º–µ—Ä–µ–Ω–∏—è—Ö",
                            effect: () => {
                                gameState.valar += 10;
                                gameState.pride += 15;
                                gameState.events.push('melkor_accused');
                            },
                            next: 1
                        },
                        {
                            text: "–°–æ–∑–¥–∞—Ç—å –∏–ª–ª—é–∑–∏—é –∫–∞–º–Ω–µ–π –¥–ª—è –ø–æ–∫–∞–∑–∞",
                            effect: () => {
                                gameState.skill += 15;
                                gameState.magic += 10;
                                gameState.events.push('melkor_tricked');
                            },
                            next: 1
                        }
                    ]
                },
                1: {
                    text: `<p>–ú–∞–Ω–≤—ç –ø—Ä–æ—Å–∏—Ç –≤–∞—Å –ø—Ä–∏–Ω–µ—Å—Ç–∏ –∫–ª—è—Ç–≤—É –æ —Å—É–¥—å–±–µ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤. –ß—Ç–æ –≤—ã –ø–æ–∫–ª—è–Ω—ë—Ç–µ—Å—å?</p>`,
                    choices: [
                        {
                            text: "–ü–æ–∫–ª—è—Å—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö —Ç–æ–ª—å–∫–æ –≤–æ –±–ª–∞–≥–æ",
                            effect: () => {
                                gameState.valar += 25;
                                gameState.purity += 20;
                                gameState.pride -= 10;
                            },
                            next: 2
                        },
                        {
                            text: "–ü–æ–∫–ª—è—Å—Ç—å—Å—è, —á—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–∫–æ—Å–Ω—ë—Ç—Å—è –∫ –Ω–∏–º –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è",
                            effect: () => {
                                gameState.pride += 30;
                                gameState.valar -= 20;
                                gameState.oathTaken = true;
                                gameState.events.push('terrible_oath');
                            },
                            next: 2
                        },
                        {
                            text: "–û—Ç–∫–∞–∑–∞—Ç—å—Å—è –¥–∞–≤–∞—Ç—å –∫–∞–∫–∏–µ-–ª–∏–±–æ –∫–ª—è—Ç–≤—ã",
                            effect: () => {
                                gameState.harmony += 15;
                                gameState.valar -= 5;
                            },
                            next: 2
                        }
                    ]
                },
                2: {
                    text: `<p class="event-alert">‚ö° –§–ò–ù–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï!</p>
                    <p>–ì–¥–µ –≤—ã –±—É–¥–µ—Ç–µ —Ö—Ä–∞–Ω–∏—Ç—å –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã?</p>`,
                    choices: [
                        {
                            text: "–í –∂–µ–ª–µ–∑–Ω–æ–π –∫–æ—Ä–æ–Ω–µ, –≤—Å–µ–≥–¥–∞ –ø—Ä–∏ —Å–µ–±–µ",
                            effect: () => {
                                gameState.pride += 30;
                                gameState.durability += 10;
                                gameState.events.push('iron_crown');
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–í —Å–≤—è—â–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ–¥ –∑–∞—â–∏—Ç–æ–π –í–∞–ª–∞—Ä",
                            effect: () => {
                                gameState.valar += 30;
                                gameState.purity += 15;
                                gameState.events.push('valar_vault');
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–†–∞–∑–¥–µ–ª–∏—Ç—å –º–µ–∂–¥—É —Ç—Ä–µ–º—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏",
                            effect: () => {
                                gameState.harmony += 20;
                                gameState.durability += 15;
                                gameState.events.push('separated');
                            },
                            next: 'nextPhase'
                        },
                        {
                            text: "–í —Ç–∞–π–Ω–æ–º –º–µ—Å—Ç–µ, –∏–∑–≤–µ—Å—Ç–Ω–æ–º —Ç–æ–ª—å–∫–æ –≤–∞–º",
                            effect: () => {
                                gameState.pride += 20;
                                gameState.magic += 10;
                                gameState.events.push('secret_place');
                            },
                            next: 'nextPhase'
                        }
                    ]
                }
            }
        };
        
        // –ö–æ–Ω—Ü–æ–≤–∫–∏
        function determineEnding() {
            let ending = {
                title: '',
                text: '',
                type: ''
            };
            
            // –í—ã—á–∏—Å–ª—è–µ–º –æ–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            const totalSilmarilPower = gameState.brightness + gameState.purity + gameState.magic + gameState.durability + gameState.harmony;
            const totalCharacter = gameState.skill + gameState.inspiration - gameState.fatigue;
            
            // –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞
            if (totalSilmarilPower > 250 && gameState.valar > 80 && gameState.harmony > 80) {
                ending.title = "üåü –¢–í–û–†–ï–¶ –°–í–ï–¢–ê –ù–ï–ó–ê–ú–£–¢–ù–Å–ù–ù–û–ì–û";
                ending.text = `<p>–í—ã —Å–æ–∑–¥–∞–ª–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –≥–∞—Ä–º–æ–Ω–∏—é —Å –í–∞–ª–∞—Ä –∏ –≤—Å–µ–º –í–∞–ª–∏–Ω–æ—Ä–æ–º. –ö–∞–º–Ω–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤–µ–ª–∏—á–∞–π—à–∏–º —Å–æ–∫—Ä–æ–≤–∏—â–µ–º –ê—Ä–¥—ã, –∏—Ö —Å–≤–µ—Ç –∏—Å—Ü–µ–ª—è–µ—Ç –∏ –∑–∞—â–∏—â–∞–µ—Ç. –ú–µ–ª—å–∫–æ—Ä –Ω–µ —Å–º–µ–µ—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å—Å—è –∫ –Ω–∏–º, –∞ –≤–∞—à–µ –∏–º—è –Ω–∞–≤–µ–∫–∏ –∑–∞–ø–∏—Å–∞–Ω–æ —Å—Ä–µ–¥–∏ –≤–µ–ª–∏—á–∞–π—à–∏—Ö —Ç–≤–æ—Ä—Ü–æ–≤.</p>
                <p>–°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –í–∞–ª–∏–Ω–æ—Ä–µ, –æ—Å–≤–µ—â–∞—è –µ–≥–æ –ø–æ—Å–ª–µ –≥–∏–±–µ–ª–∏ –î—Ä–µ–≤. –í–æ–π–Ω—ã –∏ –∫–ª—è—Ç–≤—ã –Ω–µ –æ–º—Ä–∞—á–∞—é—Ç –∏—Å—Ç–æ—Ä–∏—é —ç–ª—å—Ñ–æ–≤. –í—ã –ø—Ä–æ–∂–∏–ª–∏ –¥–æ–ª–≥—É—é –∂–∏–∑–Ω—å –≤ –º–∏—Ä–µ –∏ —Å–ª–∞–≤–µ.</p>
                <p><strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤:</strong><br>
                –Ø—Ä–∫–æ—Å—Ç—å: ${gameState.brightness} | –ß–∏—Å—Ç–æ—Ç–∞: ${gameState.purity} | –ú–∞–≥–∏—è: ${gameState.magic}<br>
                –ü—Ä–æ—á–Ω–æ—Å—Ç—å: ${gameState.durability} | –ì–∞—Ä–º–æ–Ω–∏—è: ${gameState.harmony}</p>`;
                ending.type = 'legendary';
            }
            // –¢—Ä–∞–≥–∏—á–µ—Å–∫–∞—è –∫–∞–Ω–æ–Ω–∏—á–Ω–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞
            else if (gameState.oathTaken && gameState.pride > 60) {
                ending.title = "‚öîÔ∏è –ü–†–û–ö–õ–Ø–¢–ò–ï –§–ï–ê–ù–û–†–ê";
                ending.text = `<p>–í—ã —Å–æ–∑–¥–∞–ª–∏ –≤–µ–ª–∏—á–∞–π—à–∏–µ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–æ –≥–æ—Ä–¥—ã–Ω—è –∏ —Å—Ç—Ä–∞—à–Ω–∞—è –∫–ª—è—Ç–≤–∞ –æ–±—Ä–µ–∫–ª–∏ –≤–∞—Å –∏ –≤–∞—à —Ä–æ–¥ –Ω–∞ –≤–µ—á–Ω—ã–µ —Å—Ç—Ä–∞–¥–∞–Ω–∏—è. –ú–µ–ª—å–∫–æ—Ä –ø–æ—Ö–∏—Ç–∏—Ç –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã, —É–±—å—ë—Ç –≤–∞—à–µ–≥–æ –æ—Ç—Ü–∞ –∏ —É–Ω–∏—á—Ç–æ–∂–∏—Ç –î—Ä–µ–≤–∞.</p>
                <p>–í–∞—à–∞ –∫–ª—è—Ç–≤–∞ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –ò—Å—Ö–æ–¥—É –ù–æ–ª–¥–æ—Ä, –±—Ä–∞—Ç–æ—É–±–∏–π—Å—Ç–≤–µ–Ω–Ω—ã–º –≤–æ–π–Ω–∞–º –∏ –±–µ—Å—á–∏—Å–ª–µ–Ω–Ω—ã–º —Å–º–µ—Ä—Ç—è–º. –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã —Å—Ç–∞–Ω—É—Ç –ø—Ä–∏—á–∏–Ω–æ–π –≤–µ–ª–∏—á–∞–π—à–∏—Ö —Ç—Ä–∞–≥–µ–¥–∏–π –ü–µ—Ä–≤–æ–π –≠–ø–æ—Ö–∏.</p>
                <p>–í—ã –ø–∞–¥—ë—Ç–µ –≤ –±–∏—Ç–≤–µ, —Ç–∞–∫ –∏ –Ω–µ –≤–µ—Ä–Ω—É–≤ —Å–≤–æ—ë —Ç–≤–æ—Ä–µ–Ω–∏–µ, –∞ –≤–∞—à–∏ —Å—ã–Ω–æ–≤—å—è –ø—Ä–æ–¥–æ–ª–∂–∞—Ç –±–µ–∑–Ω–∞–¥—ë–∂–Ω—É—é –±–æ—Ä—å–±—É...</p>`;
                ending.type = 'tragic';
            }
            // –¢—ë–º–Ω–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞
            else if (gameState.events.includes('melkor_helped') && gameState.valar < 30) {
                ending.title = "üëÅÔ∏è –°–õ–£–ì–ê –¢–¨–ú–´";
                ending.text = `<p>–ü—Ä–∏–Ω—è–≤ –ø–æ–º–æ—â—å –ú–µ–ª—å–∫–æ—Ä–∞, –≤—ã –Ω–µ–∑–∞–º–µ—Ç–Ω–æ –ø–æ–ø–∞–ª–∏ –ø–æ–¥ –µ–≥–æ –≤–ª–∏—è–Ω–∏–µ. –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ –≤ –Ω–∏—Ö –µ—Å—Ç—å –∏–∑—ä—è–Ω - —Ç—ë–º–Ω–∞—è —Å–≤—è–∑—å —Å –ú–æ—Ä–≥–æ—Ç–æ–º.</p>
                <p>–ö–æ–≥–¥–∞ –æ–Ω –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –∏—Ö, –∫–∞–º–Ω–∏ –æ—Ç–∑—ã–≤–∞—é—Ç—Å—è. –í—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è—Ç—å—Å—è, –Ω–æ —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ. –¢—å–º–∞ –≤ –∫–∞–º–Ω—è—Ö –ø—Ä–æ–±—É–∂–¥–∞–µ—Ç—Å—è, –∏ –∏—Ö —Å–≤–µ—Ç –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –≤–æ —Ç—å–º—É.</p>
                <p>–í—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å –ø–µ—Ä–≤—ã–º –∏–∑ —ç–ª—å—Ñ–æ–≤, –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ —Å–ª—É–∂–∞—â–∏—Ö –¢—å–º–µ, –∞ –≤–∞—à–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã - –æ—Ä—É–¥–∏—è–º–∏ –ø–æ—Ä—á–∏ –∏ —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è...</p>`;
                ending.type = 'dark';
            }
            // –ì–µ—Ä–æ–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞
            else if (totalCharacter > 100 && gameState.events.includes('saved_people')) {
                ending.title = "üõ°Ô∏è –ó–ê–©–ò–¢–ù–ò–ö –í–ê–õ–ò–ù–û–†–ê";
                ending.text = `<p>–í—ã —Å–æ–∑–¥–∞–ª–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã, –Ω–æ, —á—Ç–æ –≤–∞–∂–Ω–µ–µ, –ø–æ–∫–∞–∑–∞–ª–∏ –ø—Ä–∏–º–µ—Ä –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ –≤–µ–ª–∏—á–∏—è - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å —Ä–∞–¥–∏ –¥—Ä—É–≥–∏—Ö. –ö–æ–≥–¥–∞ –ú–µ–ª—å–∫–æ—Ä –ø–æ–ø—ã—Ç–∞–ª—Å—è –ø–æ—Ö–∏—Ç–∏—Ç—å –∫–∞–º–Ω–∏, –≤—ã –±—ã–ª–∏ –≥–æ—Ç–æ–≤—ã.</p>
                <p>–ë–ª–∞–≥–æ–¥–∞—Ä—è –≤–∞—à–µ–π –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç–Ω—ã–º —á–∞—Ä–∞–º, –µ–≥–æ –ø–ª–∞–Ω –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è. –í—ã –ª–∏—á–Ω–æ —Å—Ä–∞–∑–∏–ª–∏—Å—å —Å –Ω–∏–º, –∑–∞—â–∏—â–∞—è —Å–≤–æ—ë —Ç–≤–æ—Ä–µ–Ω–∏–µ –∏ –≤–µ—Å—å –í–∞–ª–∏–Ω–æ—Ä.</p>
                <p>–•–æ—Ç—è –±–∏—Ç–≤–∞ —Å—Ç–æ–∏–ª–∞ –≤–∞–º –∂–∏–∑–Ω–∏, –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã –æ—Å—Ç–∞–ª–∏—Å—å –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–ª–∏ –≤–µ—á–Ω—ã–º —Å–∏–º–≤–æ–ª–æ–º –Ω–∞–¥–µ–∂–¥—ã –∏ –º—É–∂–µ—Å—Ç–≤–∞ —ç–ª—å—Ñ–æ–≤.</p>`;
                ending.type = 'heroic';
            }
            // –ú—É–¥—Ä–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞
            else if (gameState.harmony > 100 && gameState.fatigue < 40) {
                ending.title = "üìñ –ú–£–î–†–ï–¶ –ê–†–î–´";
                ending.text = `<p>–°–æ–∑–¥–∞–≤ –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ –∏ –º—É–¥—Ä–æ—Å—Ç–∏, –≤—ã –ø–æ–Ω—è–ª–∏ –∏—Å—Ç–∏–Ω–Ω—É—é –ø—Ä–∏—Ä–æ–¥—É —Ç–≤–æ—Ä–µ–Ω–∏—è. –ö–∞–º–Ω–∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã, –Ω–æ –≤—ã –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –Ω–∏–º –±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ.</p>
                <p>–ö–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏—Å–ø—ã—Ç–∞–Ω–∏–µ, –≤—ã –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ –æ—Ç–¥–∞—ë—Ç–µ –æ–¥–∏–Ω –∫–∞–º–µ–Ω—å –í–∞–ª–∞—Ä, –¥—Ä—É–≥–æ–π - –ª—é–¥—è–º, —Ç—Ä–µ—Ç–∏–π –æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ —ç–ª—å—Ñ–∞–º. –¢–∞–∫ —Å–≤–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –≤—Å–µ–π –ê—Ä–¥–µ.</p>
                <p>–í—ã –∂–∏–≤—ë—Ç–µ –¥–æ–ª–≥–æ, –¥–µ–ª—è—Å—å –º—É–¥—Ä–æ—Å—Ç—å—é –∏ –∑–Ω–∞–Ω–∏—è–º–∏, —Å—Ç–∞–≤ –≤–µ–ª–∏—á–∞–π—à–∏–º —É—á–∏—Ç–µ–ª–µ–º –∏ —Ñ–∏–ª–æ—Å–æ—Ñ–æ–º —Å—Ä–µ–¥–∏ —ç–ª—å–¥–∞—Ä.</p>`;
                ending.type = 'wise';
            }
            // –ò–∑–≥–Ω–∞–Ω–∏–µ
            else if (gameState.valar < 20) {
                ending.title = "üåë –ò–ó–ì–ù–ê–ù–ù–ò–ö";
                ending.text = `<p>–í–∞—à–µ –æ—Ç—á—É–∂–¥–µ–Ω–∏–µ –æ—Ç –í–∞–ª–∞—Ä –∏ –≥–æ—Ä–¥—ã–Ω—è –ø—Ä–∏–≤–µ–ª–∏ –∫ –∏–∑–≥–Ω–∞–Ω–∏—é –∏–∑ –í–∞–ª–∏–Ω–æ—Ä–∞ –µ—â—ë –¥–æ –ø–æ—Ö–∏—â–µ–Ω–∏—è –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤. –í—ã –∑–∞–±—Ä–∞–ª–∏ –∫–∞–º–Ω–∏ —Å —Å–æ–±–æ–π –≤ –°—Ä–µ–¥–∏–∑–µ–º—å–µ.</p>
                <p>–¢–∞–º, –≤–¥–∞–ª–∏ –æ—Ç —Å–≤–µ—Ç–∞ –î—Ä–µ–≤, –°–∏–ª—å–º–∞—Ä–∏–ª–ª—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ç—É—Å–∫–Ω–µ—é—Ç. –í—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö —Å–∏—è–Ω–∏–µ, –Ω–æ –±–µ–∑ –±–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏—è –í–∞–ª–∏–Ω–æ—Ä–∞ —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.</p>
                <p>–í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –≤—ã –∏—Å—á–µ–∑–∞–µ—Ç–µ –≤ –≤–æ—Å—Ç–æ—á–Ω—ã—Ö –∑–µ–º–ª—è—Ö –≤–º–µ—Å—Ç–µ —Å —É–≥–∞—Å–∞—é—â–∏–º–∏ –∫–∞–º–Ω—è–º–∏, —Å—Ç–∞–≤ –ª–µ–≥–µ–Ω–¥–æ–π –æ –ø–∞–¥—à–µ–º —Ç–≤–æ—Ä—Ü–µ...</p>`;
                ending.type = 'exile';
            }
            // –ë–µ–∑—É–º–∏–µ
            else if (gameState.fatigue > 80 && gameState.pride > 50) {
                ending.title = "üåÄ –ë–ï–ó–£–ú–ò–ï –¢–í–û–†–¶–ê";
                ending.text = `<p>–°–æ–∑–¥–∞–Ω–∏–µ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤ –∏—Å—Ç–æ—â–∏–ª–æ –Ω–µ —Ç–æ–ª—å–∫–æ –≤–∞—à–µ —Ç–µ–ª–æ, –Ω–æ –∏ —Ä–∞–∑—É–º. –û–¥–µ—Ä–∂–∏–º–æ—Å—Ç—å –∫–∞–º–Ω—è–º–∏ –ø–µ—Ä–µ—Ä–æ—Å–ª–∞ –≤ –±–µ–∑—É–º–∏–µ.</p>
                <p>–í—ã –≤–∏–¥–∏—Ç–µ –≤—Ä–∞–≥–æ–≤ –ø–æ–≤—Å—é–¥—É, –Ω–µ –¥–æ–≤–µ—Ä—è–µ—Ç–µ –¥–∞–∂–µ —Å–µ–º—å–µ. –ó–∞–ø–µ—Ä—à–∏—Å—å –≤ –∫—É–∑–Ω–∏—Ü–µ —Å –°–∏–ª—å–º–∞—Ä–∏–ª–ª–∞–º–∏, –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å —Å–æ–∑–¥–∞—Ç—å —á–µ—Ç–≤—ë—Ä—Ç—ã–π –∫–∞–º–µ–Ω—å, –Ω–æ —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.</p>
                <p>–í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –≤–∞—à–∏ —Å—ã–Ω–æ–≤—å—è –≤—ã–Ω—É–∂–¥–µ–Ω—ã —Å–∏–ª–æ–π –∑–∞–±—Ä–∞—Ç—å —É –≤–∞—Å –∫–∞–º–Ω–∏. –í—ã –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –æ—Å—Ç–∞—Ç–æ–∫ –¥–Ω–µ–π –≤ –≥–æ—Ä—å–∫–æ–º –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–µ, –±–æ—Ä–º–æ—á–∞ –æ –ø—Ä–µ–¥–∞–Ω–Ω–æ–º —Å–≤–µ—Ç–µ...</p>`;
                ending.type = 'madness';
            }
            // –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞
            else {
                ending.title = "üíé –¢–í–û–†–ï–¶ –°–ò–õ–¨–ú–ê–†–ò–õ–õ–û–í";
                ending.text = `<p>–í—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª–∏ —Ç—Ä–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–∞ - –≤–µ–ª–∏—á–∞–π—à–µ–µ —Ç–≤–æ—Ä–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –ê—Ä–¥—ã. –ò—Ö —Å–≤–µ—Ç –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω, —Ö–æ—Ç—è –∏ –Ω–µ –∏–¥–µ–∞–ª–µ–Ω.</p>
                <p>–ö–∞–º–Ω–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø—Ä–µ–¥–º–µ—Ç–æ–º –≤–æ—Å—Ö–∏—â–µ–Ω–∏—è –∏ –∑–∞–≤–∏—Å—Ç–∏. –í—ã —Ö—Ä–∞–Ω–∏—Ç–µ –∏—Ö, –Ω–æ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Ä–∞—Å—Ç—É—â–µ–µ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ –æ –∏—Ö —Å—É–¥—å–±–µ.</p>
                <p>–ò—Å—Ç–æ—Ä–∏—è –µ—â—ë –Ω–µ –Ω–∞–ø–∏—Å–∞–Ω–∞. –í–æ–∑–º–æ–∂–Ω–æ, –≤—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞—â–∏—Ç–∏—Ç—å —Å–≤–æ—ë —Ç–≤–æ—Ä–µ–Ω–∏–µ, –∞ –≤–æ–∑–º–æ–∂–Ω–æ, –≥—Ä—è–¥—É—â–∏–µ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω—è—Ç –≤—Å—ë. –í—Ä–µ–º—è –ø–æ–∫–∞–∂–µ—Ç...</p>
                <p><strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –°–∏–ª—å–º–∞—Ä–∏–ª–ª–æ–≤:</strong><br>
                –Ø—Ä–∫–æ—Å—Ç—å: ${gameState.brightness} | –ß–∏—Å—Ç–æ—Ç–∞: ${gameState.purity} | –ú–∞–≥–∏—è: ${gameState.magic}<br>
                –ü—Ä–æ—á–Ω–æ—Å—Ç—å: ${gameState.durability} | –ì–∞—Ä–º–æ–Ω–∏—è: ${gameState.harmony}</p>`;
                ending.type = 'neutral';
            }
            
            return ending;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—ã
            document.getElementById('skill').textContent = gameState.skill;
            document.getElementById('inspiration').textContent = gameState.inspiration;
            document.getElementById('pride').textContent = gameState.pride;
            document.getElementById('valar').textContent = gameState.valar;
            document.getElementById('fatigue').textContent = gameState.fatigue;
            
            document.getElementById('brightness').textContent = gameState.brightness;
            document.getElementById('purity').textContent = gameState.purity;
            document.getElementById('magic').textContent = gameState.magic;
            document.getElementById('durability').textContent = gameState.durability;
            document.getElementById('harmony').textContent = gameState.harmony;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∞–∑—É
            document.getElementById('phase').textContent = `–§–∞–∑–∞: ${phases[gameState.phase]}`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è
        function displayScenario() {
            const scenario = scenarios[gameState.phase][gameState.step];
            document.getElementById('gameText').innerHTML = scenario.text;
            
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';
            
            scenario.choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.text;
                button.onclick = () => makeChoice(choice);
                choicesDiv.appendChild(button);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞
        function makeChoice(choice) {
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç—ã
            choice.effect();
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
            gameState.skill = Math.max(0, Math.min(100, gameState.skill));
            gameState.inspiration = Math.max(0, Math.min(100, gameState.inspiration));
            gameState.pride = Math.max(0, Math.min(100, gameState.pride));
            gameState.valar = Math.max(0, Math.min(100, gameState.valar));
            gameState.fatigue = Math.max(0, Math.min(100, gameState.fatigue));
            
            updateUI();
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
            if (choice.next === 'nextPhase') {
                gameState.phase++;
                gameState.step = 0;
                
                if (gameState.phase >= phases.length - 1) {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ü–æ–≤–∫—É
                    showEnding();
                } else {
                    displayScenario();
                }
            } else {
                gameState.step = choice.next;
                displayScenario();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –∫–æ–Ω—Ü–æ–≤–∫–∏
        function showEnding() {
            const ending = determineEnding();
            
            let endingClass = '';
            if (ending.type === 'legendary') endingClass = 'silmaril-glow';
            
            document.getElementById('gameText').innerHTML = `
                <div class="ending-title ${endingClass}">${ending.title}</div>
                ${ending.text}
            `;
            
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '<button class="restart-btn" onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>';
            
            document.getElementById('phase').textContent = '–≠–ø–∏–ª–æ–≥';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
        function restartGame() {
            gameState = {
                phase: 0,
                step: 0,
                skill: 50,
                inspiration: 50,
                pride: 30,
                valar: 70,
                fatigue: 0,
                brightness: 0,
                purity: 0,
                magic: 0,
                durability: 0,
                harmony: 0,
                materials: [],
                methods: [],
                events: [],
                oathTaken: false,
                helpFromValar: false,
                secretKnowledge: false
            };
            
            updateUI();
            displayScenario();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        displayScenario();
        updateUI();
    </script>
</body>
</html>