<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù - –°–í–ï–¢ –ò–ú–ü–ï–†–ê–¢–û–†–ê</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
<style>
/* ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò ==================== */
* { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
}

:root {
    /* –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ */
    --imperial-gold: #d4af37;
    --blood-red: #8B0000;
    --dark-bg: #0a0a0a;
    --panel-bg: #1a1a1a;
    --panel-border: #2a2a2a;
    
    /* –¶–≤–µ—Ç–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ */
    --glow-gold: #ffd700;
    --chaos-purple: #6a0dad;
    --warning-orange: #ff6600;
    --tech-blue: #1e90ff;
    --success-green: #00ff00;
    --critical-red: #ff0000;
    
    /* –¶–≤–µ—Ç–∞ —Ñ—Ä–∞–∫—Ü–∏–π */
    --chaos-red: #8B0000;
    --tyranid-purple: #4B0082;
    --necron-green: #39FF14;
    --ork-green: #228B22;
    --tau-cyan: #00CED1;
    --eldar-blue: #4169E1;
    
    /* –†–∞–∑–º–µ—Ä—ã - –ö–û–ú–ü–ê–ö–¢–ù–´–ï */
    --header-height: 80px;
    --panel-padding: 15px;
    --border-radius: 4px;
}

/* ==================== –û–°–ù–û–í–ù–û–ô –§–û–ù –ò BODY ==================== */
body {
    font-family: 'Orbitron', monospace;
    background: linear-gradient(180deg, var(--dark-bg) 0%, var(--panel-bg) 50%, var(--dark-bg) 100%);
    color: #ccc;
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
}

/* –≠—Ñ—Ñ–µ–∫—Ç —Å–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö –ª–∏–Ω–∏–π */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(255,255,255,0.02) 2px,
        rgba(255,255,255,0.02) 4px
    );
    pointer-events: none;
    z-index: 1;
    animation: scanline 8s linear infinite;
}

@keyframes scanline {
    0% { transform: translateY(0); }
    100% { transform: translateY(4px); }
}

/* –≠—Ñ—Ñ–µ–∫—Ç –∑–≤—ë–∑–¥ –Ω–∞ —Ñ–æ–Ω–µ */
body::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
        radial-gradient(2px 2px at 20% 30%, white, transparent),
        radial-gradient(2px 2px at 60% 70%, white, transparent),
        radial-gradient(1px 1px at 50% 50%, white, transparent),
        radial-gradient(1px 1px at 80% 10%, white, transparent),
        radial-gradient(2px 2px at 90% 60%, white, transparent);
    background-size: 200% 200%;
    animation: stars 200s linear infinite;
    opacity: 0.3;
    pointer-events: none;
    z-index: 1;
}

@keyframes stars {
    0% { background-position: 0% 0%; }
    100% { background-position: -200% -200%; }
}

/* ==================== –ö–û–ù–¢–ï–ô–ù–ï–† ==================== */
.container {
    max-width: 1800px;
    margin: 0 auto;
    padding: 20px;
    position: relative;
    z-index: 2;
}

/* ==================== –ó–ê–ì–û–õ–û–í–û–ö ==================== */
header {
    text-align: center;
    padding: 25px 20px;
    background: linear-gradient(180deg, rgba(42, 42, 42, 0.8) 0%, transparent 100%);
    border-bottom: 3px solid var(--imperial-gold);
    margin-bottom: 20px;
    animation: fadeInDown 1s ease-out;
    position: relative;
}

header::before {
    content: '‚öú';
    position: absolute;
    top: 5px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 2em;
    color: var(--imperial-gold);
    opacity: 0.3;
}

h1 {
    font-family: 'Cinzel', serif;
    font-size: 2.5em;
    font-weight: 900;
    color: var(--imperial-gold);
    text-shadow: 
        0 0 20px rgba(212,175,55,0.8),
        0 0 40px rgba(212,175,55,0.4),
        2px 2px 4px #000;
    letter-spacing: 8px;
    margin-bottom: 10px;
    animation: titleGlow 3s ease-in-out infinite alternate;
}

@keyframes titleGlow {
    0% { 
        text-shadow: 
            0 0 20px rgba(212,175,55,0.6),
            0 0 40px rgba(212,175,55,0.3),
            2px 2px 4px #000;
    }
    100% { 
        text-shadow: 
            0 0 30px rgba(212,175,55,1),
            0 0 60px rgba(212,175,55,0.6),
            2px 2px 4px #000;
    }
}

.subtitle {
    font-size: 0.85em;
    color: #888;
    letter-spacing: 4px;
    text-transform: uppercase;
    margin-bottom: 8px;
}

.motto {
    font-family: 'Cinzel', serif;
    font-size: 0.95em;
    color: var(--imperial-gold);
    font-style: italic;
    letter-spacing: 2px;
    margin-top: 10px;
    opacity: 0.7;
}

/* ==================== –û–°–ù–û–í–ù–ê–Ø –°–ï–¢–ö–ê ==================== */
.main-layout {
    display: grid;
    grid-template-columns: 320px 1fr 320px;
    gap: 15px;
    margin-bottom: 15px;
}

@media (max-width: 1600px) {
    .main-layout {
        grid-template-columns: 1fr 1fr;
    }
    
    .right-panel {
        grid-column: 1 / -1;
    }
}

@media (max-width: 1000px) {
    .main-layout {
        grid-template-columns: 1fr;
    }
}

/* ==================== –ü–ê–ù–ï–õ–ò ==================== */
.panel {
    background: linear-gradient(135deg, var(--panel-border), var(--panel-bg));
    border: 2px solid #444;
    padding: var(--panel-padding);
    box-shadow: 
        inset 0 2px 5px rgba(0,0,0,0.8),
        0 0 20px rgba(0,0,0,0.5);
    position: relative;
    animation: fadeIn 0.8s ease-out;
    border-radius: var(--border-radius);
}

.panel::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--imperial-gold), transparent);
    opacity: 0.3;
}

.panel-title {
    font-family: 'Cinzel', serif;
    font-size: 1.3em;
    color: var(--imperial-gold);
    text-transform: uppercase;
    margin-bottom: 15px;
    letter-spacing: 2px;
    border-bottom: 2px solid #444;
    padding-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.panel-title .icon {
    font-size: 1.1em;
}

.panel-subtitle {
    font-size: 0.7em;
    color: #888;
    font-family: 'Orbitron', monospace;
    letter-spacing: 1px;
    margin-left: auto;
}

/* –°–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–µ –ø–∞–Ω–µ–ª–∏ */
.panel.collapsible .panel-title {
    cursor: pointer;
    user-select: none;
}

.panel.collapsible .panel-title::after {
    content: '‚ñº';
    margin-left: auto;
    transition: transform 0.3s ease;
}

.panel.collapsible.collapsed .panel-title::after {
    transform: rotate(-90deg);
}

.panel.collapsible.collapsed .panel-content {
    display: none;
}

/* ==================== –ü–ê–ù–ï–õ–¨ –†–ï–°–£–†–°–û–í ==================== */
.resource-bar {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
    padding: 15px;
    background: rgba(0,0,0,0.4);
    border: 2px solid #444;
    margin-bottom: 15px;
    border-radius: var(--border-radius);
}

.resource-item {
    text-align: center;
    padding: 8px;
    background: rgba(0,0,0,0.3);
    border: 1px solid #333;
    border-radius: var(--border-radius);
    transition: all 0.3s ease;
    position: relative;
}

.resource-item:hover {
    border-color: var(--imperial-gold);
    background: rgba(212,175,55,0.05);
}

.resource-label {
    font-size: 0.8em;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 5px;
}

.resource-value {
    font-size: 1.3em;
    font-weight: bold;
    color: var(--imperial-gold);
    text-shadow: 0 0 10px rgba(212,175,55,0.5);
}

.resource-change {
    font-size: 0.75em;
    color: #666;
    margin-top: 3px;
}

.resource-change.positive {
    color: var(--success-green);
}

.resource-change.negative {
    color: var(--critical-red);
}

/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
.resource-progress {
    margin-top: 5px;
    height: 4px;
    background: rgba(0,0,0,0.5);
    border-radius: 2px;
    overflow: hidden;
}

.resource-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--imperial-gold), var(--glow-gold));
    transition: width 0.5s ease;
    box-shadow: 0 0 10px rgba(255,215,0,0.5);
}

/* ==================== –ú–ï–¢–†–ò–ö–ò ==================== */
.metric {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 15px 0;
    padding: 12px;
    background: rgba(0,0,0,0.3);
    border-left: 3px solid var(--imperial-gold);
    border-radius: var(--border-radius);
    transition: all 0.3s ease;
}

.metric:hover {
    background: rgba(212,175,55,0.05);
    border-left-width: 5px;
}

.metric-label {
    color: #999;
    font-size: 0.9em;
    text-transform: uppercase;
    letter-spacing: 1px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.metric-value {
    font-size: 1.4em;
    font-weight: 700;
    color: var(--glow-gold);
    text-shadow: 0 0 10px rgba(255,215,0,0.5);
}

.metric-value.critical {
    color: var(--critical-red);
    animation: pulse 0.5s infinite;
}

.metric-value.warning {
    color: var(--warning-orange);
}

.metric-value.success {
    color: var(--success-green);
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
}

/* ==================== –ü–†–û–ì–†–ï–°–°-–ë–ê–†–´ ==================== */
.progress-container {
    margin: 15px 0;
}

.progress-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.progress-title {
    font-size: 0.9em;
    color: #999;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.progress-percentage {
    font-size: 0.9em;
    color: var(--glow-gold);
    font-weight: 700;
}

.progress-bar {
    width: 100%;
    height: 32px;
    background: rgba(0,0,0,0.6);
    border: 2px solid #444;
    position: relative;
    overflow: hidden;
    border-radius: var(--border-radius);
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--imperial-gold), var(--glow-gold), var(--imperial-gold));
    transition: width 0.5s ease;
    position: relative;
    box-shadow: 0 0 20px rgba(255,215,0,0.6);
}

.progress-fill.critical {
    background: linear-gradient(90deg, var(--blood-red), var(--critical-red), var(--blood-red));
    box-shadow: 0 0 20px rgba(255,0,0,0.6);
    animation: criticalPulse 1s infinite;
}

@keyframes criticalPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.progress-fill.warning {
    background: linear-gradient(90deg, #cc5500, var(--warning-orange), #cc5500);
    box-shadow: 0 0 20px rgba(255,102,0,0.6);
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.progress-label {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #000;
    font-weight: 700;
    font-size: 0.9em;
    text-shadow: 
        1px 1px 2px rgba(255,255,255,0.5),
        0 0 5px rgba(255,255,255,0.3);
    z-index: 1;
    mix-blend-mode: difference;
}

/* ==================== –ö–ù–û–ü–ö–ò ==================== */
.button {
    background: linear-gradient(180deg, #3a3a3a, #1a1a1a);
    color: var(--imperial-gold);
    border: 2px solid var(--imperial-gold);
    padding: 15px 30px;
    font-family: 'Cinzel', serif;
    font-size: 1em;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    margin: 10px 5px;
    border-radius: var(--border-radius);
}

.button::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: radial-gradient(circle, rgba(212,175,55,0.3), transparent);
    transform: translate(-50%, -50%);
    transition: width 0.5s ease, height 0.5s ease;
}

.button:hover::before {
    width: 400px;
    height: 400px;
}

.button:hover {
    background: linear-gradient(180deg, #4a4a4a, #2a2a2a);
    box-shadow: 0 0 20px rgba(212,175,55,0.5);
    transform: translateY(-2px);
}

.button:active {
    transform: translateY(0);
}

.button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    border-color: #555;
    color: #555;
}

.button.danger {
    border-color: var(--critical-red);
    color: var(--critical-red);
}

.button.danger:hover {
    box-shadow: 0 0 20px rgba(255,0,0,0.5);
}

.button.success {
    border-color: var(--success-green);
    color: var(--success-green);
}

.button-group {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin: 15px 0;
}

/* ==================== –í–ö–õ–ê–î–ö–ò ==================== */
.tabs {
    display: flex;
    gap: 5px;
    margin-bottom: 20px;
    border-bottom: 2px solid #444;
    flex-wrap: wrap;
}

.tab {
    flex: 1;
    min-width: 120px;
    background: rgba(0,0,0,0.3);
    color: #888;
    border: none;
    padding: 15px 10px;
    font-family: 'Cinzel', serif;
    font-size: 0.9em;
    text-transform: uppercase;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all 0.3s ease;
    border-top: 3px solid transparent;
    position: relative;
}

.tab:hover {
    background: rgba(212,175,55,0.1);
    color: var(--imperial-gold);
}

.tab.active {
    background: rgba(212,175,55,0.2);
    color: var(--imperial-gold);
    border-top-color: var(--imperial-gold);
}

.tab-content {
    display: none;
    animation: fadeIn 0.5s ease-out;
}

.tab-content.active {
    display: block;
}

/* ==================== –ö–ê–†–¢–û–ß–ö–ò ==================== */
.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    margin: 15px 0;
}

.card {
    background: rgba(0,0,0,0.5);
    border: 2px solid #444;
    padding: 20px;
    position: relative;
    transition: all 0.3s ease;
    border-radius: var(--border-radius);
}

.card:hover {
    border-color: var(--imperial-gold);
    box-shadow: 0 0 15px rgba(212,175,55,0.3);
    transform: translateY(-2px);
}

.card.locked {
    opacity: 0.5;
    filter: grayscale(80%);
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.card-title {
    font-family: 'Cinzel', serif;
    font-size: 1.2em;
    color: var(--imperial-gold);
}

.card-level {
    font-size: 0.9em;
    color: #666;
    background: rgba(0,0,0,0.5);
    padding: 4px 8px;
    border-radius: 3px;
}

.card-desc {
    font-size: 0.85em;
    color: #aaa;
    line-height: 1.6;
    margin: 12px 0;
}

.card-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin: 12px 0;
    padding: 10px;
    background: rgba(0,0,0,0.3);
    border-radius: var(--border-radius);
}

.card-stat {
    font-size: 0.8em;
    color: #888;
}

.card-stat-value {
    color: var(--imperial-gold);
    font-weight: 700;
}

.card-cost {
    color: var(--glow-gold);
    font-weight: 700;
    margin: 10px 0;
    font-size: 0.9em;
}

.card-footer {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

/* ==================== –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù–ê ==================== */
.astronomican-display {
    width: 100%;
    height: 400px;
    background: radial-gradient(circle at center, rgba(212,175,55,0.1) 0%, transparent 70%);
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid #444;
    margin: 20px 0;
    overflow: hidden;
    border-radius: var(--border-radius);
}

.golden-throne {
    width: 100px;
    height: 100px;
    background: radial-gradient(circle, var(--imperial-gold), var(--blood-red));
    border-radius: 50%;
    position: relative;
    animation: throneGlow 2s ease-in-out infinite;
    box-shadow: 
        0 0 40px var(--glow-gold),
        0 0 80px rgba(212,175,55,0.5),
        inset 0 0 20px rgba(0,0,0,0.5);
}

@keyframes throneGlow {
    0%, 100% {
        box-shadow: 
            0 0 40px var(--glow-gold),
            0 0 80px rgba(212,175,55,0.5),
            inset 0 0 20px rgba(0,0,0,0.5);
    }
    50% {
        box-shadow: 
            0 0 60px var(--glow-gold),
            0 0 120px rgba(212,175,55,0.8),
            inset 0 0 20px rgba(0,0,0,0.5);
    }
}

.astronomican-beam {
    position: absolute;
    width: 4px;
    height: 200%;
    background: linear-gradient(180deg, 
        transparent 0%,
        var(--glow-gold) 50%,
        transparent 100%
    );
    box-shadow: 0 0 20px var(--glow-gold);
    animation: beamRotate 10s linear infinite;
    transform-origin: center center;
}

@keyframes beamRotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: var(--glow-gold);
    border-radius: 50%;
    box-shadow: 0 0 10px var(--glow-gold);
    animation: particleFloat 3s linear infinite;
}

@keyframes particleFloat {
    0% {
        transform: translate(0, 0) scale(1);
        opacity: 0;
    }
    10% {
        opacity: 1;
    }
    90% {
        opacity: 1;
    }
    100% {
        transform: translate(var(--tx), var(--ty)) scale(0);
        opacity: 0;
    }
}

/* ==================== –õ–û–ì –°–û–ë–´–¢–ò–ô ==================== */
.event-log {
    background: rgba(0,0,0,0.6);
    border: 2px solid #444;
    padding: 15px;
    height: 450px;
    overflow-y: auto;
    font-size: 0.85em;
    line-height: 1.6;
    border-radius: var(--border-radius);
}

.event-log::-webkit-scrollbar {
    width: 10px;
}

.event-log::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.5);
}

.event-log::-webkit-scrollbar-thumb {
    background: var(--imperial-gold);
    border-radius: 5px;
}

.event-log::-webkit-scrollbar-thumb:hover {
    background: var(--glow-gold);
}

.event-entry {
    margin: 10px 0;
    padding: 10px;
    border-left: 3px solid #555;
    background: rgba(0,0,0,0.3);
    border-radius: var(--border-radius);
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(-20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.event-entry.info {
    border-left-color: var(--tech-blue);
}

.event-entry.warning {
    border-left-color: var(--warning-orange);
    color: var(--warning-orange);
}

.event-entry.critical {
    border-left-color: var(--critical-red);
    color: var(--critical-red);
    background: rgba(139,0,0,0.2);
}

.event-entry.success {
    border-left-color: var(--imperial-gold);
    color: var(--imperial-gold);
}

.event-timestamp {
    color: #666;
    font-size: 0.85em;
    margin-right: 10px;
    font-family: 'Orbitron', monospace;
}

/* ==================== –ê–ù–ò–ú–ê–¶–ò–ò ==================== */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes fadeInDown {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê –ò –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ==================== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    animation: fadeIn 0.3s ease-out;
}

.modal {
    background: linear-gradient(135deg, var(--panel-border), var(--panel-bg));
    border: 3px solid var(--imperial-gold);
    padding: 30px;
    max-width: 800px;
    max-height: 80vh;
    overflow-y: auto;
    border-radius: var(--border-radius);
    animation: fadeInUp 0.3s ease-out;
}

.modal-header {
    font-family: 'Cinzel', serif;
    font-size: 2em;
    color: var(--imperial-gold);
    text-align: center;
    margin-bottom: 20px;
    border-bottom: 2px solid #444;
    padding-bottom: 15px;
}

.notification-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 999;
    max-width: 400px;
}

.notification {
    background: rgba(26, 26, 26, 0.95);
    border: 2px solid var(--imperial-gold);
    padding: 15px;
    margin-bottom: 10px;
    border-radius: var(--border-radius);
    animation: slideInRight 0.3s ease-out;
    position: relative;
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.notification.warning {
    border-color: var(--warning-orange);
}

.notification.critical {
    border-color: var(--critical-red);
    animation: pulse 0.5s infinite;
}

.notification.success {
    border-color: var(--success-green);
}

.notification-close {
    position: absolute;
    top: 5px;
    right: 10px;
    background: none;
    border: none;
    color: #888;
    font-size: 1.5em;
    cursor: pointer;
    transition: color 0.3s ease;
}

.notification-close:hover {
    color: var(--imperial-gold);
}

/* ==================== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ==================== */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 20px 0;
}

.stat-box {
    background: rgba(0,0,0,0.5);
    padding: 20px;
    text-align: center;
    border: 2px solid #444;
    border-top: 4px solid var(--imperial-gold);
    border-radius: var(--border-radius);
    transition: all 0.3s ease;
}

.stat-box:hover {
    border-color: var(--imperial-gold);
    box-shadow: 0 0 15px rgba(212,175,55,0.3);
}

.stat-number {
    font-size: 2.5em;
    color: var(--glow-gold);
    font-weight: 700;
    display: block;
    margin: 10px 0;
    text-shadow: 0 0 15px rgba(255,215,0,0.5);
}

.stat-label {
    font-size: 0.8em;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.modifier-badge {
    background: rgba(0, 0, 0, 0.9);
    border: 2px solid var(--imperial-gold);
    border-radius: 4px;
    padding: 10px;
    margin-bottom: 10px;
    animation: fadeIn 0.3s ease-out;
}

.modifier-badge.negative {
    border-color: var(--critical-red);
}

.modifier-badge.positive {
    border-color: #00ff00;
}

.modifier-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
}

.modifier-icon {
    font-size: 1.5em;
    margin-right: 8px;
}

.modifier-duration {
    font-size: 0.8em;
    color: #888;
}

/* –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏... */
</style>
</head>
<body>


<!-- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ—Ç –ß–∞—Å—Ç–∏ 1 - –≤—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–µ–≥–∞ </style> -->

<!-- ==================== –ó–ê–ì–û–õ–û–í–û–ö ==================== -->
<header>
    <h1>‚ö° –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù ‚ö°</h1>
    <div class="subtitle">–°–≤–µ—Ç –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤–æ –¢—å–º–µ</div>
    <div class="motto">"–¢–æ–ª—å–∫–æ –≤ —Å–º–µ—Ä—Ç–∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –¥–æ–ª–≥"</div>
</header>

<div class="container">
    
    <!-- ==================== –ü–ê–ù–ï–õ–¨ –†–ï–°–£–†–°–û–í ==================== -->
    <div class="resource-bar">
        <div class="resource-item">
            <div class="resource-label">‚ö´ –ß—ë—Ä–Ω—ã–π –ö–æ—Ä–∞–±–ª—å</div>
            <div class="resource-value" id="res-blackship">15 –¥–Ω–µ–π</div>
            <div class="resource-change">–î–æ –ø—Ä–∏–±—ã—Ç–∏—è</div>
        </div>

        <div class="resource-item" title="–ü—Å–∏—Ö–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è –ø—Å–∞–π–∫–µ—Ä–æ–≤">
            <span class="resource-icon">üîÆ</span>
            <span class="resource-amount" id="res-psychic">0</span>
            <span class="resource-label">–ü—Å–∞–π–∫–µ—Ä—ã</span>
            <span class="resource-change" id="res-psychic-change">+0/–¥–µ–Ω—å</span>
        </div>
        
        <div class="resource-item" title="–ò–º–ø–µ—Ä—Å–∫–∏–µ –∫—Ä–µ–¥–∏—Ç—ã">
            <span class="resource-icon">üí∞</span>
            <span class="resource-amount" id="res-credits">10000</span>
            <span class="resource-label">–ö—Ä–µ–¥–∏—Ç—ã</span>
            <span class="resource-change" id="res-credits-change">+0/–¥–µ–Ω—å</span>
        </div>
        
        <div class="resource-item" title="–ù–∞—Å–µ–ª–µ–Ω–∏–µ –ò–º–ø–µ—Ä–∏—É–º–∞">
            <span class="resource-icon">üë•</span>
            <span class="resource-amount" id="res-population">1000</span>
            <span class="resource-label">–ù–∞—Å–µ–ª–µ–Ω–∏–µ (–º–ª—Ä–¥)</span>
            <span class="resource-change" id="res-population-change">+0/–¥–µ–Ω—å</span>
        </div>
        
        <div class="resource-item" title="–ê–¥–µ–ø—Ç—É—Å –ê—Å—Ç—Ä–∞ –ú–∏–ª–∏—Ç–∞—Ä—É–º">
            <span class="resource-icon">‚öîÔ∏è</span>
            <span class="resource-amount" id="res-military">100</span>
            <span class="resource-label">–ê—Ä–º–∏—è (–º–ª–Ω)</span>
            <span class="resource-change" id="res-military-change">+0/–¥–µ–Ω—å</span>
        </div>
        
        <div class="resource-item" title="–ò–º–ø–µ—Ä—Å–∫–∏–π —Ñ–ª–æ—Ç">
            <span class="resource-icon">üöÄ</span>
            <span class="resource-amount" id="res-fleet">50</span>
            <span class="resource-label">–§–ª–æ—Ç</span>
            <span class="resource-change" id="res-fleet-change">+0/–¥–µ–Ω—å</span>
        </div>
        
        <div class="resource-item" title="–ê–¥–µ–ø—Ç—É—Å –ú–µ—Ö–∞–Ω–∏–∫—É—Å">
            <span class="resource-icon">‚öôÔ∏è</span>
            <span class="resource-amount" id="res-tech">10</span>
            <span class="resource-label">–¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü—ã</span>
            <span class="resource-change" id="res-tech-change">+0/–¥–µ–Ω—å</span>
        </div>
    </div>

    <!-- –ê–ö–¢–ò–í–ù–´–ï –ú–û–î–ò–§–ò–ö–ê–¢–û–†–´ -->
    <div style="position: fixed; top: 80px; right: 20px; z-index: 999; max-width: 350px;">
        <div id="active-modifiers-container">
            <!-- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <!-- ==================== –û–°–ù–û–í–ù–ê–Ø –°–ï–¢–ö–ê ==================== -->
    <div class="main-layout">
        
        <!-- ==================== –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ ==================== -->
        <div class="left-panel">
            
            <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞ -->
            <div class="panel">
                <div class="panel-title">
                    <span class="icon">‚ö°</span>
                    –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù
                    <span class="panel-subtitle" id="throne-status">–ê–ö–¢–ò–í–ï–ù</span>
                </div>
                
                <div class="astronomican-display" id="astro-display" style="position: relative;">
                    <!-- –ù–æ–≤—ã–π canvas –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏ -->
                    <canvas id="astronomican-canvas" width="600" height="400" 
                            style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); border-radius: 4px;">
                    </canvas>
                    <!-- –°—Ç–∞—Ä–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–∫ fallback (—Å–∫—Ä—ã—Ç–∞) -->
                    <div class="golden-throne" id="golden-throne" style="display: none;"></div>
                    <div class="astronomican-beam" style="display: none;"></div>
                </div>
                
                <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –ó–æ–ª–æ—Ç–æ–≥–æ –¢—Ä–æ–Ω–∞ -->
                <div class="metric">
                    <span class="metric-label">
                        <span>üëë</span> –°–æ—Å—Ç–æ—è–Ω–∏–µ –¢—Ä–æ–Ω–∞
                    </span>
                    <span class="metric-value" id="throne-condition">100%</span>
                </div>
                
                <div class="progress-container">
                    <div class="progress-header">
                        <span class="progress-title">–ú–æ—â–Ω–æ—Å—Ç—å –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞</span>
                        <span class="progress-percentage" id="astro-power-pct">100%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="astro-power-fill" style="width: 100%">
                            <div class="progress-label" id="astro-power-label">100%</div>
                        </div>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-header">
                        <span class="progress-title">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</span>
                        <span class="progress-percentage" id="stability-pct">100%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="stability-fill" style="width: 100%">
                            <div class="progress-label" id="stability-label">100%</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏—è–º–∏ -->
            <div class="panel">
                <div class="panel-title">
                    <span class="icon">üî•</span>
                    –ñ–ï–†–¢–í–û–ü–†–ò–ù–û–®–ï–ù–ò–Ø
                </div>
                
                <div class="metric">
                    <span class="metric-label">
                        <span>üíÄ</span> –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞—Å—Ö–æ–¥–∞
                    </span>
                    <span class="metric-value" id="sacrifice-rate">1000/–¥–µ–Ω—å</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">
                        <span>‚ö°</span> –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                    </span>
                    <span class="metric-value" id="sacrifice-efficiency">100%</span>
                </div>
                
                <div class="button-group">
                    <button class="button" id="btn-sacrifice-low" onclick="Game.setSacrificeRate('low')">
                        –ù–∏–∑–∫–∞—è<br><small>(500/–¥–µ–Ω—å)</small>
                    </button>
                    <button class="button" id="btn-sacrifice-normal" onclick="Game.setSacrificeRate('normal')">
                        –°—Ä–µ–¥–Ω—è—è<br><small>(1000/–¥–µ–Ω—å)</small>
                    </button>
                    <button class="button" id="btn-sacrifice-high" onclick="Game.setSacrificeRate('high')">
                        –í—ã—Å–æ–∫–∞—è<br><small>(2000/–¥–µ–Ω—å)</small>
                    </button>
                </div>
                
                <button class="button danger" id="btn-emergency" onclick="Game.emergencyPower()" style="width: 100%">
                    ‚ö†Ô∏è –ê–í–ê–†–ò–ô–ù–´–ô –†–ï–ñ–ò–ú ‚ö†Ô∏è<br>
                    <small>(—Ö3 —Ä–∞—Å—Ö–æ–¥, 500 –∫—Ä–µ–¥–∏—Ç–æ–≤)</small>
                </button>
            </div>
            
            <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∞—Ä–ø–∞ -->
            <div class="panel">
                <div class="panel-title">
                    <span class="icon">üåÄ</span>
                    –í–ê–†–ü-–ê–ö–¢–ò–í–ù–û–°–¢–¨
                </div>
                
                <div class="progress-container">
                    <div class="progress-header">
                        <span class="progress-title">–£—Ä–æ–≤–µ–Ω—å –≤–∞—Ä–ø–∞</span>
                        <span class="progress-percentage" id="warp-level-pct">25%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill warning" id="warp-level-fill" style="width: 25%">
                            <div class="progress-label" id="warp-level-label">–£–º–µ—Ä–µ–Ω–Ω–æ</div>
                        </div>
                    </div>
                </div>
                
                <div class="metric">
                    <span class="metric-label">
                        <span>üëπ</span> –£–≥—Ä–æ–∑–∞ –¥–µ–º–æ–Ω–æ–≤
                    </span>
                    <span class="metric-value warning" id="demon-threat">–ù–∏–∑–∫–∞—è</span>
                </div>
                
                <div class="metric">
                    <span class="metric-label">
                        <span>üå™Ô∏è</span> –í–∞—Ä–ø-—à—Ç–æ—Ä–º—ã
                    </span>
                    <span class="metric-value" id="warp-storms">0</span>
                </div>
                
                <button class="button" onclick="Game.showWarpDetails()" style="width: 100%">
                    –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏
                </button>
            </div>
        </div>
        
        <!-- ==================== –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ü–ê–ù–ï–õ–¨ ==================== -->
        <div class="center-panel">
            <div class="panel">
                
                <!-- –í–∫–ª–∞–¥–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                <div class="tabs">
                    <button class="tab active" onclick="Game.switchTab('overview')">
                        üìä –û–±–∑–æ—Ä
                    </button>
                    <button class="tab" onclick="Game.switchTab('sectors')">
                        üó∫Ô∏è –°–µ–∫—Ç–æ—Ä—ã
                    </button>
                    <button class="tab" onclick="Game.switchTab('personnel')">
                        üë§ –ü–µ—Ä—Å–æ–Ω–∞–ª
                    </button>
                    <button class="tab" onclick="Game.switchTab('research')">
                        üî¨ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
                    </button>
                    <button class="tab" onclick="Game.switchTab('military')">
                        ‚öîÔ∏è –í–æ–µ–Ω–Ω—ã–µ
                    </button>
                    <button class="tab" onclick="Game.switchTab('enemies')">
                        ‚ò†Ô∏è –í—Ä–∞–≥–∏
                    </button>
                    <button class="tab" onclick="Game.switchTab('upgrades')">
                        ‚¨ÜÔ∏è –£–ª—É—á—à–µ–Ω–∏—è
                    </button>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –û–ë–ó–û–† ========== -->
                <div class="tab-content active" id="tab-overview">
                    <div class="stats-grid">
                        <div class="stat-box">
                            <span class="stat-label">–î–µ–Ω—å</span>
                            <span class="stat-number" id="stat-day">1</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ñ–µ—Ä—Ç–≤ –ø—Ä–∏–Ω–µ—Å–µ–Ω–æ</span>
                            <span class="stat-number" id="stat-sacrifices">0</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–µ —Å–µ–∫—Ç–æ—Ä—ã</span>
                            <span class="stat-number" id="stat-sectors">50</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –º–∏—Ä—ã</span>
                            <span class="stat-number" id="stat-lost-worlds">0</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–í—Ä–∞–≥–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã</span>
                            <span class="stat-number" id="stat-enemies-killed">0</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –º–∏—Å—Å–∏–π</span>
                            <span class="stat-number" id="stat-missions">0</span>
                        </div>
                    </div>
                    
                    <div class="panel-title" style="margin-top: 30px;">
                        <span class="icon">üìú</span>
                        –ê–ö–¢–ò–í–ù–´–ï –ú–ò–°–°–ò–ò
                    </div>
                    
                    <div id="active-missions-container">
                        <div style="text-align: center; padding: 40px; color: #666;">
                            –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∏—Å—Å–∏–π
                        </div>
                    </div>
                    
                    <div class="panel-title" style="margin-top: 30px;">
                        <span class="icon">üéØ</span>
                        –î–û–°–¢–ò–ñ–ï–ù–ò–Ø
                    </div>
                    
                    <div class="grid" id="achievements-grid">
                        <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –°–ï–ö–¢–û–†–´ ========== -->
                <div class="tab-content" id="tab-sectors">
                    <div class="panel-title">
                        <span class="icon">üó∫Ô∏è</span>
                        –ì–ê–õ–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –ö–ê–†–¢–ê
                    </div>
                    
                    <div style="background: rgba(0,0,0,0.5); padding: 20px; border: 2px solid #444; border-radius: 4px; margin-bottom: 20px;">
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                            <div class="metric">
                                <span class="metric-label">–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ</span>
                                <span class="metric-value success" id="sectors-safe">40</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">–ü–æ–¥ —É–≥—Ä–æ–∑–æ–π</span>
                                <span class="metric-value warning" id="sectors-threatened">8</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">–í –≤–æ–π–Ω–µ</span>
                                <span class="metric-value critical" id="sectors-war">2</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">–ü–æ—Ç–µ—Ä—è–Ω—ã</span>
                                <span class="metric-value" id="sectors-lost">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid" id="sectors-grid">
                        <!-- –°–µ–∫—Ç–æ—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>

                <!-- –ü–ê–ù–ï–õ–¨ –†–ï–ü–£–¢–ê–¶–ò–ò -->
                <div class="panel">
                    <div class="panel-title collapsible" onclick="Game.togglePanel(this)">
                        <span class="icon">ü§ù</span>
                        –†–ï–ü–£–¢–ê–¶–ò–Ø –° –§–†–ê–ö–¶–ò–Ø–ú–ò
                        <span class="toggle-icon">‚ñº</span>
                    </div>
                    
                    <div class="panel-content">
                        <div style="display: grid; gap: 15px;">
                            <!-- –ú–µ—Ö–∞–Ω–∏–∫—É—Å -->
                            <div class="reputation-faction">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                    <span style="font-weight: bold;">‚öôÔ∏è –ê–¥–µ–ø—Ç—É—Å –ú–µ—Ö–∞–Ω–∏–∫—É—Å</span>
                                    <span id="rep-mechanicus-status" style="color: var(--imperial-gold);">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã</span>
                                </div>
                                <div class="progress-bar" style="height: 15px;">
                                    <div class="progress-fill" id="rep-mechanicus-bar" style="width: 50%;">
                                        <div class="progress-label" id="rep-mechanicus-level">50</div>
                                    </div>
                                </div>
                                <div style="font-size: 0.8em; color: #888; margin-top: 3px;">
                                    –ë–æ–Ω—É—Å—ã: –†–µ–º–æ–Ω—Ç –¢—Ä–æ–Ω–∞ +<span id="rep-mechanicus-bonus">0</span>%
                                </div>
                            </div>
                            
                            <!-- –ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è -->
                            <div class="reputation-faction">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                    <span style="font-weight: bold;">üëÅÔ∏è –ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è</span>
                                    <span id="rep-inquisition-status" style="color: var(--imperial-gold);">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã</span>
                                </div>
                                <div class="progress-bar" style="height: 15px;">
                                    <div class="progress-fill" id="rep-inquisition-bar" style="width: 50%;">
                                        <div class="progress-label" id="rep-inquisition-level">50</div>
                                    </div>
                                </div>
                                <div style="font-size: 0.8em; color: #888; margin-top: 3px;">
                                    –ë–æ–Ω—É—Å—ã: –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–ø–∞ +<span id="rep-inquisition-bonus">0</span>%
                                </div>
                            </div>
                            
                            <!-- –≠–∫–∫–ª–µ–∑–∏–∞—Ä—Ö–∏—è -->
                            <div class="reputation-faction">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                    <span style="font-weight: bold;">‚úùÔ∏è –≠–∫–∫–ª–µ–∑–∏–∞—Ä—Ö–∏—è</span>
                                    <span id="rep-ecclesiarchy-status" style="color: var(--imperial-gold);">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã</span>
                                </div>
                                <div class="progress-bar" style="height: 15px;">
                                    <div class="progress-fill" id="rep-ecclesiarchy-bar" style="width: 50%;">
                                        <div class="progress-label" id="rep-ecclesiarchy-level">50</div>
                                    </div>
                                </div>
                                <div style="font-size: 0.8em; color: #888; margin-top: 3px;">
                                    –ë–æ–Ω—É—Å—ã: –ú–æ—Ä–∞–ª—å +<span id="rep-ecclesiarchy-bonus">0</span>%
                                </div>
                            </div>
                            
                            <!-- –ò–º–ø–µ—Ä—Å–∫–∏–π –§–ª–æ—Ç -->
                            <div class="reputation-faction">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                    <span style="font-weight: bold;">üöÄ –ò–º–ø–µ—Ä—Å–∫–∏–π –§–ª–æ—Ç</span>
                                    <span id="rep-imperialNavy-status" style="color: var(--imperial-gold);">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã</span>
                                </div>
                                <div class="progress-bar" style="height: 15px;">
                                    <div class="progress-fill" id="rep-imperialNavy-bar" style="width: 50%;">
                                        <div class="progress-label" id="rep-imperialNavy-level">50</div>
                                    </div>
                                </div>
                                <div style="font-size: 0.8em; color: #888; margin-top: 3px;">
                                    –ë–æ–Ω—É—Å—ã: –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ñ–ª–æ—Ç–∞ +<span id="rep-imperialNavy-bonus">0</span>%
                                </div>
                            </div>
                            
                            <!-- –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç -->
                            <div class="reputation-faction">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                    <span style="font-weight: bold;">‚öîÔ∏è –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç</span>
                                    <span id="rep-astartes-status" style="color: var(--imperial-gold);">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã</span>
                                </div>
                                <div class="progress-bar" style="height: 15px;">
                                    <div class="progress-fill" id="rep-astartes-bar" style="width: 50%;">
                                        <div class="progress-label" id="rep-astartes-level">50</div>
                                    </div>
                                </div>
                                <div style="font-size: 0.8em; color: #888; margin-top: 3px;">
                                    –ë–æ–Ω—É—Å—ã: –í–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ +<span id="rep-astartes-bonus">0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #444;">
                            <div style="font-size: 0.85em; color: #aaa;">
                                <strong>–°–æ–≤–µ—Ç:</strong> –†–µ–ø—É—Ç–∞—Ü–∏—è –ø–æ–≤—ã—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏—Å—Å–∏–π, –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –ø–æ–º–æ—â—å —Ñ—Ä–∞–∫—Ü–∏—è–º.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –ü–ï–†–°–û–ù–ê–õ ========== -->
                <div class="tab-content" id="tab-personnel">
                    <div class="panel-title">
                        <span class="icon">üë§</span>
                        –ö–õ–Æ–ß–ï–í–û–ô –ü–ï–†–°–û–ù–ê–õ
                    </div>
                    
                    <div class="button-group">
                        <button class="button" onclick="Game.showPersonnelCategory('inquisitors')">
                            üîç –ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä—ã
                        </button>
                        <button class="button" onclick="Game.showPersonnelCategory('techpriests')">
                            ‚öôÔ∏è –¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü—ã
                        </button>
                        <button class="button" onclick="Game.showPersonnelCategory('astropaths')">
                            üì° –ê—Å—Ç—Ä–æ–ø–∞—Ç—ã
                        </button>
                        <button class="button" onclick="Game.showPersonnelCategory('generals')">
                            ‚öîÔ∏è –ì–µ–Ω–µ—Ä–∞–ª—ã
                        </button>
                        <button class="button" onclick="Game.showPersonnelCategory('navigators')">
                            üß≠ –ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã
                        </button>
                        <button class="button" onclick="Game.showPersonnelCategory('administrators')">
                            üìã –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
                        </button>
                    </div>
                    
                    <div class="grid" id="personnel-grid">
                        <!-- –ü–µ—Ä—Å–æ–Ω–∞–ª –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø ========== -->
                <div class="tab-content" id="tab-research">
                    <div class="panel-title">
                        <span class="icon">üî¨</span>
                        –¢–ï–•–ù–û–õ–û–ì–ò–ß–ï–°–ö–ò–ï –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø
                    </div>
                    
                    <div class="button-group">
                        <button class="button" onclick="Game.showResearchCategory('psychic')">
                            üîÆ –ü—Å–∞–π–∫–µ—Ä
                        </button>
                        <button class="button" onclick="Game.showResearchCategory('warp')">
                            üåÄ –í–∞—Ä–ø
                        </button>
                        <button class="button" onclick="Game.showResearchCategory('military')">
                            ‚öîÔ∏è –í–æ–µ–Ω–Ω—ã–µ
                        </button>
                        <button class="button" onclick="Game.showResearchCategory('archeoteh')">
                            üèõÔ∏è –ê—Ä—Ö–µ–æ—Ç–µ—Ö
                        </button>
                        <button class="button" onclick="Game.showResearchCategory('defense')">
                            üõ°Ô∏è –û–±–æ—Ä–æ–Ω–∞
                        </button>
                    </div>
                    
                    <div id="current-research" style="margin: 20px 0;">
                        <!-- –¢–µ–∫—É—â–µ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ -->
                    </div>
                    
                    <div class="grid" id="research-grid">
                        <!-- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –í–û–ï–ù–ù–´–ï ========== -->
                <div class="tab-content" id="tab-military">
                    <div class="panel-title">
                        <span class="icon">‚öîÔ∏è</span>
                        –í–û–ï–ù–ù–´–ï –°–ò–õ–´ –ò–ú–ü–ï–†–ò–£–ú–ê
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-box">
                            <span class="stat-label">–ê—Å—Ç—Ä–∞ –ú–∏–ª–∏—Ç–∞—Ä—É–º</span>
                            <span class="stat-number" id="military-guardsmen">100M</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç</span>
                            <span class="stat-number" id="military-spacemarines">1000</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ò–º–ø–µ—Ä—Å–∫–∏–π —Ñ–ª–æ—Ç</span>
                            <span class="stat-number" id="military-fleet">50</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–ê–¥–µ–ø—Ç—É—Å –°–æ—Ä–æ—Ä–∏—Ç–∞—Å</span>
                            <span class="stat-number" id="military-sororitas">500</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–¢–∏—Ç–∞–Ω—ã</span>
                            <span class="stat-number" id="military-titans">10</span>
                        </div>
                        <div class="stat-box">
                            <span class="stat-label">–û—Ä–±–∏—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏</span>
                            <span class="stat-number" id="military-stations">5</span>
                        </div>
                    </div>
                    
                    <div class="panel-title" style="margin-top: 30px;">
                        <span class="icon">üöÄ</span>
                        –ü–†–û–ò–ó–í–û–î–°–¢–í–û –ò –ù–ê–ô–ú
                    </div>
                    
                    <div class="grid" id="military-recruitment-grid">
                        <!-- –ù–∞–π–º –≤–æ–π—Å–∫ -->
                    </div>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –í–†–ê–ì–ò ========== -->
                <div class="tab-content" id="tab-enemies">
                    <div class="panel-title">
                        <span class="icon">‚ò†Ô∏è</span>
                        –í–†–ê–ì–ò –ò–ú–ü–ï–†–ò–£–ú–ê
                    </div>
                    
                    <div class="grid" id="enemies-grid">
                        <!-- –í—Ä–∞–≥–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div class="panel-title" style="margin-top: 30px;">
                        <span class="icon">‚ö°</span>
                        –ê–ö–¢–ò–í–ù–´–ï –£–ì–†–û–ó–´
                    </div>
                    
                    <div id="active-threats-container">
                        <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ —É–≥—Ä–æ–∑—ã -->
                    </div>
                </div>
                
                <!-- ========== –í–ö–õ–ê–î–ö–ê: –£–õ–£–ß–®–ï–ù–ò–Ø ========== -->
                <div class="tab-content" id="tab-upgrades">
                    <div class="panel-title">
                        <span class="icon">‚¨ÜÔ∏è</span>
                        –£–õ–£–ß–®–ï–ù–ò–Ø –°–ò–°–¢–ï–ú
                    </div>
                    
                    <div class="button-group">
                        <button class="button" onclick="Game.showUpgradeCategory('throne')">
                            üëë –ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω
                        </button>
                        <button class="button" onclick="Game.showUpgradeCategory('astronomican')">
                            ‚ö° –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω
                        </button>
                        <button class="button" onclick="Game.showUpgradeCategory('defense')">
                            üõ°Ô∏è –û–±–æ—Ä–æ–Ω–∞ –¢–µ—Ä—Ä—ã
                        </button>
                        <button class="button" onclick="Game.showUpgradeCategory('infrastructure')">
                            üèóÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
                        </button>
                        <button class="button" onclick="Game.showUpgradeCategory('economy')">
                            üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞
                        </button>
                    </div>
                    
                    <div class="grid" id="upgrades-grid">
                        <!-- –£–ª—É—á—à–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
            </div>
        </div>

        <!-- –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–ê–Ø –ö–ê–†–¢–ê –ì–ê–õ–ê–ö–¢–ò–ö–ò -->
        <div class="panel" style="grid-column: 1 / -1;">
            <div class="panel-title collapsible" onclick="Game.togglePanel(this)">
                <span class="icon">üåå</span>
                –ö–ê–†–¢–ê –ì–ê–õ–ê–ö–¢–ò–ö–ò
                <span class="toggle-icon">‚ñº</span>
            </div>
            
            <div class="panel-content">
                <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ -->
                <div style="margin-bottom: 15px; display: flex; gap: 10px; justify-content: center;">
                    <button class="button active" id="btn-view-segmentums" onclick="Game.setMapViewMode('segmentums')"
                            style="min-width: 150px;">
                        üåå –°–µ–≥–º–µ–Ω—Ç—É–º—ã
                    </button>
                    <button class="button" id="btn-view-sectors" onclick="Game.setMapViewMode('sectors')"
                            style="min-width: 150px;">
                        üó∫Ô∏è –°–µ–∫—Ç–æ—Ä—ã
                    </button>
                </div>
                
                <!-- Canvas –¥–ª—è –∫–∞—Ä—Ç—ã -->
                <div style="position: relative; background: #000; border: 2px solid #444; border-radius: 4px; overflow: hidden;">
                    <canvas id="galaxy-map-canvas" width="800" height="600"
                            style="display: block; cursor: crosshair;">
                    </canvas>
                    
                    <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.8); padding: 15px; border: 1px solid var(--imperial-gold); border-radius: 4px; font-size: 0.85em;">
                        <div style="margin-bottom: 10px; color: var(--imperial-gold); font-weight: bold;">–õ–ï–ì–ï–ù–î–ê</div>
                        <div id="legend-segmentums" style="display: block;">
                            <div style="font-weight: bold; margin-bottom: 5px; color: #aaa;">–°–µ–≥–º–µ–Ω—Ç—É–º—ã:</div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #FFD700; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–°–æ–ª–∞—Ä</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #4B0082; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–û–±—Å–∫—É—Ä—É—Å</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #0066CC; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–£–ª—å—Ç–∏–º–∞</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #CC6600; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–¢–µ–º–ø–µ—Å—Ç—É—Å</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #006633; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–ü–∞—Ü–∏—Ñ–∏–∫—É—Å</span>
                            </div>
                        </div>
                        <div id="legend-sectors" style="display: none;">
                            <div style="font-weight: bold; margin-bottom: 5px; color: #aaa;">–°—Ç–∞—Ç—É—Å—ã:</div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #00ff00; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–ë–µ–∑–æ–ø–∞—Å–Ω–æ</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #ffaa00; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–ü–æ–¥ —É–≥—Ä–æ–∑–æ–π</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #ff0000; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–í–æ–π–Ω–∞</span>
                            </div>
                            <div style="display: flex; align-items: center; margin: 5px 0;">
                                <div style="width: 15px; height: 15px; background: #8b0000; margin-right: 8px; border-radius: 50%;"></div>
                                <span>–ü–æ—Ç–µ—Ä—è–Ω–æ</span>
                            </div>
                            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #444;">
                                <div style="font-weight: bold; margin-bottom: 5px; color: #aaa;">–£–≥—Ä–æ–∑—ã:</div>
                                <div style="font-size: 0.9em;">
                                    <div>‚ò† –•–∞–æ—Å</div>
                                    <div>üëæ –¢–∏—Ä–∞–Ω–∏–¥—ã</div>
                                    <div>üíÄ –ù–µ–∫—Ä–æ–Ω—ã</div>
                                    <div>‚öî –û—Ä–∫–∏</div>
                                </div>
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; margin: 10px 0 5px; padding-top: 10px; border-top: 1px solid #444;">
                            <div style="width: 15px; height: 15px; background: transparent; border: 2px solid #6a0dad; margin-right: 8px; border-radius: 50%;"></div>
                            <span>–í–∞—Ä–ø-—à—Ç–æ—Ä–º</span>
                        </div>
                    </div>
                    
                    <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ -->
                    <div id="map-info-panel" style="position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.9); padding: 15px; border: 2px solid var(--imperial-gold); border-radius: 4px; min-width: 300px; display: none;">
                        <div style="font-family: 'Cinzel', serif; font-size: 1.1em; color: var(--imperial-gold); margin-bottom: 10px;" id="map-info-name">
                            –ù–∞–∑–≤–∞–Ω–∏–µ
                        </div>
                        <div style="font-size: 0.9em;" id="map-info-details">
                            <!-- –î–µ—Ç–∞–ª–∏ -->
                        </div>
                        <div style="margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px;" id="map-info-actions">
                            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                        </div>
                    </div>
                </div>
                
                <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ–π -->
                <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; gap: 10px;">
                        <button class="button" onclick="Game.galaxyMapZoom(0.1)" title="–£–≤–µ–ª–∏—á–∏—Ç—å">
                            üîç+
                        </button>
                        <button class="button" onclick="Game.galaxyMapZoom(-0.1)" title="–£–º–µ–Ω—å—à–∏—Ç—å">
                            üîç-
                        </button>
                        <button class="button" onclick="Game.galaxyMapReset()" title="–°–±—Ä–æ—Å –≤–∏–¥–∞">
                            üéØ –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                            <input type="checkbox" id="map-show-astro" checked onchange="Game.updateGalaxyMap()">
                            <span>–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                            <input type="checkbox" id="map-show-fleets" checked onchange="Game.updateGalaxyMap()">
                            <span>–§–ª–æ—Ç—ã</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;" id="map-connections-toggle">
                            <input type="checkbox" id="map-show-connections" checked onchange="Game.updateGalaxyMap()">
                            <span>–°–≤—è–∑–∏</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ==================== –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ ==================== -->
        <div class="right-panel">
            
            <!-- –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π -->
            <div class="panel">
                <div class="panel-title">
                    <span class="icon">üìú</span>
                    –õ–û–ì –°–û–ë–´–¢–ò–ô
                    <button class="button" style="margin-left: auto; padding: 5px 15px; font-size: 0.8em;" onclick="Game.clearLog()">
                        –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>
                
                <div class="event-log" id="event-log">
                    <!-- –°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="panel">
                <div class="panel-title">
                    <span class="icon">‚ö°</span>
                    –ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø
                </div>
                
                <button class="button success" onclick="Game.recruitPsykers()" style="width: 100%; margin: 5px 0;">
                    üîÆ –ù–∞–±—Ä–∞—Ç—å –ø—Å–∞–π–∫–µ—Ä–æ–≤<br>
                    <small>(1000 –∫—Ä–µ–¥–∏—Ç–æ–≤)</small>
                </button>
                
                <button class="button" onclick="Game.stabilizeSector()" style="width: 100%; margin: 5px 0;">
                    üõ°Ô∏è –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∫—Ç–æ—Ä<br>
                    <small>(500 –∫—Ä–µ–¥–∏—Ç–æ–≤)</small>
                </button>
                
                <button class="button" onclick="Game.sendInquisitor()" style="width: 100%; margin: 5px 0;">
                    üîç –ü–æ—Å–ª–∞—Ç—å –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä–∞<br>
                    <small>(300 –∫—Ä–µ–¥–∏—Ç–æ–≤)</small>
                </button>
                
                <button class="button" onclick="Game.reinforceFleet()" style="width: 100%; margin: 5px 0;">
                    üöÄ –£—Å–∏–ª–∏—Ç—å —Ñ–ª–æ—Ç<br>
                    <small>(2000 –∫—Ä–µ–¥–∏—Ç–æ–≤)</small>
                </button>
                
                <div style="border-top: 2px solid #444; margin: 15px 0; padding-top: 15px;">
                    <button class="button" onclick="Game.save()" style="width: 100%; margin: 5px 0;">
                        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    
                    <button class="button" onclick="Game.load()" style="width: 100%; margin: 5px 0;">
                        üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å
                    </button>
                    
                    <button class="button danger" onclick="Game.showSettings()" style="width: 100%; margin: 5px 0;">
                        ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                </div>
            </div>
            
        </div>
        
    </div>

    <div class="panel collapsible" id="panel-advanced-stats">
        <h2 class="panel-title" onclick="Game.togglePanel('panel-advanced-stats')">
            <span class="icon">üìä</span>
            –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            <span class="panel-subtitle">–ê–ù–ê–õ–ò–¢–ò–ö–ê</span>
        </h2>
        <div class="panel-content" id="advanced-stats-content">
            <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

</div>

<!-- ==================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ==================== -->

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ -->
<div id="modal-choice" class="modal-overlay" style="display: none;">
    <div class="modal">
        <div class="modal-header" id="choice-title">–í—ã–±–æ—Ä</div>
        <div id="choice-content" style="padding: 20px;">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ -->
        </div>
        <div id="choice-options" style="display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap;">
            <!-- –û–ø—Ü–∏–∏ –≤—ã–±–æ—Ä–∞ -->
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
<div id="modal-info" class="modal-overlay" style="display: none;">
    <div class="modal">
        <button class="notification-close" onclick="Game.closeModal('info')" style="position: absolute; top: 20px; right: 20px;">√ó</button>
        <div class="modal-header" id="info-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
        <div id="info-content" style="padding: 20px; max-height: 60vh; overflow-y: auto;">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
        </div>
        <button class="button" onclick="Game.closeModal('info')" style="width: 100%; margin-top: 20px;">
            –ó–∞–∫—Ä—ã—Ç—å
        </button>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ Game Over -->
<div id="modal-gameover" class="modal-overlay" style="display: none;">
    <div class="modal">
        <div class="modal-header" style="color: var(--critical-red);">
            ‚ò†Ô∏è –ò–ú–ü–ï–†–ò–£–ú –ü–ê–õ ‚ò†Ô∏è
        </div>
        <div style="padding: 20px; text-align: center;">
            <p style="font-size: 1.2em; margin: 20px 0; line-height: 1.8;">
                –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –ø–æ–≥–∞—Å. –ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω —Ä–∞–∑—Ä—É—à–µ–Ω.<br>
                –¢—å–º–∞ –ø–æ–≥–ª–æ—Ç–∏–ª–∞ –≥–∞–ª–∞–∫—Ç–∏–∫—É.<br>
                –ò–º–ø–µ—Ä–∏—É–º –ß–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞ –ø–∞–ª.
            </p>
            <div id="gameover-stats" style="margin: 30px 0;">
                <!-- –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            </div>
            <button class="button" onclick="Game.restart()" style="margin: 10px;">
                üîÑ –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
            </button>
        </div>
    </div>
</div>

<!-- ==================== –ö–û–ù–¢–ï–ô–ù–ï–† –£–í–ï–î–û–ú–õ–ï–ù–ò–ô ==================== -->
<div class="notification-container" id="notification-container">
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
</div>

<!-- ==================== –ö–û–ù–¢–ï–ô–ù–ï–† –î–û–°–¢–ò–ñ–ï–ù–ò–ô ==================== -->
<div style="position: fixed; bottom: 20px; right: 20px; z-index: 998; max-width: 400px;" id="achievement-container">
    <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –∑–¥–µ—Å—å -->
</div>


<script>
'use strict';

'use strict';

// ==================== –ì–õ–ê–í–ù–´–ô –û–ë–™–ï–ö–¢ –ò–ì–†–´ ====================
const Game = {
    // ========== –ë–ê–ó–û–í–û–ï –°–û–°–¢–û–Ø–ù–ò–ï ==========
    version: '1.0.0',
    running: false,
    paused: false,
    gameOver: false,
    
    // ========== –í–†–ï–ú–Ø ==========
    day: 1,
    hour: 0,
    tickSpeed: 1000, // –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Ç–∏–∫–∞–º–∏
    lastTick: Date.now(),
    
    // ========== –û–°–ù–û–í–ù–´–ï –†–ï–°–£–†–°–´ ==========
    resources: {
        psychic: 5000,      // –ü—Å–∞–π–∫–µ—Ä—ã (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ)
        credits: 10000,     // –ö—Ä–µ–¥–∏—Ç—ã
        population: 1000,   // –ù–∞—Å–µ–ª–µ–Ω–∏–µ –≤ –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö
        military: 100,      // –ê—Ä–º–∏—è –≤ –º–∏–ª–ª–∏–æ–Ω–∞—Ö
        fleet: 50,          // –ö–æ—Ä–∞–±–ª–µ–π —Ñ–ª–æ—Ç–∞
        techpriests: 10     // –¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü–æ–≤
    },
    
    // –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –¥–µ–Ω—å
    resourceChanges: {
        psychic: -1000,     // –ë–∞–∑–æ–≤–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –Ω–∞ –¢—Ä–æ–Ω
        credits: 100,       // –ë–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥
        population: 1,      // –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç
        military: 0.5,      // –ù–∞–±–æ—Ä –≤ –∞—Ä–º–∏—é
        fleet: 0,           // –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∫–æ—Ä–∞–±–ª–µ–π
        techpriests: 0      // –û–±—É—á–µ–Ω–∏–µ —Ç–µ—Ö–Ω–æ–∂—Ä–µ—Ü–æ–≤
    },
    
    // ========== –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù –ò –ó–û–õ–û–¢–û–ô –¢–†–û–ù ==========
    astronomican: {
        power: 100,
        stability: 100,
        throneCondition: 100,
        sacrificeRate: 1000,
        efficiency: 100,
        emergencyMode: false,
        emergencyTurns: 0,
        // –ù–û–í–û–ï: –î–∞–Ω–Ω—ã–µ –¥–ª—è canvas-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
        visual: {
            layers: {
                core: { size: 30, rotation: 0, pulse: 0 },
                middle: { size: 50, rotation: 0, runes: [] },
                outer: { size: 70, rotation: 0 },
                corona: { size: 100, beams: 8 }
            },
            particles: {
                golden: [],
                white: [],
                red: [],
                trailing: []
            },
            effects: {
                flash: { active: false, intensity: 0, timer: 0 },
                distortion: { active: false, wave: 0 },
                chaos: { active: false, cracks: [] }
            }
        }
    },

    // –°—á—ë—Ç—á–∏–∫ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
    perfectThroneDays: 0,

    // ========== –ß–Å–†–ù–´–ï –ö–û–†–ê–ë–õ–ò –ò –¢–ò–ü–´ –ü–°–ê–ô–ö–ï–†–û–í ==========
    blackShips: {
        nextArrival: 15,        // –î–Ω–µ–π –¥–æ –ø—Ä–∏–±—ã—Ç–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ—Ä–∞–±–ª—è
        interval: 15,           // –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø—Ä–∏–±—ã—Ç–∏—è–º–∏
        lastArrival: 0          // –î–µ–Ω—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–±—ã—Ç–∏—è
    },
    
    psykerPool: {
        alpha: 0,   // –û—Å–æ–±–æ —Å–∏–ª—å–Ω—ã–µ (—Ä–µ–¥–∫–∏–µ)
        beta: 0,    // –°–∏–ª—å–Ω—ã–µ (–Ω–µ–æ–±—ã—á–Ω—ã–µ)
        gamma: 0,   // –û–±—ã—á–Ω—ã–µ (—á–∞—Å—Ç—ã–µ)
        delta: 0    // –°–ª–∞–±—ã–µ (–º–∞—Å—Å–æ–≤—ã–µ)
    },
    
    psykerTypes: {
        alpha: {
            name: '–ê–ª—å—Ñ–∞-–ø—Å–∞–π–∫–µ—Ä',
            power: 10,          // –ú–æ—â–Ω–æ—Å—Ç—å –¥–ª—è –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞
            stability: 30,      // –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (%)
            rarity: 0.02,       // 2% —à–∞–Ω—Å –≤ –ø–∞—Ä—Ç–∏–∏
            description: '–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –º–æ—â–Ω—ã–π, –Ω–æ –∫—Ä–∞–π–Ω–µ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π. –†–µ–¥—á–∞–π—à–∞—è –Ω–∞—Ö–æ–¥–∫–∞.',
            icon: 'üî•',
            color: '#ff0000',
            inquisitionValue: 5000,  // –¶–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏
            astartesValue: 7000      // –¶–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç–∞
        },
        beta: {
            name: '–ë–µ—Ç–∞-–ø—Å–∞–π–∫–µ—Ä',
            power: 5,
            stability: 60,
            rarity: 0.08,       // 8% —à–∞–Ω—Å
            description: '–°–∏–ª—å–Ω—ã–π –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π. –ú–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ë–∏–±–ª–∏–∞—Ä–∏–µ–º.',
            icon: '‚ö°',
            color: '#ffaa00',
            inquisitionValue: 2000,
            astartesValue: 3000
        },
        gamma: {
            name: '–ì–∞–º–º–∞-–ø—Å–∞–π–∫–µ—Ä',
            power: 2,
            stability: 80,
            rarity: 0.25,       // 25% —à–∞–Ω—Å
            description: '–û–±—ã—á–Ω—ã–π –ø—Å–∞–π–∫–µ—Ä. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ç–æ–ø–ª–∏–≤–æ –¥–ª—è –¢—Ä–æ–Ω–∞.',
            icon: '‚ú®',
            color: '#00aaff',
            inquisitionValue: 500,
            astartesValue: 800
        },
        delta: {
            name: '–î–µ–ª—å—Ç–∞-–ø—Å–∞–π–∫–µ—Ä',
            power: 1,
            stability: 95,
            rarity: 0.65,       // 65% —à–∞–Ω—Å (–æ—Å—Ç–∞—Ç–æ–∫)
            description: '–°–ª–∞–±—ã–π, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π. –û—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞.',
            icon: 'üí´',
            color: '#00ff00',
            inquisitionValue: 100,
            astartesValue: 200
        }
    },
    
    // ========== –í–ê–†–ü ==========
    warp: {
        level: 25,              // –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–∞—Ä–ø–∞ (0-100)
        storms: 0,              // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–ø-—à—Ç–æ—Ä–º–æ–≤
        rifts: [],              // –ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–∞–∑–ª–æ–º—ã
        demonThreat: 10,        // –£–≥—Ä–æ–∑–∞ –¥–µ–º–æ–Ω–æ–≤ (0-100)
        chaosIncursions: 0      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ç–æ—Ä–∂–µ–Ω–∏–π –•–∞–æ—Å–∞
    },
    
    // ========== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ==========
    stats: {
        totalSacrifices: 0,     // –í—Å–µ–≥–æ –ø—Ä–∏–Ω–µ—Å–µ–Ω–æ –≤ –∂–µ—Ä—Ç–≤—É
        totalCreditsEarned: 0,  // –í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤
        enemiesKilled: 0,       // –í—Ä–∞–≥–æ–≤ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–æ
        missionsCompleted: 0,   // –ú–∏—Å—Å–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ
        sectorsLost: 0,         // –°–µ–∫—Ç–æ—Ä–æ–≤ –ø–æ—Ç–µ—Ä—è–Ω–æ
        projectsCompleted: 0,   // –ü—Ä–æ–µ–∫—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
        researchCompleted: 0    // –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ
    },
    
// ========== –°–ï–ì–ú–ï–ù–¢–£–ú–´ –ò –°–ï–ö–¢–û–†–´ (–ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ò–ï–†–ê–†–•–ò–Ø) ==========

// –ù–û–í–û–ï: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç—É–º–æ–≤
segmentums: [
    {
        id: 1,
        name: '–°–µ–≥–º–µ–Ω—Ç—É–º –°–æ–ª–∞—Ä',
        description: '–°–µ—Ä–¥—Ü–µ –ò–º–ø–µ—Ä–∏—É–º–∞, —Å–æ–¥–µ—Ä–∂–∏—Ç –°–≤—è—Ç—É—é –¢–µ—Ä—Ä—É',
        color: '#FFD700',
        coordinates: { x: 400, y: 300 },  // –¶–µ–Ω—Ç—Ä –Ω–∞ –∫–∞—Ä—Ç–µ
        size: 120,                         // –†–∞–¥–∏—É—Å –æ–±–ª–∞—Å—Ç–∏
        sectors: [1, 2, 3, 4]              // ID —Å–µ–∫—Ç–æ—Ä–æ–≤ –≤ —ç—Ç–æ–º —Å–µ–≥–º–µ–Ω—Ç—É–º–µ
    },
    {
        id: 2,
        name: '–°–µ–≥–º–µ–Ω—Ç—É–º –û–±—Å–∫—É—Ä—É—Å',
        description: '–¢—ë–º–Ω—ã–π —Ä–µ–≥–∏–æ–Ω, –≥—Ä–∞–Ω–∏—á–∏—Ç —Å –û–∫–æ–º –£–∂–∞—Å–∞',
        color: '#4B0082',
        coordinates: { x: 250, y: 150 },
        size: 110,
        sectors: [5, 6, 7, 8]
    },
    {
        id: 3,
        name: '–°–µ–≥–º–µ–Ω—Ç—É–º –ü–∞—Ü–∏—Ñ–∏–∫—É—Å',
        description: '–ó–∞–ø–∞–¥–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –ò–º–ø–µ—Ä–∏—É–º–∞',
        color: '#006633',
        coordinates: { x: 200, y: 380 },
        size: 110,
        sectors: [9, 10, 11, 12]
    },
    {
        id: 4,
        name: '–°–µ–≥–º–µ–Ω—Ç—É–º –£–ª—å—Ç–∏–º–∞',
        description: '–í–æ—Å—Ç–æ—á–Ω—ã–µ —Ä—É–±–µ–∂–∏, —Ä–µ–≥–∏–æ–Ω –£–ª—å—Ç—Ä–∞–º–∞—Ä–∞',
        color: '#0066CC',
        coordinates: { x: 600, y: 300 },
        size: 120,
        sectors: [13, 14, 15, 16]
    },
    {
        id: 5,
        name: '–°–µ–≥–º–µ–Ω—Ç—É–º –¢–µ–º–ø–µ—Å—Ç—É—Å',
        description: '–Æ–∂–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≤–∞—Ä–ø',
        color: '#CC6600',
        coordinates: { x: 400, y: 500 },
        size: 110,
        sectors: [17, 18, 19, 20]
    }
],

// 20 —Å–µ–∫—Ç–æ—Ä–æ–≤ —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç—É–º–∞–º
sectors: [
    // ===== –°–ï–ì–ú–ï–ù–¢–£–ú –°–û–õ–ê–† (4 —Å–µ–∫—Ç–æ—Ä–∞) =====
    {
        id: 1,
        name: '–¢–µ—Ä—Ä–∞–Ω—Å–∫–∏–π —Å–µ–∫—Ç–æ—Ä',
        segmentumId: 1,
        status: 'safe',
        stability: 100,
        threat: null,
        coordinates: { x: 400, y: 280 },
        color: '#FFD700',
        connections: [2, 3, 5, 13],
        fleets: { imperial: 150, enemy: 0 },
        resources: { tithe: 3000, recruitment: 250 },
        specialFeatures: ['–°–≤—è—Ç–∞—è –¢–µ—Ä—Ä–∞', '–ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω', '–ò–º–ø–µ—Ä—Å–∫–∏–π –î–≤–æ—Ä–µ—Ü', '–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω'],
        astroReach: 100,
        population: 1500,
        strategic: true
    },
    {
        id: 2,
        name: '–°–µ–∫—Ç–æ—Ä –ô–æ–≤–∏–∞–Ω',
        segmentumId: 1,
        status: 'safe',
        stability: 95,
        threat: null,
        coordinates: { x: 380, y: 320 },
        color: '#FFD700',
        connections: [1, 3, 4],
        fleets: { imperial: 80, enemy: 0 },
        resources: { tithe: 1800, recruitment: 180 },
        specialFeatures: ['–ú–∞—Ä—Å', '–ö—É–∑–Ω–∏ –ú–µ—Ö–∞–Ω–∏–∫—É—Å', '–û–ª–∏–º–ø—É—Å –ú–æ–Ω—Å'],
        astroReach: 98,
        population: 1000,
        strategic: true
    },
    {
        id: 3,
        name: '–°–µ–∫—Ç–æ—Ä –í–µ–Ω—É—Å',
        segmentumId: 1,
        status: 'safe',
        stability: 92,
        threat: null,
        coordinates: { x: 440, y: 290 },
        color: '#FFD700',
        connections: [1, 2, 4],
        fleets: { imperial: 70, enemy: 0 },
        resources: { tithe: 1600, recruitment: 160 },
        specialFeatures: ['–¢–æ—Ä–≥–æ–≤—ã–µ —É–∑–ª—ã', '–¢—Ä–∞–Ω–∑–∏—Ç–Ω—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏'],
        astroReach: 96,
        population: 850,
        strategic: false
    },
    {
        id: 4,
        name: '–°–µ–∫—Ç–æ—Ä –ó–∞—Ñ–∏—Ä',
        segmentumId: 1,
        status: 'safe',
        stability: 90,
        threat: null,
        coordinates: { x: 420, y: 340 },
        color: '#FFD700',
        connections: [2, 3, 9],
        fleets: { imperial: 65, enemy: 0 },
        resources: { tithe: 1500, recruitment: 150 },
        specialFeatures: ['–ê—Å—Ç—Ä–æ–ø–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏', '–§–ª–æ—Ç—Å–∫–∏–µ –≤–µ—Ä—Ñ–∏'],
        astroReach: 94,
        population: 800,
        strategic: false
    },
    
    // ===== –°–ï–ì–ú–ï–ù–¢–£–ú –û–ë–°–ö–£–†–£–° (4 —Å–µ–∫—Ç–æ—Ä–∞) =====
    {
        id: 5,
        name: '–°–µ–∫—Ç–æ—Ä –ì–æ—Ç–∏–∫–∞',
        segmentumId: 2,
        status: 'war',
        stability: 50,
        threat: 'chaos',
        coordinates: { x: 230, y: 120 },
        color: '#4B0082',
        connections: [1, 6, 13],
        fleets: { imperial: 50, enemy: 40 },
        resources: { tithe: 700, recruitment: 90 },
        specialFeatures: ['–ü–æ—Ä—Ç –ì–Ω–µ–≤–∞', '–û–∫–æ –£–∂–∞—Å–∞ (–≥—Ä–∞–Ω–∏—Ü–∞)', '–†—É–∏–Ω—ã –ö–∞–¥–∏–∏'],
        astroReach: 60,
        population: 450,
        strategic: true
    },
    {
        id: 6,
        name: '–°–µ–∫—Ç–æ—Ä –ö–∞–ª–∏–∫—Å–∏–¥–∞',
        segmentumId: 2,
        status: 'threatened',
        stability: 70,
        threat: 'chaos',
        coordinates: { x: 270, y: 140 },
        color: '#4B0082',
        connections: [5, 7, 8],
        fleets: { imperial: 55, enemy: 20 },
        resources: { tithe: 900, recruitment: 110 },
        specialFeatures: ['–§–æ—Ä—Ç-–º–∏—Ä –°–∫–∏–Ω—Ç–∏–ª–ª–∞', '–°–∏—Å—Ç–µ–º–∞ –ú–∞–ª—Ñ–∏'],
        astroReach: 75,
        population: 550,
        strategic: false
    },
    {
        id: 7,
        name: '–°–µ–∫—Ç–æ—Ä –ú–∞–ª—Ñ–∏',
        segmentumId: 2,
        status: 'threatened',
        stability: 68,
        threat: 'chaos',
        coordinates: { x: 250, y: 180 },
        color: '#4B0082',
        connections: [6, 8, 9],
        fleets: { imperial: 52, enemy: 18 },
        resources: { tithe: 850, recruitment: 105 },
        specialFeatures: ['–ú–∏—Ä—ã-–∫—É–∑–Ω–∏', '–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ä—Ç—ã'],
        astroReach: 72,
        population: 520,
        strategic: false
    },
    {
        id: 8,
        name: '–°–µ–∫—Ç–æ—Ä –ö–æ—Ä–æ–Ω–∞',
        segmentumId: 2,
        status: 'safe',
        stability: 80,
        threat: null,
        coordinates: { x: 290, y: 160 },
        color: '#4B0082',
        connections: [6, 7, 13],
        fleets: { imperial: 60, enemy: 0 },
        resources: { tithe: 1100, recruitment: 130 },
        specialFeatures: ['–ö–æ—Ä–æ–Ω–Ω—ã–µ –º–∏—Ä—ã', '–í–æ–µ–Ω–Ω—ã–µ –∞–∫–∞–¥–µ–º–∏–∏'],
        astroReach: 82,
        population: 650,
        strategic: false
    },
    
    // ===== –°–ï–ì–ú–ï–ù–¢–£–ú –ü–ê–¶–ò–§–ò–ö–£–° (4 —Å–µ–∫—Ç–æ—Ä–∞) =====
    {
        id: 9,
        name: '–°–µ–∫—Ç–æ—Ä –ü–µ—Ä—Å–µ—Ñ–æ–Ω',
        segmentumId: 3,
        status: 'safe',
        stability: 88,
        threat: null,
        coordinates: { x: 170, y: 360 },
        color: '#006633',
        connections: [4, 7, 10],
        fleets: { imperial: 62, enemy: 0 },
        resources: { tithe: 1050, recruitment: 125 },
        specialFeatures: ['–ú–∏—Ä–Ω—ã–µ –º–∏—Ä—ã', '–°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–ª–∞–Ω–µ—Ç—ã'],
        astroReach: 84,
        population: 620,
        strategic: false
    },
    {
        id: 10,
        name: '–°–µ–∫—Ç–æ—Ä –¢—Ä–∏—Ñ–∏–¥',
        segmentumId: 3,
        status: 'safe',
        stability: 86,
        threat: null,
        coordinates: { x: 190, y: 400 },
        color: '#006633',
        connections: [9, 11, 12],
        fleets: { imperial: 58, enemy: 0 },
        resources: { tithe: 980, recruitment: 115 },
        specialFeatures: ['–¢–æ—Ä–≥–æ–≤—ã–µ –ø—É—Ç–∏', '–¢—Ä–∞–Ω–∑–∏—Ç–Ω—ã–µ —Ö–∞–±—ã'],
        astroReach: 81,
        population: 580,
        strategic: false
    },
    {
        id: 11,
        name: '–°–µ–∫—Ç–æ—Ä –ì–æ–ª–≥–æ—Ñ–∞',
        segmentumId: 3,
        status: 'safe',
        stability: 84,
        threat: null,
        coordinates: { x: 210, y: 380 },
        color: '#006633',
        connections: [10, 12, 17],
        fleets: { imperial: 56, enemy: 0 },
        resources: { tithe: 950, recruitment: 110 },
        specialFeatures: ['–ú–æ–Ω–∞—Å—Ç—ã—Ä—Å–∫–∏–µ –º–∏—Ä—ã', '–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –ª–∞–≥–µ—Ä—è'],
        astroReach: 79,
        population: 560,
        strategic: false
    },
    {
        id: 12,
        name: '–°–µ–∫—Ç–æ—Ä –í–∞—Ä–∞–Ω–∏—É—Å',
        segmentumId: 3,
        status: 'threatened',
        stability: 72,
        threat: 'orks',
        coordinates: { x: 230, y: 420 },
        color: '#006633',
        connections: [10, 11, 17],
        fleets: { imperial: 54, enemy: 15 },
        resources: { tithe: 800, recruitment: 100 },
        specialFeatures: ['–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ –º–∏—Ä—ã', '–û—Ä–∫-–Ω–∞—à–µ—Å—Ç–≤–∏—è (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ)'],
        astroReach: 74,
        population: 500,
        strategic: true
    },
    
    // ===== –°–ï–ì–ú–ï–ù–¢–£–ú –£–õ–¨–¢–ò–ú–ê (4 —Å–µ–∫—Ç–æ—Ä–∞) =====
    {
        id: 13,
        name: '–£–ª—å—Ç—Ä–∞–º–∞—Ä',
        segmentumId: 4,
        status: 'safe',
        stability: 95,
        threat: null,
        coordinates: { x: 600, y: 280 },
        color: '#0066CC',
        connections: [1, 5, 8, 14],
        fleets: { imperial: 100, enemy: 0 },
        resources: { tithe: 2200, recruitment: 220 },
        specialFeatures: ['–ú–∞–∫—Ä–∞–≥–≥', '–ö—Ä–µ–ø–æ—Å—Ç—å –£–ª—å—Ç—Ä–∞–º–∞—Ä–∏–Ω–æ–≤', '500 –º–∏—Ä–æ–≤ –£–ª—å—Ç—Ä–∞–º–∞—Ä–∞', '–ü—Ä–∏–º–∞—Ä—Ö –†–æ–±–∞—É—Ç –ñ–∏–ª–ª–∏–º–∞–Ω'],
        astroReach: 90,
        population: 1200,
        strategic: true
    },
    {
        id: 14,
        name: '–°–µ–∫—Ç–æ—Ä –î–∞–º–æ–∫–ª–æ–≤',
        segmentumId: 4,
        status: 'threatened',
        stability: 65,
        threat: 'tau',
        coordinates: { x: 640, y: 300 },
        color: '#0066CC',
        connections: [13, 15, 16],
        fleets: { imperial: 48, enemy: 25 },
        resources: { tithe: 750, recruitment: 95 },
        specialFeatures: ['–ì—Ä–∞–Ω–∏—Ü–∞ —Å –ò–º–ø–µ—Ä–∏–µ–π –¢–∞—É', '–§–ª–æ—Ç-—ç–∫—Å–ø–µ–¥–∏—Ü–∏—è –î–∞–º–æ–∫–ª–æ–≤'],
        astroReach: 68,
        population: 480,
        strategic: true
    },
    {
        id: 15,
        name: '–°–µ–∫—Ç–æ—Ä –¶–∏–∫–ª–æ–ø—Å',
        segmentumId: 4,
        status: 'threatened',
        stability: 62,
        threat: 'tyranids',
        coordinates: { x: 620, y: 340 },
        color: '#0066CC',
        connections: [14, 16, 18],
        fleets: { imperial: 45, enemy: 35 },
        resources: { tithe: 680, recruitment: 85 },
        specialFeatures: ['–ü–µ—Ä–µ–¥–æ–≤—ã–µ –ø–æ—Å—Ç—ã', '–°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–Ω–µ–≥–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è', '–§–ª–æ—Ç-—É–ª–µ–π (—É–≥—Ä–æ–∑–∞)'],
        astroReach: 65,
        population: 440,
        strategic: true
    },
    {
        id: 16,
        name: '–°–µ–∫—Ç–æ—Ä –¢–∞–ª–ª–∞—Å–∞—Ä',
        segmentumId: 4,
        status: 'safe',
        stability: 82,
        threat: null,
        coordinates: { x: 580, y: 320 },
        color: '#0066CC',
        connections: [13, 14, 15],
        fleets: { imperial: 64, enemy: 0 },
        resources: { tithe: 1150, recruitment: 135 },
        specialFeatures: ['–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –º–∏—Ä—ã', '–§–ª–æ—Ç—Å–∫–∏–µ –¥–æ–∫–∏'],
        astroReach: 80,
        population: 680,
        strategic: false
    },
    
    // ===== –°–ï–ì–ú–ï–ù–¢–£–ú –¢–ï–ú–ü–ï–°–¢–£–° (4 —Å–µ–∫—Ç–æ—Ä–∞) =====
    {
        id: 17,
        name: '–°–µ–∫—Ç–æ—Ä –ú–∞—Ä–µ–ª–ª–∏—É—Å',
        segmentumId: 5,
        status: 'safe',
        stability: 85,
        threat: null,
        coordinates: { x: 370, y: 500 },
        color: '#CC6600',
        connections: [11, 12, 18],
        fleets: { imperial: 60, enemy: 0 },
        resources: { tithe: 1080, recruitment: 128 },
        specialFeatures: ['–ì–æ—Ä–Ω–æ–¥–æ–±—ã–≤–∞—é—â–∏–µ –º–∏—Ä—ã', '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã'],
        astroReach: 78,
        population: 640,
        strategic: false
    },
    {
        id: 18,
        name: '–°–µ–∫—Ç–æ—Ä –°–∫–∞—Ä—É—Å',
        segmentumId: 5,
        status: 'safe',
        stability: 83,
        threat: null,
        coordinates: { x: 410, y: 520 },
        color: '#CC6600',
        connections: [15, 17, 19],
        fleets: { imperial: 58, enemy: 0 },
        resources: { tithe: 1020, recruitment: 122 },
        specialFeatures: ['–ê–≥—Ä–∏-–º–∏—Ä—ã', '–≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã'],
        astroReach: 76,
        population: 610,
        strategic: false
    },
    {
        id: 19,
        name: '–°–µ–∫—Ç–æ—Ä –ê—Ç—Ç–∏–ª–∞',
        segmentumId: 5,
        status: 'threatened',
        stability: 68,
        threat: 'orks',
        coordinates: { x: 430, y: 480 },
        color: '#CC6600',
        connections: [18, 20],
        fleets: { imperial: 50, enemy: 22 },
        resources: { tithe: 820, recruitment: 102 },
        specialFeatures: ['–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ä—Ç—ã', '–í–∞—Ä–ø-–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å'],
        astroReach: 70,
        population: 510,
        strategic: true
    },
    {
        id: 20,
        name: '–°–µ–∫—Ç–æ—Ä –≠–∫—Å–æ–¥—É—Å',
        segmentumId: 5,
        status: 'safe',
        stability: 80,
        threat: null,
        coordinates: { x: 390, y: 460 },
        color: '#CC6600',
        connections: [17, 19],
        fleets: { imperial: 55, enemy: 0 },
        resources: { tithe: 950, recruitment: 115 },
        specialFeatures: ['–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏', '–ö–æ–ª–æ–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–ª–æ—Ç—ã'],
        astroReach: 74,
        population: 580,
        strategic: false
    }
],

// –ù–û–í–û–ï: –°–∏—Å—Ç–µ–º–∞ –∫–∞—Ä—Ç—ã
galaxyMap: {
    canvas: null,
    ctx: null,
    width: 800,
    height: 600,
    zoom: 1.0,
    panX: 0,
    panY: 0,
    viewMode: 'segmentums',  // 'segmentums' –∏–ª–∏ 'sectors'
    selectedSegmentum: null,
    selectedSector: null,
    hoveredSector: null,
    animations: {
        warpStorms: [],
        fleetMovements: [],
        astroBeams: []
    }
},
    
    // ========== –ü–ï–†–°–û–ù–ê–õ (–†–ê–°–®–ò–†–ï–ù–ù–´–ô) ==========
    personnel: {
        inquisitors: [],
        generals: [],
        navigators: [],
        administrators: [],
        // –ù–û–í–û–ï
        techPriests: [],
        sanctionedPsykers: [],
        astropaths: [],
        sisterOfBattle: []
    },
    
    // –ù–û–í–û–ï: –®–∞–±–ª–æ–Ω—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
    personnelTemplates: {
        inquisitor: {
            traits: ['–ü—Ä–∞–≤–µ–¥–Ω—ã–π', '–†–∞–¥–∏–∫–∞–ª', '–ü—É—Ä–∏—Ç–∞–Ω–∏–Ω', '–ú–æ–Ω–æ–¥–æ–º–∏–Ω–∞–Ω—Ç'],
            specialties: ['–û—Ö–æ—Ç–∞ –Ω–∞ –≤–µ–¥—å–º', '–ö—Å–µ–Ω–æ–ª–æ–≥–∏—è', '–ï—Ä–µ—Ç–∏–∫—É—Å', 'Malleus'],
            effects: {
                warpReduction: 5,
                threatDetection: 10
            }
        },
        techPriest: {
            traits: ['–î–æ–≥–º–∞—Ç–∏–∫', '–ù–æ–≤–∞—Ç–æ—Ä', '–ê—Ä—Ö–µ–æ-—Ç–µ—Ö–Ω–∏–∫', '–ë–∏–æ–ª–æ–≥'],
            specialties: ['–†–µ–º–æ–Ω—Ç –¢—Ä–æ–Ω–∞', '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', '–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è', '–í–∞—Ä–ø-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏'],
            effects: {
                throneRepair: 2,
                productionBonus: 5
            }
        },
        astropath: {
            traits: ['–°–∏–ª—å–Ω—ã–π', '–ù–∞–¥—ë–∂–Ω—ã–π', '–í–µ—â–∏–π', '–ó–∞–ø—Ä–µ–¥–µ–ª—å–Ω—ã–π'],
            specialties: ['–î–∞–ª—å–Ω—è—è —Å–≤—è–∑—å', '–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è', '–•–æ—Ä –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞'],
            effects: {
                astroBonus: 3,
                eventWarning: true
            }
        }
    },
    
    // ========== –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø ==========
    research: {
        current: null,          // –¢–µ–∫—É—â–µ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
        progress: 0,            // –ü—Ä–æ–≥—Ä–µ—Å—Å (0-100)
        completed: []           // –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
    },
    
    // ========== –£–õ–£–ß–®–ï–ù–ò–Ø ==========
    upgrades: {},

    // ========== –°–ò–°–¢–ï–ú–ê –ú–û–î–ò–§–ò–ö–ê–¢–û–†–û–í ==========
    modifiers: {
        active: [],
        history: []
    },
    
    modifierTypes: {
        // –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
        divineBlessing: {
            name: '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –±–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏–µ',
            description: '–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω —Å–∏—è–µ—Ç —è—Ä—á–µ –æ–±—ã—á–Ω–æ–≥–æ',
            effects: {
                astronomicPower: 20,
                stability: 10
            },
            duration: 30,
            stackable: false,
            icon: '‚ú®'
        },
        efficientSacrifice: {
            name: '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–µ',
            description: '–ü—Å–∞–π–∫–µ—Ä—ã —Ä–∞—Å—Ö–æ–¥—É—é—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–µ–µ',
            effects: {
                sacrificeRate: -200
            },
            duration: 20,
            stackable: false,
            icon: 'üî•'
        },
        technologicalBreakthrough: {
            name: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ä—ã–≤',
            description: '–ú–µ—Ö–∞–Ω–∏–∫—É—Å —Å–¥–µ–ª–∞–ª –æ—Ç–∫—Ä—ã—Ç–∏–µ',
            effects: {
                throneCondition: 15,
                techpriests: 2
            },
            duration: 40,
            stackable: false,
            icon: '‚öôÔ∏è'
        },
        imperialRecruitment: {
            name: '–ú–∞—Å—Å–æ–≤—ã–π –Ω–∞–±–æ—Ä',
            description: '–£—Å–ø–µ—à–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è –ø–æ –Ω–∞–±–æ—Ä—É –≤–æ–π—Å–∫',
            effects: {
                militaryGrowth: 5,
                populationGrowth: -1
            },
            duration: 50,
            stackable: false,
            icon: '‚öîÔ∏è'
        },
        economicBoom: {
            name: '–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –±—É–º',
            description: '–¢–æ—Ä–≥–æ–≤–ª—è –ø—Ä–æ—Ü–≤–µ—Ç–∞–µ—Ç',
            effects: {
                creditsIncome: 500
            },
            duration: 60,
            stackable: false,
            icon: 'üí∞'
        },
        
        // –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
        warpFluctuations: {
            name: '–§–ª—É–∫—Ç—É–∞—Ü–∏–∏ –≤–∞—Ä–ø–∞',
            description: '–í–∞—Ä–ø –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω',
            effects: {
                warpActivity: 10,
                astronomicStability: -15
            },
            duration: 25,
            stackable: true,
            icon: 'üåÄ'
        },
        plague: {
            name: '–≠–ø–∏–¥–µ–º–∏—è',
            description: '–ë–æ–ª–µ–∑–Ω—å –æ—Ö–≤–∞—Ç–∏–ª–∞ —É–ª–∏–∞–π',
            effects: {
                populationGrowth: -5,
                militaryGrowth: -2,
                creditsIncome: -300
            },
            duration: 40,
            stackable: false,
            icon: '‚ò†Ô∏è'
        },
        corruption: {
            name: '–ö–æ—Ä—Ä—É–ø—Ü–∏—è',
            description: '–ö–æ—Ä—Ä—É–ø—Ü–∏—è –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏',
            effects: {
                creditsIncome: -20  // –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
            },
            duration: 0,  // –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ–∫–∞ –Ω–µ —É—Å—Ç—Ä–∞–Ω—è—Ç
            stackable: false,
            icon: 'üíÄ'
        },
        mechanicusDispute: {
            name: '–°–ø–æ—Ä —Å –ú–µ—Ö–∞–Ω–∏–∫—É—Å–æ–º',
            description: '–ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å –ê–¥–µ–ø—Ç—É—Å –ú–µ—Ö–∞–Ω–∏–∫—É—Å',
            effects: {
                techpriests: -1,
                throneRepair: -5
            },
            duration: 30,
            stackable: false,
            icon: '‚ö†Ô∏è'
        },
        psykerShortage: {
            name: '–î–µ—Ñ–∏—Ü–∏—Ç –ø—Å–∞–π–∫–µ—Ä–æ–≤',
            description: '–ß—ë—Ä–Ω—ã–µ –ö–æ—Ä–∞–±–ª–∏ –∑–∞–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è',
            effects: {
                psychicIncome: -500
            },
            duration: 15,
            stackable: false,
            icon: 'üî¥'
        },
        
        // –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
        warpRift: {
            name: '–í–∞—Ä–ø-—Ä–∞–∑–ª–æ–º',
            description: '–†–∞–∑–ª–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ!',
            effects: {
                warpActivity: 30,
                astronomicPower: -25,
                sectorThreat: true
            },
            duration: 20,
            stackable: false,
            icon: 'üí•'
        },
        emergencyMode: {
            name: '–ß—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ',
            description: '–ò–º–ø–µ—Ä–∏—É–º –æ–±—ä—è–≤–∏–ª –ß–ü',
            effects: {
                militaryGrowth: 10,
                creditsIncome: -40,  // –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
                populationGrowth: -3
            },
            duration: 30,
            stackable: false,
            icon: 'üö®'
        }
    },
    
    // ========== –í–†–ê–ì–ò ==========
    enemies: {
        chaos: { strength: 30, activity: 20, sectors: [] },
        tyranids: { strength: 25, activity: 15, sectors: [] },
        necrons: { strength: 20, activity: 10, sectors: [] },
        orks: { strength: 35, activity: 30, sectors: [] },
        tau: { strength: 15, activity: 10, sectors: [] },
        eldar: { strength: 10, activity: 5, sectors: [] }
    },

    // ========== –°–ò–°–¢–ï–ú–ê –†–ï–ü–£–¢–ê–¶–ò–ò ==========
    reputation: {
        // –ò–º–ø–µ—Ä—Å–∫–∏–µ —Ñ—Ä–∞–∫—Ü–∏–∏
        mechanicus: {
            level: 50,              // 0-100
            status: 'neutral',      // hostile, unfriendly, neutral, friendly, allied
            benefits: {
                throneRepair: 0,
                techBonus: 0,
                discount: 0
            },
            history: []
        },
        inquisition: {
            level: 50,
            status: 'neutral',
            benefits: {
                warpSuppression: 0,
                intelBonus: 0,
                psykerBonus: 0
            },
            history: []
        },
        ecclesiarchy: {
            level: 50,
            status: 'neutral',
            benefits: {
                morale: 0,
                recruitment: 0,
                donation: 0
            },
            history: []
        },
        imperialNavy: {
            level: 50,
            status: 'neutral',
            benefits: {
                fleetDiscount: 0,
                fleetBonus: 0,
                transport: 0
            },
            history: []
        },
        astartes: {
            level: 50,
            status: 'neutral',
            benefits: {
                militarySupport: 0,
                training: 0,
                librarians: 0
            },
            history: []
        },
        // –ö—Å–µ–Ω–æ—Å—ã (–æ–±—ã—á–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ–ø—É—Ç–∞—Ü–∏—è)
        eldar: {
            level: 0,
            status: 'hostile',
            benefits: {
                warpKnowledge: 0,
                precognition: 0
            },
            history: []
        },
        tau: {
            level: 0,
            status: 'hostile',
            benefits: {
                technology: 0
            },
            history: []
        }
    },
    
    // –ü–æ—Ä–æ–≥–∏ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏
    reputationThresholds: {
        hostile: 0,
        unfriendly: 25,
        neutral: 50,
        friendly: 75,
        allied: 90
    },
    
    // ========== –ê–ö–¢–ò–í–ù–´–ï –ú–ò–°–°–ò–ò ==========
    missions: [],
    
    // ========== –°–û–ë–´–¢–ò–Ø ==========
    eventQueue: [],
    lastEventDay: 0,
    
    // ========== –î–û–°–¢–ò–ñ–ï–ù–ò–Ø ==========
    achievements: [],
    
    // ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
    settings: {
        autoSave: true,
        autoSaveInterval: 60000, // 1 –º–∏–Ω—É—Ç–∞
        soundEnabled: true,
        particlesEnabled: true,
        difficulty: 'normal' // easy, normal, hard, nightmare
    },
    
    // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    init() {
        console.log('üéÆ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞...');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        this.initializeSectors();
        this.initializePersonnel();
        this.initializeResearch();
        this.initializeUpgrades();
        this.initializeAchievements();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        this.setupUI();
        
        // –ü–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        this.updateUI();
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
        this.running = true;
        this.gameLoop();
        
        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        if (this.settings.autoSave) {
            setInterval(() => this.autoSave(), this.settings.autoSaveInterval);
        }

        Game.sounds.init();

        // –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–º–±–∏–µ–Ω—Ç–Ω—ã–π –∑–≤—É–∫
        // this.ambientSound = Game.sounds.ambient();
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–∞—Å—Ç–∏—Ü –≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞
        if (this.settings.particlesEnabled) {
            this.createParticles();
        }
        
        // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        this.log('–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. –ù–∞—á–∞—Ç–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ç–æ–º –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞.', 'success');
        this.log('–ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã.', 'info');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞
        this.initAstronomicanVisual();
        
        // –ó–∞–ø—É—Å–∫ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ canvas
        this.startCanvasRendering();

        // –°—á—ë—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π
        this.eventStats = {
            totalEvents: 0,
            successfulChoices: 0,
            failedChoices: 0,
            creditsSpent: 0,
            psykersSpent: 0
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –≥–∞–ª–∞–∫—Ç–∏–∫–∏
        this.initGalaxyMap();
        
        console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
    },
    
    // ==================== –ò–ì–†–û–í–û–ô –¶–ò–ö–õ ====================
    gameLoop() {
        if (!this.running || this.gameOver) return;
        
        const now = Date.now();
        const delta = now - this.lastTick;
        
        if (delta >= this.tickSpeed && !this.paused) {
            this.tick();
            this.lastTick = now;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–±—ã—Ç–∏—è –ß—ë—Ä–Ω–æ–≥–æ –ö–æ—Ä–∞–±–ª—è
        if (this.day >= this.blackShips.nextArrival) {
            this.generateBlackShipArrival();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¢—Ä–æ–Ω–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        if (this.astronomican.throneCondition >= 100) {
            this.perfectThroneDays++;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            if (this.perfectThroneDays >= 100 && !this.achievements.find(a => a.id === 'perfect_throne')?.unlocked) {
                const achievement = this.achievements.find(a => a.id === 'perfect_throne');
                if (achievement) {
                    achievement.unlocked = true;
                    this.showAchievement(achievement);
                }
            }
        } else {
            this.perfectThroneDays = 0; // –°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫
        }
        
        requestAnimationFrame(() => this.gameLoop());
    },
    
    // –û–¥–∏–Ω –∏–≥—Ä–æ–≤–æ–π —Ç–∏–∫ (—á–∞—Å)
    tick() {
        this.hour++;
        
        // –ù–æ–≤—ã–π –¥–µ–Ω—å –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
        if (this.hour >= 24) {
            this.hour = 0;
            this.day++;
            this.onNewDay();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥—ã–π —á–∞—Å
        this.updateAstronomican();
        this.updateWarp();
        this.updateResources();
        this.updateSectors();
        this.updateMissions();

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
        if (this.day % 10 === 0 && this.hour === 0) {
            this.renderGalaxyMap();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        this.updateUI();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –ø—Ä–æ–∏–≥—Ä—ã—à–∞
        this.checkGameOver();
    },
    
    // –ù–æ–≤—ã–π –¥–µ–Ω—å
    onNewDay() {
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ—Å—É—Ä—Å–æ–≤
        this.applyDailyResourceChanges();
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
        if (this.day - this.lastEventDay >= 3) {
            this.generateRandomEvent();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π
        this.updateResearch();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        this.checkAchievements();
        
        this.log(`–î–µ–Ω—å ${this.day}. –ò–º–ø–µ—Ä–∏—É–º –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å.`, 'info');
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù–ê ====================
    updateAstronomican() {
        const astro = this.astronomican;
        
        // –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø—Å–∞–π–∫–µ—Ä–æ–≤
        const hourlyConsumption = astro.sacrificeRate / 24;
        this.resources.psychic -= hourlyConsumption;
        
        // –ï—Å–ª–∏ –ø—Å–∞–π–∫–µ—Ä—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
        if (this.resources.psychic < 0) {
            this.resources.psychic = 0;
            astro.power -= 2; // –†–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ –º–æ—â–Ω–æ—Å—Ç–∏
            astro.stability -= 3;
            
            if (this.day % 5 === 0) {
                this.log('–ö–†–ò–¢–ò–ß–ù–û: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Å–∞–π–∫–µ—Ä–æ–≤! –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω —Å–ª–∞–±–µ–µ—Ç!', 'critical');
                this.sounds.warning();
            }
        } else {
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ—â–Ω–æ—Å—Ç–∏
            if (astro.power < 100) {
                astro.power += 0.1 * astro.efficiency / 100;
            }
        }
        
        // –ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º
        if (astro.emergencyMode) {
            astro.emergencyTurns--;
            if (astro.emergencyTurns <= 0) {
                astro.emergencyMode = false;
                astro.sacrificeRate /= 3;
                this.log('–ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º –∑–∞–≤–µ—Ä—à—ë–Ω.', 'warning');
            }
        }
        
        // –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ó–æ–ª–æ—Ç–æ–≥–æ –¢—Ä–æ–Ω–∞
        astro.throneCondition -= 0.001 * (1 + this.warp.level / 100);
        
        // –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –¢—Ä–æ–Ω–∞ –∏ –≤–∞—Ä–ø–∞
        const targetStability = astro.throneCondition - this.warp.level / 2;
        if (astro.stability > targetStability) {
            astro.stability -= 0.05;
        } else if (astro.stability < targetStability) {
            astro.stability += 0.05;
        }
        
        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
        astro.power = Math.max(0, Math.min(100, astro.power));
        astro.stability = Math.max(0, Math.min(100, astro.stability));
        astro.throneCondition = Math.max(0, Math.min(100, astro.throneCondition));
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–ê–†–ü–ê ====================
    updateWarp() {
        const warp = this.warp;
        
        // –ë–∞–∑–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∞—Ä–ø–∞
        let warpChange = (Math.random() - 0.5) * 0.5;
        
        // –í–ª–∏—è–Ω–∏–µ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞ (—Å–∏–ª—å–Ω—ã–π –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –ø–æ–¥–∞–≤–ª—è–µ—Ç –≤–∞—Ä–ø)
        warpChange -= (this.astronomican.power / 100) * 0.2;
        
        // –í–ª–∏—è–Ω–∏–µ –•–∞–æ—Å–∞
        warpChange += (this.enemies.chaos.activity / 100) * 0.3;
        
        // –í–ª–∏—è–Ω–∏–µ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–π
        if (this.astronomican.sacrificeRate > 1500) {
            warpChange += 0.1; // –ú–Ω–æ–≥–æ –∂–µ—Ä—Ç–≤ = –±–æ–ª—å—à–µ –≤–∞—Ä–ø-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        }
        
        warp.level += warpChange;
        warp.level = Math.max(0, Math.min(100, warp.level));
        
        // –í–∞—Ä–ø-—à—Ç–æ—Ä–º—ã
        if (warp.level > 60 && Math.random() < 0.01) {
            this.createWarpStorm();
        }
        
        // –£–≥—Ä–æ–∑–∞ –¥–µ–º–æ–Ω–æ–≤
        warp.demonThreat = Math.min(100, warp.level * 0.8 + warp.storms * 5);
        
        // –í—Ç–æ—Ä–∂–µ–Ω–∏—è –¥–µ–º–æ–Ω–æ–≤
        if (warp.demonThreat > 70 && Math.random() < 0.005) {
            this.triggerDemonIncursion();
        }
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –†–ï–°–£–†–°–û–í ====================
    updateResources() {
        // –ü–æ—á–∞—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ, –æ—Å–Ω–æ–≤–Ω–æ–µ –≤ onNewDay
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–≤–Ω–∏
        if (this.resources.psychic < 1000 && this.day % 10 === 0) {
            this.log('–ó–∞–ø–∞—Å—ã –ø—Å–∞–π–∫–µ—Ä–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∏!', 'warning');
            this.sounds.warning();
        }
        
        if (this.resources.credits < 1000 && this.day % 10 === 0) {
            this.log('–ö–∞–∑–Ω–∞ –ò–º–ø–µ—Ä–∏—É–º–∞ –∏—Å—Ç–æ—â–∞–µ—Ç—Å—è!', 'warning');
            this.sounds.warning();
        }
    },
    
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ—Å—É—Ä—Å–æ–≤
    applyDailyResourceChanges() {
        for (const [resource, change] of Object.entries(this.resourceChanges)) {
            this.resources[resource] += change;
            
            // –ù–µ –¥–æ–ø—É—Å–∫–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–∫—Ä–æ–º–µ –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏)
            if (resource !== 'psychic') {
                this.resources[resource] = Math.max(0, this.resources[resource]);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        this.stats.totalSacrifices += this.astronomican.sacrificeRate;
        if (this.resourceChanges.credits > 0) {
            this.stats.totalCreditsEarned += this.resourceChanges.credits;
        }
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ï–ö–¢–û–†–û–í ====================
    updateSectors() {
        // –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑ –≤ –¥–µ–Ω—å, –¥–µ—Ç–∞–ª–∏ –≤ onNewDay
        if (this.hour !== 0) return;
        
        this.sectors.forEach(sector => {
            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≤ –º–∏—Ä–Ω—ã—Ö —Å–µ–∫—Ç–æ—Ä–∞—Ö
            if (sector.status === 'safe' && sector.stability < 100) {
                sector.stability += 1;
            }
            
            // –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –≤ –æ–ø–∞—Å–Ω—ã—Ö —Å–µ–∫—Ç–æ—Ä–∞—Ö
            if (sector.status === 'threatened') {
                sector.stability -= 0.5;
            }
            
            if (sector.status === 'war') {
                sector.stability -= 2;
                
                // –í–æ–∑–º–æ–∂–Ω–∞ –ø–æ—Ç–µ—Ä—è —Å–µ–∫—Ç–æ—Ä–∞
                if (sector.stability <= 0) {
                    sector.status = 'lost';
                    this.stats.sectorsLost++;
                    this.log(`–°–µ–∫—Ç–æ—Ä ${sector.name} –ø–æ—Ç–µ—Ä—è–Ω!`, 'critical');
                    this.triggerSectorLostEvent(sector);
                }
            }
        });
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ú–ò–°–°–ò–ô ====================
    updateMissions() {
        this.missions.forEach((mission, index) => {
            if (!mission.active) return;
            
            mission.progress += mission.progressRate || 1;
            
            if (mission.progress >= 100) {
                this.completeMission(mission, index);
            }
        });
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ô ====================
    updateResearch() {
        if (!this.research.current) return;
        
        const research = this.research.current;
        const bonus = 1 + (this.resources.techpriests / 100);
        
        this.research.progress += bonus;
        
        if (this.research.progress >= 100) {
            this.completeResearch(research);
        }
    },
    
    // ==================== –£–°–¢–ê–ù–û–í–ö–ê –°–ö–û–†–û–°–¢–ò –ñ–ï–†–¢–í–û–ü–†–ò–ù–û–®–ï–ù–ò–ô ====================
    setSacrificeRate(rate) {
        const astro = this.astronomican;
        
        switch(rate) {
            case 'low':
                astro.sacrificeRate = 500;
                astro.efficiency = 80;
                this.log('–°–∫–æ—Ä–æ—Å—Ç—å –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–π —Å–Ω–∏–∂–µ–Ω–∞. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 80%', 'info');

                // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞
                if (this.astronomican.visual && this.astronomican.visual.effects) {
                    this.astronomican.visual.effects.flash = {
                        active: true,
                        intensity: rate === 'high' ? 0.8 : rate === 'normal' ? 0.5 : 0.3,
                        timer: 30
                    };
                }

                break;
            case 'normal':
                astro.sacrificeRate = 1000;
                astro.efficiency = 100;
                this.log('–°–∫–æ—Ä–æ—Å—Ç—å –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–π –≤ –Ω–æ—Ä–º–µ. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 100%', 'info');

                // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞
                if (this.astronomican.visual && this.astronomican.visual.effects) {
                    this.astronomican.visual.effects.flash = {
                        active: true,
                        intensity: rate === 'high' ? 0.8 : rate === 'normal' ? 0.5 : 0.3,
                        timer: 30
                    };
                }

                break;
            case 'high':
                astro.sacrificeRate = 2000;
                astro.efficiency = 120;
                this.log('–°–∫–æ—Ä–æ—Å—Ç—å –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–π –ø–æ–≤—ã—à–µ–Ω–∞. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 120%', 'warning');

                // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞
                if (this.astronomican.visual && this.astronomican.visual.effects) {
                    this.astronomican.visual.effects.flash = {
                        active: true,
                        intensity: rate === 'high' ? 0.8 : rate === 'normal' ? 0.5 : 0.3,
                        timer: 30
                    };
                }

                break;
        }

        this.sounds.sacrifice();

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–í–µ–ª–∏–∫–∞—è –∂–µ—Ä—Ç–≤–∞"
        if (amount >= 100 && !this.achievements.find(a => a.id === 'mass_sacrifice')?.unlocked) {
            const achievement = this.achievements.find(a => a.id === 'mass_sacrifice');
            if (achievement) {
                achievement.unlocked = true;
                this.showAchievement(achievement);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('[id^="btn-sacrifice-"]').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(`btn-sacrifice-${rate}`).classList.add('active');
        
        this.updateUI();
    },
    
    // ==================== –ê–í–ê–†–ò–ô–ù–´–ô –†–ï–ñ–ò–ú ====================
    emergencyPower() {
        if (this.resources.credits < 500) {
            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
            this.sounds.warning();
            return;
        }
        
        if (this.astronomican.emergencyMode) {
            this.notify('–ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º —É–∂–µ –∞–∫—Ç–∏–≤–µ–Ω!', 'warning');
            return;
        }
        
        this.resources.credits -= 500;
        this.astronomican.emergencyMode = true;
        this.astronomican.emergencyTurns = 24; // 1 –¥–µ–Ω—å
        this.astronomican.sacrificeRate *= 3;
        this.astronomican.power = Math.min(100, this.astronomican.power + 20);
        
        this.log('‚ö†Ô∏è –ê–í–ê–†–ò–ô–ù–´–ô –†–ï–ñ–ò–ú –ê–ö–¢–ò–í–ò–†–û–í–ê–ù! –£—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø—Å–∞–π–∫–µ—Ä–æ–≤!', 'critical');
        this.notify('–ê–≤–∞—Ä–∏–π–Ω—ã–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', 'critical');

        // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞
        if (this.astronomican.visual && this.astronomican.visual.effects) {
            this.astronomican.visual.effects.flash = {
                active: true,
                intensity: 1.0,
                timer: 60
            };
        }

    },
    
    // ==================== –ù–ê–ë–û–† –ü–°–ê–ô–ö–ï–†–û–í ====================
    recruitPsykers() {
        const cost = 1000;
        const amount = 500;
        
        if (this.resources.credits < cost) {
            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
            this.sounds.warning();
            return;
        }
        
        this.resources.credits -= cost;
        this.resources.psychic += amount;
        
        this.log(`–ù–∞–±—Ä–∞–Ω–æ ${amount} –ø—Å–∞–π–∫–µ—Ä–æ–≤. –ó–∞—Ç—Ä–∞—á–µ–Ω–æ ${cost} –∫—Ä–µ–¥–∏—Ç–æ–≤.`, 'success');
        this.notify(`+${amount} –ø—Å–∞–π–∫–µ—Ä–æ–≤`, 'success');
        this.updateUI();
    },
    
    // ==================== –°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–Ø –°–ï–ö–¢–û–†–ê ====================
    stabilizeSector() {
        const cost = 500;
        
        if (this.resources.credits < cost) {
            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
            this.sounds.warning();
            return;
        }
        
        // –ù–∞–π—Ç–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Å–µ–∫—Ç–æ—Ä
        const unstableSector = this.sectors.find(s => 
            s.status === 'threatened' || s.status === 'war'
        );
        
        if (!unstableSector) {
            this.notify('–ù–µ—Ç —Å–µ–∫—Ç–æ—Ä–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏', 'info');
            return;
        }
        
        this.resources.credits -= cost;
        unstableSector.stability += 20;
        
        if (unstableSector.stability > 70 && unstableSector.status === 'threatened') {
            unstableSector.status = 'safe';
        }
        
        this.log(`–°–µ–∫—Ç–æ—Ä ${unstableSector.name} —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: ${Math.round(unstableSector.stability)}%`, 'success');
        this.notify('–°–µ–∫—Ç–æ—Ä —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω!', 'success');
        this.updateUI();
    },
    
    // ==================== –û–¢–ü–†–ê–í–ö–ê –ò–ù–ö–í–ò–ó–ò–¢–û–†–ê ====================
    sendInquisitor() {
        const cost = 300;
        
        if (this.resources.credits < cost) {
            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
            this.sounds.warning();
            return;
        }
        
        if (this.personnel.inquisitors.length === 0) {
            this.notify('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä–æ–≤!', 'warning');
            this.sounds.warning();
            return;
        }
        
        this.resources.credits -= cost;
        
        // –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
        const effects = [
            () => {
                this.warp.level = Math.max(0, this.warp.level - 5);
                this.log('–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –ø–æ–¥–∞–≤–∏–ª –∫—É–ª—å—Ç –•–∞–æ—Å–∞. –í–∞—Ä–ø-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞.', 'success');
            },
            () => {
                const sector = this.sectors.find(s => s.status === 'threatened');
                if (sector) {
                    sector.stability += 15;
                    this.log(`–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä —É—Å—Ç—Ä–∞–Ω–∏–ª —É–≥—Ä–æ–∑—É –≤ —Å–µ–∫—Ç–æ—Ä–µ ${sector.name}.`, 'success');
                }
            },
            () => {
                this.resources.credits += 200;
                this.log('–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –∫–æ–Ω—Ñ–∏—Å–∫–æ–≤–∞–ª –µ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã. –ü–æ–ª—É—á–µ–Ω–æ 200 –∫—Ä–µ–¥–∏—Ç–æ–≤.', 'success');
            }
        ];
        
        const effect = effects[Math.floor(Math.random() * effects.length)];
        effect();
        
        this.notify('–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!', 'success');
        this.updateUI();
    },
    
    // ==================== –£–°–ò–õ–ï–ù–ò–ï –§–õ–û–¢–ê ====================
    reinforceFleet() {
        const cost = 2000;
        const amount = 5;
        
        if (this.resources.credits < cost) {
            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
            this.sounds.warning();
            return;
        }
        
        this.resources.credits -= cost;
        this.resources.fleet += amount;
        
        this.log(`–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ ${amount} –Ω–æ–≤—ã—Ö –∫–æ—Ä–∞–±–ª–µ–π —Ñ–ª–æ—Ç–∞.`, 'success');
        this.notify(`+${amount} –∫–æ—Ä–∞–±–ª–µ–π`, 'success');
        this.updateUI();
    },
    
    // ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö ====================
    switchTab(tabName) {
        // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.tab').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        document.getElementById(`tab-${tabName}`).classList.add('active');
        event.target.classList.add('active');
        
        // –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏
        this.updateTabContent(tabName);
    },
    
    // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–û–î–ï–†–ñ–ò–ú–û–ì–û –í–ö–õ–ê–î–ö–ò ====================
    updateTabContent(tabName) {
        switch(tabName) {
            case 'sectors':
                this.renderSectors();
                break;
            case 'personnel':
                this.renderPersonnel('inquisitors');
                break;
            case 'research':
                this.renderResearch('psychic');
                break;
            case 'military':
                this.renderMilitary();
                break;
            case 'enemies':
                this.renderEnemies();
                break;
            case 'upgrades':
                this.renderUpgrades('throne');
                break;
        }
    },
    
    // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º –±–ª–æ–∫–µ...
    
}; 

// –ó–≤—É–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
Game.sounds = {
    enabled: true,
    context: null,
    
    init: function() {
        try {
            this.context = new (window.AudioContext || window.webkitAudioContext)();
        } catch(e) {
            console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
            this.enabled = false;
        }
    },
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–Ω–æ–≤
    playTone: function(frequency, duration, type = 'sine', volume = 0.1) {
        if (!this.enabled || !this.context) return;
        
        const oscillator = this.context.createOscillator();
        const gainNode = this.context.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(this.context.destination);
        
        oscillator.type = type;
        oscillator.frequency.value = frequency;
        
        gainNode.gain.setValueAtTime(volume, this.context.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, this.context.currentTime + duration);
        
        oscillator.start(this.context.currentTime);
        oscillator.stop(this.context.currentTime + duration);
    },
    
    // –ó–≤—É–∫ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏—è
    sacrifice: function() {
        this.playTone(220, 0.3, 'sine', 0.15);
        setTimeout(() => this.playTone(440, 0.2, 'triangle', 0.1), 100);
    },
    
    // –ó–≤—É–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    warning: function() {
        this.playTone(300, 0.1, 'square', 0.08);
        setTimeout(() => this.playTone(350, 0.1, 'square', 0.08), 150);
    },
    
    // –ó–≤—É–∫ —É—Å–ø–µ—Ö–∞
    success: function() {
        this.playTone(523, 0.15, 'sine', 0.12);
        setTimeout(() => this.playTone(659, 0.15, 'sine', 0.1), 100);
        setTimeout(() => this.playTone(784, 0.2, 'sine', 0.08), 200);
    },
    
    // –ê–º–±–∏–µ–Ω—Ç (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –≥—É–ª)
    ambient: function() {
        if (!this.enabled || !this.context) return;
        
        const oscillator = this.context.createOscillator();
        const gainNode = this.context.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(this.context.destination);
        
        oscillator.type = 'sawtooth';
        oscillator.frequency.value = 55; // –ù–∏–∑–∫–∏–π –≥—É–ª
        
        gainNode.gain.value = 0.02;
        
        oscillator.start();
        
        return oscillator; // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
    }
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä—É–Ω –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ 
Game.initAstronomicanVisual = function() {
    if (!this.astronomican.visual) return;
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä—É–Ω –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ —Å–ª–æ—è
    this.astronomican.visual.layers.middle.runes = [];
    for (let i = 0; i < 8; i++) {
        this.astronomican.visual.layers.middle.runes.push({
            angle: (i * 45) * Math.PI / 180,
            symbol: ['‚öî', 'üõ°', '‚öú', '‚ú¶', '‚óà', '‚ùñ', '‚ú†', '‚ú∂'][i],
            opacity: 0.8
        });
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤—ë–∑–¥–Ω–æ–≥–æ –ø–æ–ª—è
    this.starfield = [];
    for (let i = 0; i < 100; i++) {
        this.starfield.push({
            x: Math.random() * 600,
            y: Math.random() * 400,
            size: Math.random() * 2 + 0.5,
            twinkle: Math.random() * Math.PI * 2
        });
    }
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ï–ì–ú–ï–ù–¢–£–ú–û–í –ò –°–ï–ö–¢–û–†–û–í ====================
Game.initializeSectors = function() {
    console.log('üåå –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç—É–º–æ–≤ –∏ —Å–µ–∫—Ç–æ—Ä–æ–≤...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è 5 —Å–µ–≥–º–µ–Ω—Ç—É–º–æ–≤
    this.segmentums = [
        {
            id: 1,
            name: '–°–µ–≥–º–µ–Ω—Ç—É–º –°–æ–ª–∞—Ä',
            description: '–°–µ—Ä–¥—Ü–µ –ò–º–ø–µ—Ä–∏—É–º–∞, —Å–æ–¥–µ—Ä–∂–∏—Ç –°–≤—è—Ç—É—é –¢–µ—Ä—Ä—É',
            color: '#FFD700',
            coordinates: { x: 400, y: 300 },
            size: 120,
            sectors: [1, 2, 3, 4]
        },
        {
            id: 2,
            name: '–°–µ–≥–º–µ–Ω—Ç—É–º –û–±—Å–∫—É—Ä—É—Å',
            description: '–¢—ë–º–Ω—ã–π —Ä–µ–≥–∏–æ–Ω, –≥—Ä–∞–Ω–∏—á–∏—Ç —Å –û–∫–æ–º –£–∂–∞—Å–∞',
            color: '#4B0082',
            coordinates: { x: 250, y: 150 },
            size: 110,
            sectors: [5, 6, 7, 8]
        },
        {
            id: 3,
            name: '–°–µ–≥–º–µ–Ω—Ç—É–º –ü–∞—Ü–∏—Ñ–∏–∫—É—Å',
            description: '–ó–∞–ø–∞–¥–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –ò–º–ø–µ—Ä–∏—É–º–∞',
            color: '#006633',
            coordinates: { x: 200, y: 380 },
            size: 110,
            sectors: [9, 10, 11, 12]
        },
        {
            id: 4,
            name: '–°–µ–≥–º–µ–Ω—Ç—É–º –£–ª—å—Ç–∏–º–∞',
            description: '–í–æ—Å—Ç–æ—á–Ω—ã–µ —Ä—É–±–µ–∂–∏, —Ä–µ–≥–∏–æ–Ω –£–ª—å—Ç—Ä–∞–º–∞—Ä–∞',
            color: '#0066CC',
            coordinates: { x: 600, y: 300 },
            size: 120,
            sectors: [13, 14, 15, 16]
        },
        {
            id: 5,
            name: '–°–µ–≥–º–µ–Ω—Ç—É–º –¢–µ–º–ø–µ—Å—Ç—É—Å',
            description: '–Æ–∂–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≤–∞—Ä–ø',
            color: '#CC6600',
            coordinates: { x: 400, y: 500 },
            size: 110,
            sectors: [17, 18, 19, 20]
        }
    ];
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è 20 —Å–µ–∫—Ç–æ—Ä–æ–≤ (–ø–æ 4 –≤ –∫–∞–∂–¥–æ–º —Å–µ–≥–º–µ–Ω—Ç—É–º–µ)
    this.sectors = [
        // –°–ï–ì–ú–ï–ù–¢–£–ú –°–û–õ–ê–† (4)
        {
            id: 1, name: '–¢–µ—Ä—Ä–∞–Ω—Å–∫–∏–π —Å–µ–∫—Ç–æ—Ä', segmentumId: 1,
            status: 'safe', stability: 100, threat: null,
            coordinates: { x: 400, y: 280 }, color: '#FFD700',
            connections: [2, 3, 5, 13],
            fleets: { imperial: 150, enemy: 0 },
            resources: { tithe: 3000, recruitment: 250 },
            specialFeatures: ['–°–≤—è—Ç–∞—è –¢–µ—Ä—Ä–∞', '–ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω', '–ò–º–ø–µ—Ä—Å–∫–∏–π –î–≤–æ—Ä–µ—Ü', '–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω'],
            astroReach: 100, population: 1500, strategic: true
        },
        {
            id: 2, name: '–°–µ–∫—Ç–æ—Ä –ô–æ–≤–∏–∞–Ω', segmentumId: 1,
            status: 'safe', stability: 95, threat: null,
            coordinates: { x: 380, y: 320 }, color: '#FFD700',
            connections: [1, 3, 4],
            fleets: { imperial: 80, enemy: 0 },
            resources: { tithe: 1800, recruitment: 180 },
            specialFeatures: ['–ú–∞—Ä—Å', '–ö—É–∑–Ω–∏ –ú–µ—Ö–∞–Ω–∏–∫—É—Å', '–û–ª–∏–º–ø—É—Å –ú–æ–Ω—Å'],
            astroReach: 98, population: 1000, strategic: true
        },
        {
            id: 3, name: '–°–µ–∫—Ç–æ—Ä –í–µ–Ω—É—Å', segmentumId: 1,
            status: 'safe', stability: 92, threat: null,
            coordinates: { x: 440, y: 290 }, color: '#FFD700',
            connections: [1, 2, 4],
            fleets: { imperial: 70, enemy: 0 },
            resources: { tithe: 1600, recruitment: 160 },
            specialFeatures: ['–¢–æ—Ä–≥–æ–≤—ã–µ —É–∑–ª—ã', '–¢—Ä–∞–Ω–∑–∏—Ç–Ω—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏'],
            astroReach: 96, population: 850, strategic: false
        },
        {
            id: 4, name: '–°–µ–∫—Ç–æ—Ä –ó–∞—Ñ–∏—Ä', segmentumId: 1,
            status: 'safe', stability: 90, threat: null,
            coordinates: { x: 420, y: 340 }, color: '#FFD700',
            connections: [2, 3, 9],
            fleets: { imperial: 65, enemy: 0 },
            resources: { tithe: 1500, recruitment: 150 },
            specialFeatures: ['–ê—Å—Ç—Ä–æ–ø–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏', '–§–ª–æ—Ç—Å–∫–∏–µ –≤–µ—Ä—Ñ–∏'],
            astroReach: 94, population: 800, strategic: false
        },
        
        // –°–ï–ì–ú–ï–ù–¢–£–ú –û–ë–°–ö–£–†–£–° (4)
        {
            id: 5, name: '–°–µ–∫—Ç–æ—Ä –ì–æ—Ç–∏–∫–∞', segmentumId: 2,
            status: 'war', stability: 50, threat: 'chaos',
            coordinates: { x: 230, y: 120 }, color: '#4B0082',
            connections: [1, 6, 13],
            fleets: { imperial: 50, enemy: 40 },
            resources: { tithe: 700, recruitment: 90 },
            specialFeatures: ['–ü–æ—Ä—Ç –ì–Ω–µ–≤–∞', '–û–∫–æ –£–∂–∞—Å–∞ (–≥—Ä–∞–Ω–∏—Ü–∞)', '–†—É–∏–Ω—ã –ö–∞–¥–∏–∏'],
            astroReach: 60, population: 450, strategic: true
        },
        {
            id: 6, name: '–°–µ–∫—Ç–æ—Ä –ö–∞–ª–∏–∫—Å–∏–¥–∞', segmentumId: 2,
            status: 'threatened', stability: 70, threat: 'chaos',
            coordinates: { x: 270, y: 140 }, color: '#4B0082',
            connections: [5, 7, 8],
            fleets: { imperial: 55, enemy: 20 },
            resources: { tithe: 900, recruitment: 110 },
            specialFeatures: ['–§–æ—Ä—Ç-–º–∏—Ä –°–∫–∏–Ω—Ç–∏–ª–ª–∞', '–°–∏—Å—Ç–µ–º–∞ –ú–∞–ª—Ñ–∏'],
            astroReach: 75, population: 550, strategic: false
        },
        {
            id: 7, name: '–°–µ–∫—Ç–æ—Ä –ú–∞–ª—Ñ–∏', segmentumId: 2,
            status: 'threatened', stability: 68, threat: 'chaos',
            coordinates: { x: 250, y: 180 }, color: '#4B0082',
            connections: [6, 8, 9],
            fleets: { imperial: 52, enemy: 18 },
            resources: { tithe: 850, recruitment: 105 },
            specialFeatures: ['–ú–∏—Ä—ã-–∫—É–∑–Ω–∏', '–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ä—Ç—ã'],
            astroReach: 72, population: 520, strategic: false
        },
        {
            id: 8, name: '–°–µ–∫—Ç–æ—Ä –ö–æ—Ä–æ–Ω–∞', segmentumId: 2,
            status: 'safe', stability: 80, threat: null,
            coordinates: { x: 290, y: 160 }, color: '#4B0082',
            connections: [6, 7, 13],
            fleets: { imperial: 60, enemy: 0 },
            resources: { tithe: 1100, recruitment: 130 },
            specialFeatures: ['–ö–æ—Ä–æ–Ω–Ω—ã–µ –º–∏—Ä—ã', '–í–æ–µ–Ω–Ω—ã–µ –∞–∫–∞–¥–µ–º–∏–∏'],
            astroReach: 82, population: 650, strategic: false
        },
        
        // –°–ï–ì–ú–ï–ù–¢–£–ú –ü–ê–¶–ò–§–ò–ö–£–° (4)
        {
            id: 9, name: '–°–µ–∫—Ç–æ—Ä –ü–µ—Ä—Å–µ—Ñ–æ–Ω', segmentumId: 3,
            status: 'safe', stability: 88, threat: null,
            coordinates: { x: 170, y: 360 }, color: '#006633',
            connections: [4, 7, 10],
            fleets: { imperial: 62, enemy: 0 },
            resources: { tithe: 1050, recruitment: 125 },
            specialFeatures: ['–ú–∏—Ä–Ω—ã–µ –º–∏—Ä—ã', '–°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–ª–∞–Ω–µ—Ç—ã'],
            astroReach: 84, population: 620, strategic: false
        },
        {
            id: 10, name: '–°–µ–∫—Ç–æ—Ä –¢—Ä–∏—Ñ–∏–¥', segmentumId: 3,
            status: 'safe', stability: 86, threat: null,
            coordinates: { x: 190, y: 400 }, color: '#006633',
            connections: [9, 11, 12],
            fleets: { imperial: 58, enemy: 0 },
            resources: { tithe: 980, recruitment: 115 },
            specialFeatures: ['–¢–æ—Ä–≥–æ–≤—ã–µ –ø—É—Ç–∏', '–¢—Ä–∞–Ω–∑–∏—Ç–Ω—ã–µ —Ö–∞–±—ã'],
            astroReach: 81, population: 580, strategic: false
        },
        {
            id: 11, name: '–°–µ–∫—Ç–æ—Ä –ì–æ–ª–≥–æ—Ñ–∞', segmentumId: 3,
            status: 'safe', stability: 84, threat: null,
            coordinates: { x: 210, y: 380 }, color: '#006633',
            connections: [10, 12, 17],
            fleets: { imperial: 56, enemy: 0 },
            resources: { tithe: 950, recruitment: 110 },
            specialFeatures: ['–ú–æ–Ω–∞—Å—Ç—ã—Ä—Å–∫–∏–µ –º–∏—Ä—ã', '–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –ª–∞–≥–µ—Ä—è'],
            astroReach: 79, population: 560, strategic: false
        },
        {
            id: 12, name: '–°–µ–∫—Ç–æ—Ä –í–∞—Ä–∞–Ω–∏—É—Å', segmentumId: 3,
            status: 'threatened', stability: 72, threat: 'orks',
            coordinates: { x: 230, y: 420 }, color: '#006633',
            connections: [10, 11, 17],
            fleets: { imperial: 54, enemy: 15 },
            resources: { tithe: 800, recruitment: 100 },
            specialFeatures: ['–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ –º–∏—Ä—ã', '–û—Ä–∫-–Ω–∞—à–µ—Å—Ç–≤–∏—è (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ)'],
            astroReach: 74, population: 500, strategic: true
        },
        
        // –°–ï–ì–ú–ï–ù–¢–£–ú –£–õ–¨–¢–ò–ú–ê (4)
        {
            id: 13, name: '–£–ª—å—Ç—Ä–∞–º–∞—Ä', segmentumId: 4,
            status: 'safe', stability: 95, threat: null,
            coordinates: { x: 600, y: 280 }, color: '#0066CC',
            connections: [1, 5, 8, 14],
            fleets: { imperial: 100, enemy: 0 },
            resources: { tithe: 2200, recruitment: 220 },
            specialFeatures: ['–ú–∞–∫—Ä–∞–≥–≥', '–ö—Ä–µ–ø–æ—Å—Ç—å –£–ª—å—Ç—Ä–∞–º–∞—Ä–∏–Ω–æ–≤', '500 –º–∏—Ä–æ–≤ –£–ª—å—Ç—Ä–∞–º–∞—Ä–∞', '–ü—Ä–∏–º–∞—Ä—Ö –†–æ–±–∞—É—Ç –ñ–∏–ª–ª–∏–º–∞–Ω'],
            astroReach: 90, population: 1200, strategic: true
        },
        {
            id: 14, name: '–°–µ–∫—Ç–æ—Ä –î–∞–º–æ–∫–ª–æ–≤', segmentumId: 4,
            status: 'threatened', stability: 65, threat: 'tau',
            coordinates: { x: 640, y: 300 }, color: '#0066CC',
            connections: [13, 15, 16],
            fleets: { imperial: 48, enemy: 25 },
            resources: { tithe: 750, recruitment: 95 },
            specialFeatures: ['–ì—Ä–∞–Ω–∏—Ü–∞ —Å –ò–º–ø–µ—Ä–∏–µ–π –¢–∞—É', '–§–ª–æ—Ç-—ç–∫—Å–ø–µ–¥–∏—Ü–∏—è –î–∞–º–æ–∫–ª–æ–≤'],
            astroReach: 68, population: 480, strategic: true
        },
        {
            id: 15, name: '–°–µ–∫—Ç–æ—Ä –¶–∏–∫–ª–æ–ø—Å', segmentumId: 4,
            status: 'threatened', stability: 62, threat: 'tyranids',
            coordinates: { x: 620, y: 340 }, color: '#0066CC',
            connections: [14, 16, 18],
            fleets: { imperial: 45, enemy: 35 },
            resources: { tithe: 680, recruitment: 85 },
            specialFeatures: ['–ü–µ—Ä–µ–¥–æ–≤—ã–µ –ø–æ—Å—Ç—ã', '–°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–Ω–µ–≥–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è', '–§–ª–æ—Ç-—É–ª–µ–π (—É–≥—Ä–æ–∑–∞)'],
            astroReach: 65, population: 440, strategic: true
        },
        {
            id: 16, name: '–°–µ–∫—Ç–æ—Ä –¢–∞–ª–ª–∞—Å–∞—Ä', segmentumId: 4,
            status: 'safe', stability: 82, threat: null,
            coordinates: { x: 580, y: 320 }, color: '#0066CC',
            connections: [13, 14, 15],
            fleets: { imperial: 64, enemy: 0 },
            resources: { tithe: 1150, recruitment: 135 },
            specialFeatures: ['–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –º–∏—Ä—ã', '–§–ª–æ—Ç—Å–∫–∏–µ –¥–æ–∫–∏'],
            astroReach: 80, population: 680, strategic: false
        },
        
        // –°–ï–ì–ú–ï–ù–¢–£–ú –¢–ï–ú–ü–ï–°–¢–£–° (4)
        {
            id: 17, name: '–°–µ–∫—Ç–æ—Ä –ú–∞—Ä–µ–ª–ª–∏—É—Å', segmentumId: 5,
            status: 'safe', stability: 85, threat: null,
            coordinates: { x: 370, y: 500 }, color: '#CC6600',
            connections: [11, 12, 18],
            fleets: { imperial: 60, enemy: 0 },
            resources: { tithe: 1080, recruitment: 128 },
            specialFeatures: ['–ì–æ—Ä–Ω–æ–¥–æ–±—ã–≤–∞—é—â–∏–µ –º–∏—Ä—ã', '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã'],
            astroReach: 78, population: 640, strategic: false
        },
        {
            id: 18, name: '–°–µ–∫—Ç–æ—Ä –°–∫–∞—Ä—É—Å', segmentumId: 5,
            status: 'safe', stability: 83, threat: null,
            coordinates: { x: 410, y: 520 }, color: '#CC6600',
            connections: [15, 17, 19],
            fleets: { imperial: 58, enemy: 0 },
            resources: { tithe: 1020, recruitment: 122 },
            specialFeatures: ['–ê–≥—Ä–∏-–º–∏—Ä—ã', '–≠–∫—Å–ø–æ—Ä—Ç–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã'],
            astroReach: 76, population: 610, strategic: false
        },
        {
            id: 19, name: '–°–µ–∫—Ç–æ—Ä –ê—Ç—Ç–∏–ª–∞', segmentumId: 5,
            status: 'threatened', stability: 68, threat: 'orks',
            coordinates: { x: 430, y: 480 }, color: '#CC6600',
            connections: [18, 20],
            fleets: { imperial: 50, enemy: 22 },
            resources: { tithe: 820, recruitment: 102 },
            specialFeatures: ['–ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ä—Ç—ã', '–í–∞—Ä–ø-–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å'],
            astroReach: 70, population: 510, strategic: true
        },
        {
            id: 20, name: '–°–µ–∫—Ç–æ—Ä –≠–∫—Å–æ–¥—É—Å', segmentumId: 5,
            status: 'safe', stability: 80, threat: null,
            coordinates: { x: 390, y: 460 }, color: '#CC6600',
            connections: [17, 19],
            fleets: { imperial: 55, enemy: 0 },
            resources: { tithe: 950, recruitment: 115 },
            specialFeatures: ['–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏', '–ö–æ–ª–æ–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–ª–æ—Ç—ã'],
            astroReach: 74, population: 580, strategic: false
        }
    ];
    
    console.log(`‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ ${this.segmentums.length} —Å–µ–≥–º–µ–Ω—Ç—É–º–æ–≤ –∏ ${this.sectors.length} —Å–µ–∫—Ç–æ—Ä–æ–≤`);
};

Game.generateGovernorName = function() {
    const firstNames = ['–ú–∞—Ä–∫—É—Å', '–õ—É—Ü–∏–π', '–í–∏–∫—Ç–æ—Ä', '–ú–∞–∫—Å–∏–º–∏–ª–∏–∞–Ω', '–°–µ–±–∞—Å—Ç—å—è–Ω', '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä', '–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω', '–î–º–∏—Ç—Ä–∏–π'];
    const lastNames = ['–í–∞–Ω–¥–∏—Ä', '–ö–∞—Å—Ç–µ–ª—è–Ω', '–ò–º–ø–µ—Ä–∞–Ω', '—Ñ–æ–Ω –ö—Ä–µ–π–≥', '–¢–æ—Ä–≤–∞–ª—å–¥', '–ú–∞–≥–Ω—É—Å', '–ñ–µ–ª–µ–∑–Ω—ã–π', '–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–π'];
    return `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`;
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–ï–†–°–û–ù–ê–õ–ê ====================
Game.initializePersonnel = function() {
    // –ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä—ã
    this.personnel.inquisitors = [
        {
            id: 1,
            name: '–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –≠–π–∑–µ–Ω—Ö–æ—Ä–Ω',
            ordo: '–ö—Å–µ–Ω–æ—Å',
            level: 10,
            experience: 100,
            specialty: '–ö—Å–µ–Ω–æ—Å—ã',
            status: 'available', // available, deployed, injured, deceased
            missions: 0,
            kills: 0,
            traits: ['–•–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–π', '–≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –∫—Å–µ–Ω–æ—Å–æ–≤']
        },
        {
            id: 2,
            name: '–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –ö–∞—Ä–∞–º–∞–∑–æ–≤',
            ordo: '–ï—Ä–µ—Ç–∏–∫—É—Å',
            level: 12,
            experience: 150,
            specialty: '–ï—Ä–µ—Ç–∏–∫–∏',
            status: 'available',
            missions: 0,
            kills: 0,
            traits: ['–ë–µ–∑–∂–∞–ª–æ—Å—Ç–Ω—ã–π', '–ú–∞—Å—Ç–µ—Ä –¥–æ–ø—Ä–æ—Å–∞']
        },
        {
            id: 3,
            name: '–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –ö–∞–π–∞—Ñ–∞—Å –ö–∞–∏–Ω',
            ordo: '–ú–∞–ª–ª–µ—É—Å',
            level: 15,
            experience: 200,
            specialty: '–î–µ–º–æ–Ω—ã',
            status: 'available',
            missions: 0,
            kills: 0,
            traits: ['–û—Ö–æ—Ç–Ω–∏–∫ –Ω–∞ –¥–µ–º–æ–Ω–æ–≤', '–í–∞—Ä–ø-—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å']
        }
    ];
    
    // –¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü—ã
    this.personnel.techpriests = [
        {
            id: 1,
            name: '–ê—Ä—Ö–∏–º–∞–≥–æ—Å –ë–µ–ª–∏–∑–∞—Ä–∏—É—Å –ö–æ—É–ª',
            rank: '–ê—Ä—Ö–∏–º–∞–≥–æ—Å',
            level: 8,
            specialty: '–ê—Ä—Ö–µ–æ—Ç–µ—Ö',
            status: 'available',
            augmentations: ['–ú–µ—Ö–∞–¥–µ–Ω–¥—Ä–∏—Ç—ã', '–£—Å–∏–ª–µ–Ω–Ω—ã–π –∫–æ–≥–∏—Ç–∞—Ç–æ—Ä'],
            bonus: { research: 15, production: 10 }
        },
        {
            id: 2,
            name: '–ú–∞–≥–æ—Å –î–æ–º–∏–Ω—É—Å –†–µ–¥—É–∫—Ü–∏—è',
            rank: '–ú–∞–≥–æ—Å',
            level: 6,
            specialty: '–í–æ–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
            status: 'available',
            augmentations: ['–ë–∞–ª–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–º–ø–ª–∞–Ω—Ç–∞—Ç—ã', '–¢–∞—Ä–≥–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã'],
            bonus: { military: 10, production: 5 }
        }
    ];
    
    // –ê—Å—Ç—Ä–æ–ø–∞—Ç—ã
    this.personnel.astropaths = [
        {
            id: 1,
            name: '–°—Ç–∞—Ä—à–∏–π –ê—Å—Ç—Ä–æ–ø–∞—Ç –ö–æ—Ä–≤—É—Å',
            level: 9,
            power: 85,
            status: 'available',
            specialty: '–î–∞–ª—å–Ω—è—è —Å–≤—è–∑—å',
            bonus: { communication: 20, warpStability: 5 }
        },
        {
            id: 2,
            name: '–ê—Å—Ç—Ä–æ–ø–∞—Ç –ü—Ä–∏–º–∞ –°–µ–ª–µ–Ω–∞',
            level: 7,
            power: 70,
            status: 'available',
            specialty: '–í–∞—Ä–ø-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è',
            bonus: { communication: 15, eventWarning: 10 }
        }
    ];
    
    // –ì–µ–Ω–µ—Ä–∞–ª—ã
    this.personnel.generals = [
        {
            id: 1,
            name: '–õ–æ—Ä–¥-–ö–æ–º–∞–Ω–¥–æ—Ä –°–æ–ª–∞—Ä –ú–∞—Ö–∞—Ä–∏—É—Å',
            rank: '–õ–æ—Ä–¥-–ö–æ–º–∞–Ω–¥–æ—Ä',
            level: 10,
            campaigns: 50,
            status: 'available',
            specialty: '–ö—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–µ –≤–æ–π–Ω—ã',
            bonus: { militaryPower: 25, morale: 15 }
        },
        {
            id: 2,
            name: '–ì–µ–Ω–µ—Ä–∞–ª –ö—Ä–æ–π—Ü',
            rank: '–õ–æ—Ä–¥-–ì–µ–Ω–µ—Ä–∞–ª',
            level: 8,
            campaigns: 30,
            status: 'available',
            specialty: '–û–±–æ—Ä–æ–Ω–∞',
            bonus: { defense: 20, fortification: 10 }
        }
    ];
    
    // –ù–∞–≤–∏–≥–∞—Ç–æ—Ä—ã
    this.personnel.navigators = [
        {
            id: 1,
            name: '–ù–∞–≤–∏–≥–∞—Ç–æ—Ä –ü—Ä–∞–π–º –û–∫—Ç–∞–≤–∏–π',
            house: '–î–æ–º –ë–µ–ª–ª–∏—Å–∞—Ä–∏—É—Å',
            level: 12,
            mutations: 2,
            status: 'available',
            specialty: '–û–ø–∞—Å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã',
            bonus: { warpTravel: 30, safety: 15 }
        }
    ];
    
    // –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
    this.personnel.administrators = [
        {
            id: 1,
            name: '–õ–æ—Ä–¥-–ê–¥–º–∏—Ä–∞–ª –õ–∞–Ω–µ—Å—Ç–µ—Ä',
            department: '–ê–¥–º–∏—Å—Ç—Ä–∞—Ç—É–º',
            level: 7,
            status: 'available',
            specialty: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞',
            bonus: { income: 10, efficiency: 15 }
        },
        {
            id: 2,
            name: '–ö–∞–∑–Ω–∞—á–µ–π –í–∞—Ä–≥–∞—Å',
            department: '–ö–∞–∑–Ω–∞—á–µ–π—Å—Ç–≤–æ',
            level: 6,
            status: 'available',
            specialty: '–§–∏–Ω–∞–Ω—Å—ã',
            bonus: { income: 20, taxCollection: 10 }
        }
    ];
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ô ====================
Game.initializeResearch = function() {
    this.researchDatabase = {
        // –ü—Å–∞–π–∫–µ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
        psychic: [
            {
                id: 'psy_efficiency',
                name: '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–π',
                category: 'psychic',
                cost: 5000,
                time: 30, // –¥–Ω–µ–π
                requirements: [],
                description: '–£–ª—É—á—à–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏—è –ø—Å–∞–π–∫–µ—Ä–æ–≤ –ø–æ–≤—ã—à–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞ –Ω–∞ 10%',
                effects: { sacrificeEfficiency: 10 },
                unlocked: true
            },
            {
                id: 'psy_training',
                name: '–£–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Å–∞–π–∫–µ—Ä–æ–≤',
                category: 'psychic',
                cost: 8000,
                time: 45,
                requirements: ['psy_efficiency'],
                description: '–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—É—á–µ–Ω–∏—è —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –ø—Å–∞–π–∫–µ—Ä–æ–≤ –Ω–∞ 15%',
                effects: { psychicSurvival: 15 },
                unlocked: false
            },
            {
                id: 'psy_sanctuaries',
                name: '–ü—Å–∞–π–∫–µ—Ä-—Å–≤—è—Ç–∏–ª–∏—â–∞',
                category: 'psychic',
                cost: 12000,
                time: 60,
                requirements: ['psy_training'],
                description: '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–≤—è—Ç–∏–ª–∏—â–∞ –¥–ª—è –ø—Å–∞–π–∫–µ—Ä–æ–≤ —Å–Ω–∏–∂–∞—é—Ç —Ä–∞—Å—Ö–æ–¥ –Ω–∞ 10%',
                effects: { sacrificeReduction: 10 },
                unlocked: false
            }
        ],
        
        // –í–∞—Ä–ø —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
        warp: [
            {
                id: 'warp_shields',
                name: '–£–ª—É—á—à–µ–Ω–Ω—ã–µ –≤–∞—Ä–ø-—â–∏—Ç—ã',
                category: 'warp',
                cost: 7000,
                time: 40,
                requirements: [],
                description: '–£—Å–∏–ª–µ–Ω–Ω—ã–µ —â–∏—Ç—ã –ì–µ–ª–ª–µ—Ä–∞ —Å–Ω–∏–∂–∞—é—Ç –≤–∞—Ä–ø-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ 5%',
                effects: { warpReduction: 5 },
                unlocked: true
            },
            {
                id: 'warp_stabilizers',
                name: '–í–∞—Ä–ø-—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä—ã',
                category: 'warp',
                cost: 10000,
                time: 50,
                requirements: ['warp_shields'],
                description: '–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ–ª—è –ø–æ–¥–∞–≤–ª—è—é—Ç –≤–∞—Ä–ø-—Ä–∞–∑–ª–æ–º—ã',
                effects: { riftSuppression: 20 },
                unlocked: false
            },
            {
                id: 'anti_demon',
                name: '–ê–Ω—Ç–∏-–¥–µ–º–æ–Ω–∏—á–µ—Å–∫–∏–µ –ø–µ—á–∞—Ç–∏',
                category: 'warp',
                cost: 15000,
                time: 70,
                requirements: ['warp_stabilizers'],
                description: '–°–≤—è—â–µ–Ω–Ω—ã–µ –ø–µ—á–∞—Ç–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤—É—é—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–µ–º–æ–Ω–æ–≤',
                effects: { demonReduction: 25 },
                unlocked: false
            }
        ],
        
        // –í–æ–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
        military: [
            {
                id: 'mil_training',
                name: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≤–æ–µ–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞',
                category: 'military',
                cost: 6000,
                time: 35,
                requirements: [],
                description: '–£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø–æ–≤—ã—à–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–æ–π—Å–∫ –Ω–∞ 15%',
                effects: { militaryEfficiency: 15 },
                unlocked: true
            },
            {
                id: 'mil_weapons',
                name: '–£—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–æ–µ –≤–æ–æ—Ä—É–∂–µ–Ω–∏–µ',
                category: 'military',
                cost: 9000,
                time: 45,
                requirements: ['mil_training'],
                description: '–ù–æ–≤—ã–µ –æ–±—Ä–∞–∑—Ü—ã –æ—Ä—É–∂–∏—è —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –æ–≥–Ω–µ–≤—É—é –º–æ—â—å –Ω–∞ 20%',
                effects: { firepower: 20 },
                unlocked: false
            },
            {
                id: 'mil_armor',
                name: '–£—Å–∏–ª–µ–Ω–Ω–∞—è –±—Ä–æ–Ω—è',
                category: 'military',
                cost: 11000,
                time: 50,
                requirements: ['mil_weapons'],
                description: '–£–ª—É—á—à–µ–Ω–Ω–∞—è –±—Ä–æ–Ω—è —Å–Ω–∏–∂–∞–µ—Ç –ø–æ—Ç–µ—Ä–∏ –≤–æ–π—Å–∫ –Ω–∞ 25%',
                effects: { armorBonus: 25 },
                unlocked: false
            }
        ],
        
        // –ê—Ä—Ö–µ–æ—Ç–µ—Ö
        archeoteh: [
            {
                id: 'arch_excavation',
                name: '–ê—Ä—Ö–µ–æ—Ç–µ—Ö —Ä–∞—Å–∫–æ–ø–∫–∏',
                category: 'archeoteh',
                cost: 10000,
                time: 60,
                requirements: [],
                description: '–ü–æ–∏—Å–∫ –¥—Ä–µ–≤–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –¢—ë–º–Ω–æ–π —ç—Ä—ã',
                effects: { techBonus: 10 },
                unlocked: true
            },
            {
                id: 'arch_stc',
                name: '–§—Ä–∞–≥–º–µ–Ω—Ç –®–¢–ö',
                category: 'archeoteh',
                cost: 20000,
                time: 90,
                requirements: ['arch_excavation'],
                description: '–û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –®–∞–±–ª–æ–Ω–∞ –ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏—è',
                effects: { production: 30, techBonus: 20 },
                unlocked: false
            },
            {
                id: 'arch_weapons',
                name: '–î—Ä–µ–≤–Ω–µ–µ –æ—Ä—É–∂–∏–µ',
                category: 'archeoteh',
                cost: 25000,
                time: 100,
                requirements: ['arch_stc'],
                description: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¢—ë–º–Ω–æ–π —ç—Ä—ã –ø–æ–≤—ã—à–∞—é—Ç –≤–æ–µ–Ω–Ω—É—é –º–æ—â—å –Ω–∞ 50%',
                effects: { militaryPower: 50 },
                unlocked: false
            }
        ],
        
        // –û–±–æ—Ä–æ–Ω–∞
        defense: [
            {
                id: 'def_orbital',
                name: '–û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞',
                category: 'defense',
                cost: 8000,
                time: 45,
                requirements: [],
                description: '–£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã',
                effects: { orbitalDefense: 20 },
                unlocked: true
            },
            {
                id: 'def_planetary',
                name: '–ü–ª–∞–Ω–µ—Ç–∞—Ä–Ω—ã–µ —â–∏—Ç—ã',
                category: 'defense',
                cost: 12000,
                time: 55,
                requirements: ['def_orbital'],
                description: '–ó–∞—â–∏—Ç–Ω—ã–µ –ø–æ–ª—è –ø–ª–∞–Ω–µ—Ç–∞—Ä–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞',
                effects: { planetaryDefense: 30 },
                unlocked: false
            },
            {
                id: 'def_fortress',
                name: '–ö—Ä–µ–ø–æ—Å—Ç—å-–º–∏—Ä',
                category: 'defense',
                cost: 18000,
                time: 80,
                requirements: ['def_planetary'],
                description: '–ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ –º–∏—Ä–æ–≤ –≤ –Ω–µ–ø—Ä–∏—Å—Ç—É–ø–Ω—ã–µ –∫—Ä–µ–ø–æ—Å—Ç–∏',
                effects: { fortification: 50 },
                unlocked: false
            }
        ]
    };
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –£–õ–£–ß–®–ï–ù–ò–ô ====================
Game.initializeUpgrades = function() {
    this.upgradesDatabase = {
        // –ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω
        throne: [
            {
                id: 'throne_repair',
                name: '–ú–∞–ª—ã–π —Ä–µ–º–æ–Ω—Ç –¢—Ä–æ–Ω–∞',
                category: 'throne',
                cost: 5000,
                level: 0,
                maxLevel: 10,
                description: '–ß–∞—Å—Ç–∏—á–Ω—ã–π —Ä–µ–º–æ–Ω—Ç –ó–æ–ª–æ—Ç–æ–≥–æ –¢—Ä–æ–Ω–∞ –∑–∞–º–µ–¥–ª—è–µ—Ç –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é',
                effect: { throneDegradation: -0.0005 }
            },
            {
                id: 'throne_stasis',
                name: '–°—Ç–∞–∑–∏—Å-–ø–æ–ª—è',
                category: 'throne',
                cost: 10000,
                level: 0,
                maxLevel: 5,
                description: '–°—Ç–∞–∑–∏—Å-–ø–æ–ª—è —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞',
                effect: { throneStability: 5 }
            },
            {
                id: 'throne_life_support',
                name: '–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∂–∏–∑–Ω–µ–æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è',
                category: 'throne',
                cost: 8000,
                level: 0,
                maxLevel: 5,
                description: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∂–∏–∑–Ω–∏ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä–∞',
                effect: { throneEfficiency: 3 }
            }
        ],
        
        // –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω
        astronomican: [
            {
                id: 'astro_amplifiers',
                name: '–ü—Å–∏—Ö–æ-—É—Å–∏–ª–∏—Ç–µ–ª–∏',
                category: 'astronomican',
                cost: 6000,
                level: 0,
                maxLevel: 10,
                description: '–£—Å–∏–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞',
                effect: { astronomicPower: 2 }
            },
            {
                id: 'astro_efficiency',
                name: '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–µ',
                category: 'astronomican',
                cost: 7000,
                level: 0,
                maxLevel: 5,
                description: '–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ –ø—Å–∞–π–∫–µ—Ä–æ–≤ –Ω–∞ 5%',
                effect: { sacrificeEfficiency: 5 }
            },
            {
                id: 'astro_choir',
                name: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ö–æ—Ä',
                category: 'astronomican',
                cost: 9000,
                level: 0,
                maxLevel: 3,
                description: '–ë–æ–ª—å—à–µ –ø—Å–∞–π–∫–µ—Ä–æ–≤ –≤ —Ö–æ—Ä–µ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å',
                effect: { stability: 5 }
            }
        ],
        
        // –û–±–æ—Ä–æ–Ω–∞ –¢–µ—Ä—Ä—ã
        defense: [
            {
                id: 'def_walls',
                name: '–ò–º–ø–µ—Ä—Å–∫–∏–π –î–≤–æ—Ä–µ—Ü - —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è',
                category: 'defense',
                cost: 5000,
                level: 0,
                maxLevel: 5,
                description: '–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å—Ç–µ–Ω –ò–º–ø–µ—Ä—Å–∫–æ–≥–æ –î–≤–æ—Ä—Ü–∞',
                effect: { defense: 10 }
            },
            {
                id: 'def_fleet',
                name: '–¢–µ—Ä—Ä–∞–Ω—Å–∫–∏–π —Ñ–ª–æ—Ç',
                category: 'defense',
                cost: 10000,
                level: 0,
                maxLevel: 10,
                description: '–£—Å–∏–ª–µ–Ω–∏–µ –æ—Ä–±–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ñ–ª–æ—Ç–∞ –¢–µ—Ä—Ä—ã',
                effect: { orbitalDefense: 15 }
            },
            {
                id: 'def_custodes',
                name: '–ê–¥–µ–ø—Ç—É—Å –ö—É—Å—Ç–æ–¥–µ—Å',
                category: 'defense',
                cost: 15000,
                level: 0,
                maxLevel: 3,
                description: '–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —ç–ª–∏—Ç–Ω—ã—Ö –≤–æ–π—Å–∫ –ö—É—Å—Ç–æ–¥–µ—Å',
                effect: { eliteForce: 20 }
            }
        ],
        
        // –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
        infrastructure: [
            {
                id: 'infra_production',
                name: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ—â–Ω–æ—Å—Ç–∏',
                category: 'infrastructure',
                cost: 4000,
                level: 0,
                maxLevel: 15,
                description: '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
                effect: { production: 5 }
            },
            {
                id: 'infra_transport',
                name: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å–µ—Ç–∏',
                category: 'infrastructure',
                cost: 5000,
                level: 0,
                maxLevel: 10,
                description: '–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞',
                effect: { logistics: 10 }
            },
            {
                id: 'infra_mining',
                name: '–ì–æ—Ä–Ω–æ–¥–æ–±—ã–≤–∞—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏',
                category: 'infrastructure',
                cost: 6000,
                level: 0,
                maxLevel: 10,
                description: '–î–æ–±—ã—á–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ –∏–º–ø–µ—Ä—Å–∫–∏—Ö –º–∏—Ä–∞—Ö',
                effect: { resourceGain: 8 }
            }
        ],
        
        // –≠–∫–æ–Ω–æ–º–∏–∫–∞
        economy: [
            {
                id: 'eco_tax',
                name: '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–±–æ—Ä –Ω–∞–ª–æ–≥–æ–≤',
                category: 'economy',
                cost: 3000,
                level: 0,
                maxLevel: 10,
                description: '–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è',
                effect: { income: 100 }
            },
            {
                id: 'eco_trade',
                name: '–¢–æ—Ä–≥–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã',
                category: 'economy',
                cost: 5000,
                level: 0,
                maxLevel: 8,
                description: '–†–∞–∑–≤–∏—Ç–∏–µ –º–µ–∂–∑–≤—ë–∑–¥–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏',
                effect: { income: 150 }
            },
            {
                id: 'eco_tithe',
                name: '–ò–º–ø–µ—Ä—Å–∫–∞—è –¥–µ—Å—è—Ç–∏–Ω–∞',
                category: 'economy',
                cost: 7000,
                level: 0,
                maxLevel: 5,
                description: '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Å–±–æ—Ä–æ–≤ —Å –ø–ª–∞–Ω–µ—Ç',
                effect: { income: 200 }
            }
        ]
    };
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π
    this.upgrades = {};
    Object.keys(this.upgradesDatabase).forEach(categoryName => {
        const category = this.upgradesDatabase[categoryName];
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ category - —ç—Ç–æ –º–∞—Å—Å–∏–≤
        if (!Array.isArray(category)) {
            console.warn(`–ö–∞—Ç–µ–≥–æ—Ä–∏—è "${categoryName}" –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
            return;
        }
        
        category.forEach(upgrade => {
            this.upgrades[upgrade.id] = {
                level: upgrade.level,
                active: false
            };
        });
    });
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –î–û–°–¢–ò–ñ–ï–ù–ò–ô ====================
Game.initializeAchievements = function() {
    this.achievements = [
        {
            id: 'first_day',
            name: '–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å',
            description: '–ü—Ä–æ—Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –æ–¥–∏–Ω –¥–µ–Ω—å',
            condition: () => this.day >= 1,
            unlocked: false,
            icon: 'üìÖ'
        },
        {
            id: 'hundred_days',
            name: '–°—Ç–æ–ª–µ—Ç–∏–µ',
            description: '–ü—Ä–æ—Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å 100 –¥–Ω–µ–π',
            condition: () => this.day >= 100,
            unlocked: false,
            icon: 'üíØ'
        },
        {
            id: 'thousand_sacrifices',
            name: '–î–µ—Å—è—Ç—å —Ç—ã—Å—è—á –∂–µ—Ä—Ç–≤',
            description: '–ü—Ä–∏–Ω–µ—Å—Ç–∏ –≤ –∂–µ—Ä—Ç–≤—É 10000 –ø—Å–∞–π–∫–µ—Ä–æ–≤',
            condition: () => this.stats.totalSacrifices >= 10000,
            unlocked: false,
            icon: 'üíÄ'
        },
        {
            id: 'wealthy',
            name: '–ë–æ–≥–∞—á –ò–º–ø–µ—Ä–∏—É–º–∞',
            description: '–ù–∞–∫–æ–ø–∏—Ç—å 50000 –∫—Ä–µ–¥–∏—Ç–æ–≤',
            condition: () => this.resources.credits >= 50000,
            unlocked: false,
            icon: 'üí∞'
        },
        {
            id: 'admiral',
            name: '–õ–æ—Ä–¥-–ê–¥–º–∏—Ä–∞–ª',
            description: '–ò–º–µ—Ç—å —Ñ–ª–æ—Ç –∏–∑ 100 –∫–æ—Ä–∞–±–ª–µ–π',
            condition: () => this.resources.fleet >= 100,
            unlocked: false,
            icon: 'üöÄ'
        },
        {
            id: 'researcher',
            name: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å',
            description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 5 –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π',
            condition: () => this.stats.researchCompleted >= 5,
            unlocked: false,
            icon: 'üî¨'
        },
        {
            id: 'enemy_hunter',
            name: '–û—Ö–æ—Ç–Ω–∏–∫ –∑–∞ –∫—Å–µ–Ω–æ—Å–∞–º–∏',
            description: '–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å 1000 –≤—Ä–∞–≥–æ–≤',
            condition: () => this.stats.enemiesKilled >= 1000,
            unlocked: false,
            icon: '‚öîÔ∏è'
        },
        {
            id: 'savior',
            name: '–°–ø–∞—Å–∏—Ç–µ–ª—å —Å–µ–∫—Ç–æ—Ä–æ–≤',
            description: '–°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å 10 —Å–µ–∫—Ç–æ—Ä–æ–≤',
            condition: () => this.stats.missionsCompleted >= 10,
            unlocked: false,
            icon: 'üõ°Ô∏è'
        },
        {
            id: 'throne_guardian',
            name: '–•—Ä–∞–Ω–∏—Ç–µ–ª—å –¢—Ä–æ–Ω–∞',
            description: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¢—Ä–æ–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ 100% –≤ —Ç–µ—á–µ–Ω–∏–µ 50 –¥–Ω–µ–π',
            condition: () => this.astronomican.throneCondition >= 100 && this.day >= 50,
            unlocked: false,
            icon: 'üëë'
        },
        {
            id: 'warp_suppressor',
            name: '–ü–æ–¥–∞–≤–∏—Ç–µ–ª—å –≤–∞—Ä–ø–∞',
            description: '–°–Ω–∏–∑–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∞—Ä–ø–∞ –¥–æ 10%',
            condition: () => this.warp.level <= 10,
            unlocked: false,
            icon: 'üåÄ'
        },
        {
            id: 'mass_sacrifice',
            name: '–í–µ–ª–∏–∫–∞—è –∂–µ—Ä—Ç–≤–∞',
            description: '–ü—Ä–∏–Ω–µ—Å—Ç–∏ –≤ –∂–µ—Ä—Ç–≤—É 100 –ø—Å–∞–π–∫–µ—Ä–æ–≤ –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑',
            condition: () => false, // –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏—è
            unlocked: false,
            icon: '‚ö∞Ô∏è'
        },
        {
            id: 'max_efficiency',
            name: '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –º–æ—â—å',
            description: '–î–æ—Å—Ç–∏—á—å 150% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞',
            condition: () => this.astronomican.efficiency >= 150,
            unlocked: false,
            icon: 'üåü'
        },
        {
            id: 'warp_master',
            name: '–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –≤–∞—Ä–ø–∞',
            description: '–°–Ω–∏–∑–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–∞—Ä–ø–∞ –¥–æ 5%',
            condition: () => this.warp.level <= 5,
            unlocked: false,
            icon: 'üîÆ'
        },
        {
            id: 'fleet_admiral',
            name: '–í–µ–ª–∏–∫–∏–π –ê–¥–º–∏—Ä–∞–ª',
            description: '–ò–º–µ—Ç—å —Ñ–ª–æ—Ç –∏–∑ 500 –∫–æ—Ä–∞–±–ª–µ–π',
            condition: () => this.resources.fleet >= 500,
            unlocked: false,
            icon: '‚öì'
        },
        {
            id: 'all_sectors',
            name: '–ì–æ—Å–ø–æ–¥—Å—Ç–≤–æ –ò–º–ø–µ—Ä–∏—É–º–∞',
            description: '–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 8 —Å–µ–∫—Ç–æ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ',
            condition: () => this.sectors.filter(s => s.status === 'safe' || s.status === 'threatened').length === 8,
            unlocked: false,
            icon: 'üëë'
        },
        {
            id: 'research_master',
            name: '–ú–∞–≥–∏—Å—Ç—Ä –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π',
            description: '–ó–∞–≤–µ—Ä—à–∏—Ç—å 20 –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π',
            condition: () => this.stats.researchCompleted >= 20,
            unlocked: false,
            icon: 'üìö'
        },
        {
            id: 'survivor',
            name: '–í–µ—á–Ω—ã–π —Å—Ç—Ä–∞–∂',
            description: '–ü—Ä–æ—Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å 1000 –¥–Ω–µ–π',
            condition: () => this.day >= 1000,
            unlocked: false,
            icon: '‚ôæÔ∏è'
        },
        {
            id: 'enemy_destroyer',
            name: '–ò—Å—Ç—Ä–µ–±–∏—Ç–µ–ª—å –ª–µ–≥–∏–æ–Ω–æ–≤',
            description: '–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å 10000 –≤—Ä–∞–≥–æ–≤',
            condition: () => this.stats.enemiesKilled >= 10000,
            unlocked: false,
            icon: '‚öîÔ∏è'
        },
        {
            id: 'perfect_throne',
            name: '–ë–µ–∑—É–ø—Ä–µ—á–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∫—É—Å',
            description: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¢—Ä–æ–Ω –Ω–∞ 100% –≤ —Ç–µ—á–µ–Ω–∏–µ 100 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥',
            condition: () => false, // –¢—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞
            unlocked: false,
            icon: 'üîß'
        },
        {
            id: 'credit_emperor',
            name: '–ë–æ–≥–∞—Ç—Å—Ç–≤–æ –ò–º–ø–µ—Ä–∏—É–º–∞',
            description: '–ù–∞–∫–æ–ø–∏—Ç—å 500000 –∫—Ä–µ–¥–∏—Ç–æ–≤',
            condition: () => this.resources.credits >= 500000,
            unlocked: false,
            icon: 'üíé'
        }
    ];
};

// ==================== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–ï–†–°–û–ù–ê–ñ–ê ====================
Game.generateCharacter = function(type) {
    const template = this.personnelTemplates[type];
    if (!template) return null;
    
    const names = {
        inquisitor: ['–¢–æ—Ä–∫–≤–µ–º–∞–¥–∞', '–ö–∞—Ç–∞—Ä–∏–Ω–∞', '–≠–π–∑–µ–Ω—Ö–æ—Ä–Ω', '–†–µ–π–≤–µ–Ω–æ—Ä', '–ö–∞–π–∞—Ñ–∞—Å'],
        techPriest: ['–ö–∞—É–ª', '–ö–æ–≥–≥–µ—Ä', '–î–∞—Ç–∞–º–∞–Ω—Ç', '–ê—Ä—Ö–∏–º–∞–≥–æ—Å', '–°–µ—Ä–≤–æ—Ä—É—Å'],
        astropath: ['–í–∏–¥–µ–Ω', '–ê—É—Ä–µ–ª–∏—è', '–ü—Å–∏—Ö–æ–Ω', '–î–∏–≤–∏–Ω—É—Å', '–û–º–µ–Ω']
    };
    
    const character = {
        id: Date.now() + Math.random(),
        name: names[type][Math.floor(Math.random() * names[type].length)],
        type: type,
        trait: template.traits[Math.floor(Math.random() * template.traits.length)],
        specialty: template.specialties[Math.floor(Math.random() * template.specialties.length)],
        level: 1,
        experience: 0,
        loyalty: 50 + Math.random() * 50,
        effectiveness: 0.5 + Math.random() * 0.5,
        effects: { ...template.effects },
        assignedTo: null,
        events: []
    };
    
    return character;
};

// ==================== –ù–ê–ô–ú –ü–ï–†–°–û–ù–ê–ñ–ê ====================
Game.recruitCharacter = function(type) {
    const costs = {
        inquisitor: 5000,
        techPriest: 3000,
        astropath: 4000
    };
    
    const cost = costs[type] || 5000;
    
    if (this.resources.credits < cost) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= cost;
    
    const character = this.generateCharacter(type);
    
    if (character) {
        this.personnel[type + 's'].push(character);
        this.log(`–ù–∞–Ω—è—Ç ${character.name} (${character.trait} ${character.specialty})`, 'success');
        this.notify(`${character.name} –Ω–∞–Ω—è—Ç!`, 'success');
    }
    
    this.updateUI();
};

// ==================== –°–û–ë–´–¢–ò–Ø –ü–ï–†–°–û–ù–ê–ñ–ï–ô ====================
Game.generateCharacterEvent = function() {
    const allCharacters = [
        ...this.personnel.inquisitors,
        ...this.personnel.techPriests,
        ...this.personnel.astropaths
    ];
    
    if (allCharacters.length === 0) return;
    
    const character = allCharacters[Math.floor(Math.random() * allCharacters.length)];
    
    const events = [
        {
            title: `${character.name} –æ–±–Ω–∞—Ä—É–∂–∏–ª —É–≥—Ä–æ–∑—É`,
            description: `${character.type} ${character.name} —Å–æ–æ–±—â–∞–µ—Ç –æ —Ç—Ä–µ–≤–æ–∂–Ω—ã—Ö –∑–Ω–∞–∫–∞—Ö.`,
            choices: [
                {
                    text: '–†–∞—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ',
                    action: () => {
                        if (Math.random() < character.effectiveness) {
                            this.warp.level -= 10;
                            character.experience += 50;
                            this.log(`${character.name} –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏–ª —É–≥—Ä–æ–∑—É!`, 'success');
                        } else {
                            this.log(`${character.name} –Ω–µ —Å–º–æ–≥ –Ω–∞–π—Ç–∏ —É–≥—Ä–æ–∑—É`, 'info');
                        }
                    }
                },
                {
                    text: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å',
                    action: () => {
                        character.loyalty -= 10;
                        this.log('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–æ', 'info');
                    }
                }
            ]
        },
        {
            title: `${character.name} –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã`,
            description: `${character.name} –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã.`,
            choices: [
                {
                    text: '–í—ã–¥–µ–ª–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã (-2000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 2000) {
                            this.resources.credits -= 2000;
                            character.effectiveness += 0.1;
                            character.loyalty += 10;
                            this.log(`${character.name} –ø–æ–ª—É—á–∏–ª —Ä–µ—Å—É—Ä—Å—ã`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤', 'warning');
                        }
                    }
                },
                {
                    text: '–û—Ç–∫–∞–∑–∞—Ç—å',
                    action: () => {
                        character.loyalty -= 5;
                        this.log('–í —Ä–µ—Å—É—Ä—Å–∞—Ö –æ—Ç–∫–∞–∑–∞–Ω–æ', 'info');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –ò–ó–ú–ï–ù–ï–ù–ò–ï –†–ï–ü–£–¢–ê–¶–ò–ò ====================
Game.changeReputation = function(faction, amount, reason) {
    if (!this.reputation[faction]) {
        console.warn(`–§—Ä–∞–∫—Ü–∏—è ${faction} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞`);
        return;
    }
    
    const rep = this.reputation[faction];
    const oldLevel = rep.level;
    
    rep.level = Math.max(0, Math.min(100, rep.level + amount));
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
    const oldStatus = rep.status;
    rep.status = this.getReputationStatus(rep.level);
    
    // –ó–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é
    rep.history.push({
        day: this.day,
        change: amount,
        reason: reason,
        newLevel: rep.level
    });
    
    // –ï—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è, –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∑–∞–ø–∏—Å–µ–π
    if (rep.history.length > 50) {
        rep.history.shift();
    }
    
    // –õ–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    const direction = amount > 0 ? '‚Üë' : '‚Üì';
    const color = amount > 0 ? 'success' : 'warning';
    this.log(`${direction} –†–µ–ø—É—Ç–∞—Ü–∏—è —Å ${faction}: ${Math.abs(amount)} (${reason})`, color);
    
    // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è
    if (oldStatus !== rep.status) {
        this.onReputationStatusChanged(faction, oldStatus, rep.status);
    }
    
    // –ü–µ—Ä–µ—Å—á—ë—Ç –±–æ–Ω—É—Å–æ–≤
    this.updateReputationBenefits(faction);
};

// ==================== –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–ê ====================
Game.getReputationStatus = function(level) {
    const thresholds = this.reputationThresholds;
    
    if (level >= thresholds.allied) return 'allied';
    if (level >= thresholds.friendly) return 'friendly';
    if (level >= thresholds.neutral) return 'neutral';
    if (level >= thresholds.unfriendly) return 'unfriendly';
    return 'hostile';
};

// ==================== –û–ë–†–ê–ë–û–¢–ö–ê –ò–ó–ú–ï–ù–ï–ù–ò–Ø –°–¢–ê–¢–£–°–ê ====================
Game.onReputationStatusChanged = function(faction, oldStatus, newStatus) {
    const factionNames = {
        mechanicus: '–ê–¥–µ–ø—Ç—É—Å –ú–µ—Ö–∞–Ω–∏–∫—É—Å',
        inquisition: '–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è',
        ecclesiarchy: '–≠–∫–∫–ª–µ–∑–∏–∞—Ä—Ö–∏—è',
        imperialNavy: '–ò–º–ø–µ—Ä—Å–∫–∏–π –§–ª–æ—Ç',
        astartes: '–ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç',
        eldar: '–≠–ª—å–¥–∞—Ä',
        tau: '–¢–∞—É'
    };
    
    const statusNames = {
        hostile: '–í—Ä–∞–∂–¥–µ–±–Ω—ã',
        unfriendly: '–ù–µ–¥—Ä—É–∂–µ–ª—é–±–Ω—ã',
        neutral: '–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã',
        friendly: '–î—Ä—É–∂–µ–ª—é–±–Ω—ã',
        allied: '–°–æ—é–∑–Ω–∏–∫–∏'
    };
    
    const name = factionNames[faction] || faction;
    const status = statusNames[newStatus] || newStatus;
    
    this.log(`‚ö†Ô∏è ${name} —Ç–µ–ø–µ—Ä—å: ${status}`, 'info');
    this.notify(`${name}: ${status}!`, newStatus === 'allied' ? 'success' : 'info');
    
    // –û—Å–æ–±—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤
    if (newStatus === 'allied') {
        this.onFactionAllied(faction);
    } else if (newStatus === 'hostile' && oldStatus !== 'hostile') {
        this.onFactionHostile(faction);
    }
};

// ==================== –°–û–Æ–ó –° –§–†–ê–ö–¶–ò–ï–ô ====================
Game.onFactionAllied = function(faction) {
    switch(faction) {
        case 'mechanicus':
            this.astronomican.throneCondition += 20;
            this.addModifier('technologicalBreakthrough', `alliance with ${faction}`);
            this.notify('–ú–µ—Ö–∞–Ω–∏–∫—É—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Ä–µ–º–æ–Ω—Ç–∞ –¢—Ä–æ–Ω–∞!', 'success');
            break;
        case 'inquisition':
            this.warp.level -= 15;
            this.notify('–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è —É—Å–∏–ª–∏–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç –≤–∞—Ä–ø–∞!', 'success');
            break;
        case 'imperialNavy':
            this.resources.fleet += 50;
            this.addModifier('imperialRecruitment', `alliance with ${faction}`);
            this.notify('–ò–º–ø–µ—Ä—Å–∫–∏–π –§–ª–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏—è!', 'success');
            break;
        case 'astartes':
            this.resources.military += 100;
            this.notify('–ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª –≤–æ–π—Å–∫–∞!', 'success');
            break;
    }
};

// ==================== –í–†–ê–ñ–î–ê –° –§–†–ê–ö–¶–ò–ï–ô ====================
Game.onFactionHostile = function(faction) {
    switch(faction) {
        case 'mechanicus':
            this.resourceChanges.techpriests -= 0.5;
            this.notify('–ú–µ—Ö–∞–Ω–∏–∫—É—Å –æ—Ç–∑—ã–≤–∞–µ—Ç —Ç–µ—Ö–Ω–æ–∂—Ä–µ—Ü–æ–≤!', 'warning');
            break;
        case 'inquisition':
            this.warp.level += 10;
            this.notify('–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª–∞ –ø–æ–º–æ—â—å!', 'warning');
            break;
        case 'imperialNavy':
            this.resourceChanges.fleet -= 1;
            this.notify('–§–ª–æ—Ç –æ—Ç–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–∞–±–ª–∏!', 'warning');
            break;
    }
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–û–ù–£–°–û–í ====================
Game.updateReputationBenefits = function(faction) {
    const rep = this.reputation[faction];
    if (!rep) return;
    
    // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—é —Ä–µ–ø—É—Ç–∞—Ü–∏–∏
    const scale = rep.level / 100;
    
    switch(faction) {
        case 'mechanicus':
            rep.benefits.throneRepair = Math.floor(scale * 5);
            rep.benefits.techBonus = Math.floor(scale * 10);
            rep.benefits.discount = Math.floor(scale * 20);
            break;
        case 'inquisition':
            rep.benefits.warpSuppression = Math.floor(scale * 10);
            rep.benefits.intelBonus = Math.floor(scale * 15);
            rep.benefits.psykerBonus = Math.floor(scale * 100);
            break;
        case 'ecclesiarchy':
            rep.benefits.morale = Math.floor(scale * 10);
            rep.benefits.recruitment = Math.floor(scale * 5);
            rep.benefits.donation = Math.floor(scale * 1000);
            break;
        case 'imperialNavy':
            rep.benefits.fleetDiscount = Math.floor(scale * 15);
            rep.benefits.fleetBonus = Math.floor(scale * 2);
            rep.benefits.transport = Math.floor(scale * 10);
            break;
        case 'astartes':
            rep.benefits.militarySupport = Math.floor(scale * 20);
            rep.benefits.training = Math.floor(scale * 5);
            rep.benefits.librarians = Math.floor(scale * 2);
            break;
    }
};

// ==================== –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ë–û–ù–£–°–û–í –†–ï–ü–£–¢–ê–¶–ò–ò ====================
Game.applyReputationBonuses = function() {
    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –≤ –∏–≥—Ä–æ–≤–æ–º —Ü–∏–∫–ª–µ
    
    // –ú–µ—Ö–∞–Ω–∏–∫—É—Å - –±–æ–Ω—É—Å –∫ —Ä–µ–º–æ–Ω—Ç—É –¢—Ä–æ–Ω–∞
    if (this.reputation.mechanicus.level >= 50) {
        this.astronomican.throneCondition += this.reputation.mechanicus.benefits.throneRepair * 0.1;
    }
    
    // –ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è - –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–ø–∞
    if (this.reputation.inquisition.level >= 50) {
        this.warp.level = Math.max(0, this.warp.level - this.reputation.inquisition.benefits.warpSuppression * 0.01);
    }
    
    // –§–ª–æ—Ç - –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∫–æ—Ä–∞–±–ª–µ–π
    if (this.reputation.imperialNavy.level >= 50) {
        this.resourceChanges.fleet += this.reputation.imperialNavy.benefits.fleetBonus * 0.01;
    }
};

// ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================

// –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–ø-—à—Ç–æ—Ä–º–∞
Game.createWarpStorm = function() {
    this.warp.storms++;
    
    const affectedSector = this.sectors[Math.floor(Math.random() * this.sectors.length)];
    affectedSector.stability -= 15;
    
    this.log(`‚ö†Ô∏è –í–∞—Ä–ø-—à—Ç–æ—Ä–º –æ–±—Ä—É—à–∏–ª—Å—è –Ω–∞ ${affectedSector.name}! –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∞.`, 'critical');
    this.notify('–í–∞—Ä–ø-—à—Ç–æ—Ä–º!', 'critical');
    
    // –®—Ç–æ—Ä–º —Ä–∞—Å—Å–µ–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
    setTimeout(() => {
        this.warp.storms = Math.max(0, this.warp.storms - 1);
    }, 50000); // 50 —Å–µ–∫—É–Ω–¥
};

// –í—Ç–æ—Ä–∂–µ–Ω–∏–µ –¥–µ–º–æ–Ω–æ–≤
Game.triggerDemonIncursion = function() {
    this.warp.chaosIncursions++;
    
    const targetSector = this.sectors.find(s => s.status !== 'lost') || this.sectors[0];
    targetSector.status = 'war';
    targetSector.stability -= 25;
    targetSector.threat = 'chaos';
    
    this.enemies.chaos.sectors.push(targetSector.id);
    
    this.log(`‚ò†Ô∏è –î–ï–ú–û–ù–ò–ß–ï–°–ö–û–ï –í–¢–û–†–ñ–ï–ù–ò–ï –≤ ${targetSector.name}! –°–µ–∫—Ç–æ—Ä –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≤–æ–π–Ω—ã!`, 'critical');
    this.notify('–î–µ–º–æ–Ω–∏—á–µ—Å–∫–æ–µ –≤—Ç–æ—Ä–∂–µ–Ω–∏–µ!', 'critical');
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π
    this.showChoiceEvent({
        title: '–î–µ–º–æ–Ω–∏—á–µ—Å–∫–æ–µ –≤—Ç–æ—Ä–∂–µ–Ω–∏–µ!',
        description: `–†–∞–∑–ª–æ–º –≤ –≤–∞—Ä–ø–µ –æ—Ç–∫—Ä—ã–ª—Å—è –Ω–∞–¥ ${targetSector.name}. –õ–µ–≥–∏–æ–Ω—ã –¥–µ–º–æ–Ω–æ–≤ —Ö–ª—ã–Ω—É–ª–∏ –Ω–∞ –ø–ª–∞–Ω–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞. –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è!`,
        choices: [
            {
                text: '–ü–æ—Å–ª–∞—Ç—å –°–µ—Ä—ã—Ö –†—ã—Ü–∞—Ä–µ–π (3000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                action: () => {
                    if (this.resources.credits >= 3000) {
                        this.resources.credits -= 3000;
                        targetSector.stability += 30;
                        this.stats.enemiesKilled += 500;
                        this.log('–°–µ—Ä—ã–µ –†—ã—Ü–∞—Ä–∏ –∏–∑–≥–Ω–∞–ª–∏ –¥–µ–º–æ–Ω–æ–≤!', 'success');
                    } else {
                        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                        this.sounds.warning();
                    }
                }
            },
            {
                text: '–û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è –±–æ–º–±–∞—Ä–¥–∏—Ä–æ–≤–∫–∞ (1000 –∫—Ä–µ–¥–∏—Ç–æ–≤, -10 –Ω–∞—Å–µ–ª–µ–Ω–∏–µ)',
                action: () => {
                    if (this.resources.credits >= 1000) {
                        this.resources.credits -= 1000;
                        targetSector.population -= 10;
                        targetSector.stability += 20;
                        this.log('–≠–∫—Å—Ç–µ—Ä–º–∏–Ω–∞—Ç—É—Å —á–∞—Å—Ç–∏—á–Ω–æ –æ—á–∏—Å—Ç–∏–ª —Å–µ–∫—Ç–æ—Ä.', 'warning');
                    } else {
                        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                        this.sounds.warning();
                    }
                }
            },
            {
                text: '–ú–æ–±–∏–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Å—Ç–Ω—ã–µ —Å–∏–ª—ã (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –º–µ–Ω—å—à–µ —ç—Ñ—Ñ–µ–∫—Ç)',
                action: () => {
                    targetSector.stability += 10;
                    targetSector.military -= 2;
                    this.log('–ú–µ—Å—Ç–Ω—ã–µ —Å–∏–ª—ã —Å–¥–µ—Ä–∂–∏–≤–∞—é—Ç –¥–µ–º–æ–Ω–æ–≤.', 'info');
                }
            }
        ]
    });
};

// –ü–æ—Ç–µ—Ä—è —Å–µ–∫—Ç–æ—Ä–∞
Game.triggerSectorLostEvent = function(sector) {
    // –ü–æ—Ç–µ—Ä—è —Ä–µ—Å—É—Ä—Å–æ–≤
    const lostCredits = sector.production * 10;
    const lostPop = sector.population;
    
    this.resources.credits -= lostCredits;
    this.resources.population -= lostPop;
    
    // –í–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞—Ä–ø
    this.warp.level += 5;
    
    this.notify(`–°–µ–∫—Ç–æ—Ä ${sector.name} –ø–æ—Ç–µ—Ä—è–Ω!`, 'critical');
};

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∏—Å—Å–∏–∏
Game.completeMission = function(mission, index) {
    this.stats.missionsCompleted++;
    
    // –ù–∞–≥—Ä–∞–¥—ã
    if (mission.rewards) {
        Object.entries(mission.rewards).forEach(([resource, amount]) => {
            this.resources[resource] += amount;
        });
    }
    
    this.log(`–ú–∏—Å—Å–∏—è "${mission.name}" –∑–∞–≤–µ—Ä—à–µ–Ω–∞!`, 'success');
    this.notify('–ú–∏—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!', 'success');

    this.sounds.success();
    
    // –£–¥–∞–ª–∏—Ç—å –º–∏—Å—Å–∏—é
    this.missions.splice(index, 1);
    
    this.updateUI();
};

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
Game.completeResearch = function(research) {
    this.research.completed.push(research.id);
    this.stats.researchCompleted++;
    
    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã
    if (research.effects) {
        Object.entries(research.effects).forEach(([effect, value]) => {
            // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –±–æ–Ω—É—Å—ã –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–∏—Å—Ç–µ–º–∞–º
            switch(effect) {
                case 'sacrificeEfficiency':
                    this.astronomican.efficiency += value;
                    break;
                case 'warpReduction':
                    this.warp.level -= value;
                    break;
                case 'income':
                    this.resourceChanges.credits += value;
                    break;
                // ... –¥—Ä—É–≥–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            }
        });
    }
    
    // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
    Object.values(this.researchDatabase).forEach(category => {
        category.forEach(r => {
            if (r.requirements.includes(research.id)) {
                r.unlocked = true;
            }
        });
    });
    
    this.log(`–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ "${research.name}" –∑–∞–≤–µ—Ä—à–µ–Ω–æ!`, 'success');
    this.notify('–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'success');

    this.sounds.success();
    
    this.research.current = null;
    this.research.progress = 0;
    
    this.updateUI();
};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
Game.checkAchievements = function() {
    this.achievements.forEach(achievement => {
        if (!achievement.unlocked && achievement.condition()) {
            achievement.unlocked = true;
            this.showAchievement(achievement);
        }
    });
};

// –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ
Game.showAchievement = function(achievement) {
    const container = document.getElementById('achievement-container');
    const div = document.createElement('div');
    div.className = 'notification success';
    div.innerHTML = `
        <div style="font-size: 2em; margin-bottom: 10px;">${achievement.icon}</div>
        <div style="font-family: 'Cinzel', serif; font-size: 1.2em; margin-bottom: 5px;">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!</div>
        <div style="font-weight: 700;">${achievement.name}</div>
        <div style="font-size: 0.9em; color: #aaa; margin-top: 5px;">${achievement.description}</div>
    `;
    
    container.appendChild(div);
    
    setTimeout(() => {
        if (div.parentNode) div.remove();
    }, 5000);
};

// ==================== –ñ–ï–†–¢–í–û–ü–†–ò–ù–û–®–ï–ù–ò–ï –° –í–´–ë–û–†–û–ú –¢–ò–ü–ê ====================
Game.sacrificePsykerType = function(type, amount) {
    const psykerType = this.psykerTypes[type];
    
    if (!psykerType) {
        this.notify('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ø—Å–∞–π–∫–µ—Ä–∞!', 'warning');
        this.sounds.warning();
        return;
    }
    
    if (this.psykerPool[type] < amount) {
        this.notify(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Å–∞–π–∫–µ—Ä–æ–≤ —Ç–∏–ø–∞ ${psykerType.name}!`, 'warning');
        this.sounds.warning();
        return;
    }
    
    // –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    this.psykerPool[type] -= amount;
    this.resources.psychic -= amount;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Å–∞–π–∫–µ—Ä–∞
    let successfulSacrifices = 0;
    let failedSacrifices = 0;
    
    for (let i = 0; i < amount; i++) {
        if (Math.random() * 100 < psykerType.stability) {
            successfulSacrifices++;
        } else {
            failedSacrifices++;
            this.warp.level += 2;
        }
    }
    
    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç
    this.astronomican.efficiency += successfulSacrifices * psykerType.power * 0.1;
    this.astronomican.throneCondition += successfulSacrifices * 0.5;
    this.stats.totalSacrifices += amount;
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    if (failedSacrifices > 0) {
        this.log(
            `–ü—Ä–∏–Ω–µ—Å–µ–Ω–æ –≤ –∂–µ—Ä—Ç–≤—É ${amount} ${psykerType.name}. ${successfulSacrifices} —É—Å–ø–µ—à–Ω–æ, ${failedSacrifices} –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ!`,
            'warning'
        );
        this.sounds.warning();
    } else {
        this.log(
            `–ü—Ä–∏–Ω–µ—Å–µ–Ω–æ –≤ –∂–µ—Ä—Ç–≤—É ${amount} ${psykerType.name}. –í—Å–µ –∂–µ—Ä—Ç–≤—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã.`,
            'success'
        );
    }
    
    // –í–∏–∑—É–∞–ª—å–Ω–∞—è –≤—Å–ø—ã—à–∫–∞
    if (this.astronomican.visual && this.astronomican.visual.effects) {
        this.astronomican.visual.effects.flash = {
            active: true,
            intensity: 0.5 + (psykerType.power * amount / 100),
            timer: 30
        };
    }
    
    this.updateUI();
};

// ==================== –î–û–ë–ê–í–õ–ï–ù–ò–ï –ú–û–î–ò–§–ò–ö–ê–¢–û–†–ê ====================
Game.addModifier = function(modifierKey, source) {
    const modifierType = this.modifierTypes[modifierKey];
    if (!modifierType) {
        console.warn(`–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä ${modifierKey} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ stackable
    if (!modifierType.stackable) {
        const existing = this.modifiers.active.find(m => m.key === modifierKey);
        if (existing) {
            // –û–±–Ω–æ–≤–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            existing.duration = modifierType.duration;
            this.log(`–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä "${modifierType.name}" –æ–±–Ω–æ–≤–ª—ë–Ω`, 'info');
            return;
        }
    }
    
    const modifier = {
        key: modifierKey,
        name: modifierType.name,
        description: modifierType.description,
        effects: { ...modifierType.effects },
        duration: modifierType.duration,
        remainingDays: modifierType.duration,
        stackable: modifierType.stackable,
        icon: modifierType.icon,
        source: source || 'unknown',
        addedDay: this.day
    };
    
    this.modifiers.active.push(modifier);
    
    this.log(`${modifier.icon} –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä: ${modifier.name}`, 'info');
    this.notify(`${modifier.icon} ${modifier.name}`, 'info');
    
    // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã
    this.applyModifierEffects(modifier);
    this.updateUI();
};

// ==================== –£–î–ê–õ–ï–ù–ò–ï –ú–û–î–ò–§–ò–ö–ê–¢–û–†–ê ====================
Game.removeModifier = function(modifier) {
    const index = this.modifiers.active.indexOf(modifier);
    if (index === -1) return;
    
    // –û—Ç–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã
    this.reverseModifierEffects(modifier);
    
    // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é
    this.modifiers.history.push({
        ...modifier,
        removedDay: this.day
    });
    
    // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö
    this.modifiers.active.splice(index, 1);
    
    this.log(`–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä "${modifier.name}" –∏—Å—Ç—ë–∫`, 'info');
};

// ==================== –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –≠–§–§–ï–ö–¢–û–í ====================
Game.applyModifierEffects = function(modifier) {
    const effects = modifier.effects;
    
    // –ü—Ä—è–º—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
    if (effects.astronomicPower) {
        this.astronomican.power += effects.astronomicPower;
    }
    if (effects.stability) {
        this.astronomican.stability += effects.stability;
    }
    if (effects.throneCondition) {
        this.astronomican.throneCondition += effects.throneCondition;
    }
    if (effects.warpActivity) {
        this.warp.level += effects.warpActivity;
    }
    
    // –ò–∑–º–µ–Ω–µ–Ω–∏—è –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏
    if (effects.creditsIncome) {
        if (typeof effects.creditsIncome === 'string' && effects.creditsIncome.includes('%')) {
            // –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
            const percent = parseFloat(effects.creditsIncome) / 100;
            this.resourceChanges.credits *= (1 + percent);
        } else {
            // –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
            this.resourceChanges.credits += effects.creditsIncome;
        }
    }
    if (effects.militaryGrowth) {
        this.resourceChanges.military += effects.militaryGrowth;
    }
    if (effects.populationGrowth) {
        this.resourceChanges.population += effects.populationGrowth;
    }
    if (effects.psychicIncome) {
        this.resourceChanges.psychic += effects.psychicIncome;
    }
    if (effects.sacrificeRate) {
        this.astronomican.sacrificeRate += effects.sacrificeRate;
    }
};

// ==================== –û–¢–ú–ï–ù–ê –≠–§–§–ï–ö–¢–û–í ====================
Game.reverseModifierEffects = function(modifier) {
    const effects = modifier.effects;
    
    // –û–±—Ä–∞—Ç–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
    if (effects.creditsIncome) {
        if (typeof effects.creditsIncome === 'string' && effects.creditsIncome.includes('%')) {
            const percent = parseFloat(effects.creditsIncome) / 100;
            this.resourceChanges.credits /= (1 + percent);
        } else {
            this.resourceChanges.credits -= effects.creditsIncome;
        }
    }
    if (effects.militaryGrowth) {
        this.resourceChanges.military -= effects.militaryGrowth;
    }
    if (effects.populationGrowth) {
        this.resourceChanges.population -= effects.populationGrowth;
    }
    if (effects.psychicIncome) {
        this.resourceChanges.psychic -= effects.psychicIncome;
    }
    if (effects.sacrificeRate) {
        this.astronomican.sacrificeRate -= effects.sacrificeRate;
    }
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ú–û–î–ò–§–ò–ö–ê–¢–û–†–û–í ====================
Game.updateModifiers = function() {
    // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
    
    for (let i = this.modifiers.active.length - 1; i >= 0; i--) {
        const modifier = this.modifiers.active[i];
        
        // –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ –∏—Å—Ç–µ–∫–∞—é—Ç
        if (modifier.duration === 0) continue;
        
        modifier.remainingDays--;
        
        if (modifier.remainingDays <= 0) {
            this.removeModifier(modifier);
        }
    }
};

// ==================== –ì–ï–ù–ï–†–ê–¶–ò–Ø –°–õ–£–ß–ê–ô–ù–û–ì–û –ú–û–î–ò–§–ò–ö–ê–¢–û–†–ê ====================
Game.generateRandomModifier = function() {
    const keys = Object.keys(this.modifierTypes);
    const randomKey = keys[Math.floor(Math.random() * keys.length)];
    
    this.addModifier(randomKey, 'random event');
};

// ==================== –°–û–ë–´–¢–ò–ï –ú–û–î–ò–§–ò–ö–ê–¢–û–†–ê ====================
Game.generateModifierEvent = function() {
    // –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∏–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä
    const positiveModifiers = ['divineBlessing', 'efficientSacrifice', 'technologicalBreakthrough', 'imperialRecruitment', 'economicBoom'];
    const negativeModifiers = ['warpFluctuations', 'plague', 'mechanicusDispute', 'psykerShortage'];
    
    const isPositive = Math.random() < 0.5;
    const pool = isPositive ? positiveModifiers : negativeModifiers;
    const modifierKey = pool[Math.floor(Math.random() * pool.length)];
    const modifierType = this.modifierTypes[modifierKey];
    
    const event = {
        title: isPositive ? '–ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞' : '–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞',
        description: `${modifierType.icon} ${modifierType.name}: ${modifierType.description}`,
        choices: [
            {
                text: isPositive ? '–í–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é' : '–°–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π',
                action: () => {
                    this.addModifier(modifierKey, 'event choice');
                }
            }
        ]
    };
    
    if (!isPositive) {
        // –î–ª—è –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
        event.choices.push({
            text: '–ü–æ—Ç—Ä–∞—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å (-5000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
            action: () => {
                if (this.resources.credits >= 5000) {
                    this.resources.credits -= 5000;
                    this.log('–ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∞', 'success');
                } else {
                    this.addModifier(modifierKey, 'event choice - insufficient credits');
                    this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                }
            }
        });
    }
    
    this.showChoiceEvent(event);
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï UI –ú–û–î–ò–§–ò–ö–ê–¢–û–†–û–í ====================
Game.updateModifiersUI = function() {
    const container = document.getElementById('active-modifiers-container');
    if (!container) return;
    
    container.innerHTML = '';
    
    this.modifiers.active.forEach(modifier => {
        const badge = document.createElement('div');
        badge.className = 'modifier-badge';
        
        // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∏–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π
        const isNegative = modifier.description.includes('–ö–æ—Ä—Ä—É–ø—Ü–∏—è') || 
                          modifier.description.includes('–≠–ø–∏–¥–µ–º–∏—è') ||
                          modifier.description.includes('–°–ø–æ—Ä') ||
                          modifier.description.includes('–î–µ—Ñ–∏—Ü–∏—Ç') ||
                          modifier.effects.warpActivity > 0;
        
        badge.classList.add(isNegative ? 'negative' : 'positive');
        
        const durationText = modifier.duration === 0 ? 
            '–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π' : 
            `${modifier.remainingDays} –¥–Ω–µ–π`;
        
        badge.innerHTML = `
            <div class="modifier-header">
                <div>
                    <span class="modifier-icon">${modifier.icon}</span>
                    <strong>${modifier.name}</strong>
                </div>
                <span class="modifier-duration">${durationText}</span>
            </div>
            <div style="font-size: 0.85em; color: #aaa;">
                ${modifier.description}
            </div>
        `;
        
        container.appendChild(badge);
    });
};

// ==================== –ì–ï–ù–ï–†–ê–¶–ò–Ø –°–õ–£–ß–ê–ô–ù–´–• –°–û–ë–´–¢–ò–ô ====================
Game.generateRandomEvent = function() {
    const eventTypes = [
        'sector_crisis',
        'warp_anomaly',
        'enemy_attack',
        'discovery',
        'personnel_event',
        'economic_event',
        'political_event',
        'heresy',
        'xenos_contact',
        'research',
        'diplomatic',
        'internal'
    ];
    
    const eventType = eventTypes[Math.floor(Math.random() * eventTypes.length)];
    
    switch(eventType) {
        case 'sector_crisis':
            this.generateSectorCrisis();
            break;
        case 'warp_anomaly':
            this.generateWarpAnomaly();
            break;
        case 'enemy_attack':
            this.generateEnemyAttack();
            break;
        case 'discovery':
            this.generateDiscovery();
            break;
        case 'personnel_event':
            this.generatePersonnelEvent();
            break;
        case 'economic_event':
            this.generateEconomicEvent();
            break;
        case 'political_event':
            this.generatePoliticalEvent();
            break;
        case 'heresy':
            this.generateHeresyEvent();
            break;
        case 'xenos_contact':
            this.generateXenosContact();
            break;
        case 'research':
            this.generateResearchEvent();
            break;
        case 'diplomatic':
            this.generateDiplomaticEvent();
            break;
        case 'internal':
            this.generateInternalCrisis();
            break;
    }
    
    this.lastEventDay = this.day;
};

// ==================== –ö–†–ò–ó–ò–° –í –°–ï–ö–¢–û–†–ï ====================
Game.generateSectorCrisis = function() {
    const sector = this.sectors.find(s => s.status === 'safe' || s.status === 'threatened');
    if (!sector) return;
    
    const crisisTypes = [
        {
            title: `–í–æ—Å—Å—Ç–∞–Ω–∏–µ –Ω–∞ ${sector.name}`,
            description: `–ü–ª–∞–Ω–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ ${sector.name} –æ—Ö–≤–∞—á–µ–Ω—ã –≤–æ—Å—Å—Ç–∞–Ω–∏–µ–º –ø—Ä–æ—Ç–∏–≤ –≤–ª–∞—Å—Ç–∏ –ò–º–ø–µ—Ä–∏—É–º–∞. –ì—É–±–µ—Ä–Ω–∞—Ç–æ—Ä ${sector.governor} –ø—Ä–æ—Å–∏—Ç –≤–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏.`,
            choices: [
                {
                    text: '–ü–æ–¥–∞–≤–∏—Ç—å —Å–∏–ª–æ–π (2000 –∫—Ä–µ–¥–∏—Ç–æ–≤, -10 –º–ª—Ä–¥ –Ω–∞—Å–µ–ª–µ–Ω–∏—è)',
                    action: () => {
                        if (this.resources.credits >= 2000) {
                            this.resources.credits -= 2000;
                            sector.population -= 10;
                            sector.stability += 30;
                            this.log(`–í–æ—Å—Å—Ç–∞–Ω–∏–µ –≤ ${sector.name} –ø–æ–¥–∞–≤–ª–µ–Ω–æ —Å–∏–ª–æ–π.`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã (1000 –∫—Ä–µ–¥–∏—Ç–æ–≤, –º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)',
                    action: () => {
                        if (this.resources.credits >= 1000) {
                            this.resources.credits -= 1000;
                            sector.stability += 15;
                            this.log(`–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã –≤ ${sector.name} –ø—Ä–∏–Ω–µ—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.`, 'info');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (—Å–µ–∫—Ç–æ—Ä –¥–µ—Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è)',
                    action: () => {
                        sector.stability -= 20;
                        sector.status = 'threatened';
                        this.log(`${sector.name} –ø–æ–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ö–∞–æ—Å.`, 'warning');
                        this.sounds.warning();
                    }
                }
            ]
        },
        {
            title: `–ì–æ–ª–æ–¥ –≤ ${sector.name}`,
            description: `–ù–µ—É—Ä–æ–∂–∞–π –∏ —Ä–∞–∑—Ä—ã–≤ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø—É—Ç–µ–π –ø—Ä–∏–≤–µ–ª–∏ –∫ –º–∞—Å—Å–æ–≤–æ–º—É –≥–æ–ª–æ–¥—É –≤ ${sector.name}. –ú–∏–ª–ª–∏–∞—Ä–¥—ã –∂–∏–∑–Ω–µ–π –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π.`,
            choices: [
                {
                    text: '–ì—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–∞—è –ø–æ–º–æ—â—å (3000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 3000) {
                            this.resources.credits -= 3000;
                            sector.stability += 25;
                            this.log(`–ü–æ–º–æ—â—å —Å–ø–∞—Å–ª–∞ –º–∏–ª–ª–∏–æ–Ω—ã –∂–∏–∑–Ω–µ–π –≤ ${sector.name}.`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å (1000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 1000) {
                            this.resources.credits -= 1000;
                            sector.population -= 15;
                            sector.stability += 10;
                            this.log(`–ß–∞—Å—Ç–∏—á–Ω–∞—è –ø–æ–º–æ—â—å ${sector.name}. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∂–µ—Ä—Ç–≤.`, 'warning');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å (–æ–≥—Ä–æ–º–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏)',
                    action: () => {
                        sector.population -= 30;
                        sector.stability -= 30;
                        this.log(`–ì–æ–ª–æ–¥ –æ–ø—É—Å—Ç–æ—à–∏–ª ${sector.name}.`, 'critical');
                        this.sounds.warning();
                    }
                }
            ]
        },
        {
            title: `–ß—É–º–∞ –≤ ${sector.name}`,
            description: `–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –±–æ–ª–µ–∑–Ω—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –º–∏—Ä–∞–º ${sector.name}. –ï—Å—Ç—å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –≤–∞—Ä–ø-–ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –∑–∞—Ä–∞–∑—ã.`,
            choices: [
                {
                    text: '–ö–∞—Ä–∞–Ω—Ç–∏–Ω –∏ –ª–µ—á–µ–Ω–∏–µ (2500 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 2500) {
                            this.resources.credits -= 2500;
                            sector.population -= 5;
                            sector.stability += 20;
                            this.log(`–ö–∞—Ä–∞–Ω—Ç–∏–Ω –æ—Å—Ç–∞–Ω–æ–≤–∏–ª —á—É–º—É –≤ ${sector.name}.`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–≠–∫—Å—Ç–µ—Ä–º–∏–Ω–∞—Ç—É—Å –∑–∞—Ä–∞–∂—ë–Ω–Ω—ã—Ö –º–∏—Ä–æ–≤ (1000 –∫—Ä–µ–¥–∏—Ç–æ–≤, –æ–≥—Ä–æ–º–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏)',
                    action: () => {
                        if (this.resources.credits >= 1000) {
                            this.resources.credits -= 1000;
                            sector.population -= 25;
                            sector.stability += 15;
                            this.log(`–ó–∞—Ä–∞–∂—ë–Ω–Ω—ã–µ –º–∏—Ä—ã ${sector.name} —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã.`, 'critical');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ü–æ–∑–≤–æ–ª–∏—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–∏—Ç—å—Å—è (–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞)',
                    action: () => {
                        sector.population -= 40;
                        sector.stability -= 40;
                        this.warp.level += 5;
                        this.log(`${sector.name} –æ–ø—É—Å—Ç–æ—à—ë–Ω —á—É–º–æ–π.`, 'critical');
                    }
                }
            ]
        },
        {
            title: `–î–µ–º–æ–Ω–∏—á–µ—Å–∫–∏–µ –∫—É–ª—å—Ç—ã –≤ ${sector.name}`,
            description: `–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ —Å–µ—Ç—å –∫—É–ª—å—Ç–æ–≤ –•–∞–æ—Å–∞ –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö –º–∏—Ä–∞—Ö ${sector.name}. –ï—Ä–µ—Å—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è.`,
            choices: [
                {
                    text: '–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä—Å–∫–∞—è –∑–∞—á–∏—Å—Ç–∫–∞ (3000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 3000) {
                            this.resources.credits -= 3000;
                            sector.stability += 35;
                            this.warp.level -= 5;
                            this.log(`–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è –∏—Å–∫–æ—Ä–µ–Ω–∏–ª–∞ –µ—Ä–µ—Å—å –≤ ${sector.name}.`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–°–µ—Ä—ã–µ –†—ã—Ü–∞—Ä–∏ (5000 –∫—Ä–µ–¥–∏—Ç–æ–≤, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É—Å–ø–µ—Ö)',
                    action: () => {
                        if (this.resources.credits >= 5000) {
                            this.resources.credits -= 5000;
                            sector.stability += 50;
                            this.warp.level -= 10;
                            this.log(`–°–µ—Ä—ã–µ –†—ã—Ü–∞—Ä–∏ —É–Ω–∏—á—Ç–æ–∂–∏–ª–∏ –∫—É–ª—å—Ç—ã –≤ ${sector.name}.`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (–µ—Ä–µ—Å—å —É–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è)',
                    action: () => {
                        sector.stability -= 25;
                        sector.status = 'threatened';
                        this.warp.level += 10;
                        this.log(`–ö—É–ª—å—Ç—ã –•–∞–æ—Å–∞ —É–∫—Ä–µ–ø–∏–ª–∏—Å—å –≤ ${sector.name}.`, 'critical');
                    }
                }
            ]
        },
        {
            title: `–í–æ—Å—Å—Ç–∞–Ω–∏–µ –º–∞—à–∏–Ω –≤ ${sector.name}`,
            description: `–î—Ä–µ–≤–Ω–∏–µ –º–∞—à–∏–Ω—ã —ç–ø–æ—Ö–∏ –¢—ë–º–Ω–æ–π –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏ –Ω–∞—á–∞–ª–∏ –∞—Ç–∞–∫–æ–≤–∞—Ç—å –∏–º–ø–µ—Ä—Å–∫–∏–µ –º–∏—Ä—ã –≤ ${sector.name}.`,
            choices: [
                {
                    text: '–¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü—ã –ú–∞—Ä—Å–∞ (2500 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 2500) {
                            this.resources.credits -= 2500;
                            sector.stability += 30;
                            // –®–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é
                            if (Math.random() < 0.3) {
                                this.resources.credits += 1000;
                                this.log(`–¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏ —Ü–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ ${sector.name}.`, 'success');
                            }
                            this.log(`–ú–∞—à–∏–Ω—ã –≤ ${sector.name} –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã.`, 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò–º–ø–µ—Ä—Å–∫–∞—è –≥–≤–∞—Ä–¥–∏—è (1500 –∫—Ä–µ–¥–∏—Ç–æ–≤, —Ç—è–∂—ë–ª—ã–µ –ø–æ—Ç–µ—Ä–∏)',
                    action: () => {
                        if (this.resources.credits >= 1500) {
                            this.resources.credits -= 1500;
                            sector.population -= 10;
                            sector.stability += 20;
                            this.log(`–ú–∞—à–∏–Ω—ã —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã, –Ω–æ —Ü–µ–Ω–æ–π –±–æ–ª—å—à–∏—Ö –∂–µ—Ä—Ç–≤ –≤ ${sector.name}.`, 'warning');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–≠–∫—Å—Ç–µ—Ä–º–∏–Ω–∞—Ç—É—Å (1000 –∫—Ä–µ–¥–∏—Ç–æ–≤, —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –≤—Å–µ)',
                    action: () => {
                        if (this.resources.credits >= 1000) {
                            this.resources.credits -= 1000;
                            sector.population -= 40;
                            sector.stability = 50; // –°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—É—Å—Ç–æ—à—å
                            this.log(`–ú–∏—Ä—ã ${sector.name} —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã –≤–º–µ—Å—Ç–µ —Å –º–∞—à–∏–Ω–∞–º–∏.`, 'critical');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                }
            ]
        }
    ];
    
    const crisis = crisisTypes[Math.floor(Math.random() * crisisTypes.length)];
    this.showChoiceEvent(crisis);
};

// ==================== –í–ê–†–ü-–ê–ù–û–ú–ê–õ–ò–Ø ====================
Game.generateWarpAnomaly = function() {
    const anomalies = [
        {
            title: '–í–∞—Ä–ø-—Ä–∞–∑–ª–æ–º',
            description: '–û–±–Ω–∞—Ä—É–∂–µ–Ω —Ä–∞—Å—Ç—É—â–∏–π —Ä–∞–∑–ª–æ–º –≤ –≤–∞—Ä–ø–µ. –û–Ω —É–≥—Ä–æ–∂–∞–µ—Ç —Å—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –ø—Ä–æ—Ö–æ–¥–æ–º –¥–ª—è –¥–µ–º–æ–Ω–æ–≤.',
            choices: [
                {
                    text: '–°–µ—Ä—ã–µ –†—ã—Ü–∞—Ä–∏ (5000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 5000) {
                            this.resources.credits -= 5000;
                            this.warp.level -= 10;
                            this.log('–°–µ—Ä—ã–µ –†—ã—Ü–∞—Ä–∏ –∑–∞–ø–µ—á–∞—Ç–∞–ª–∏ —Ä–∞–∑–ª–æ–º.', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ê—Å—Ç—Ä–æ–ø–∞—Ç—ã (2000 –∫—Ä–µ–¥–∏—Ç–æ–≤, 100 –ø—Å–∞–π–∫–µ—Ä–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 2000 && this.resources.psychic >= 100) {
                            this.resources.credits -= 2000;
                            this.resources.psychic -= 100;
                            this.warp.level -= 5;
                            this.log('–ê—Å—Ç—Ä–æ–ø–∞—Ç—ã —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Ä–∞–∑–ª–æ–º.', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (–≤–∞—Ä–ø —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è)',
                    action: () => {
                        this.warp.level += 10;
                        this.log('–í–∞—Ä–ø-—Ä–∞–∑–ª–æ–º —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è!', 'critical');
                    }
                }
            ]
        },
        {
            title: '–ü—Å–∏—Ö–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ',
            description: '–ù–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–ª–∞–Ω–µ—Ç–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–±—É–¥–∏–ª–∏—Å—å —Ç—ã—Å—è—á–∏ –ø—Å–∞–π–∫–µ—Ä–æ–≤. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–º –Ω–∞–¥–≤–∏–≥–∞—é—â–µ–π—Å—è –±–µ–¥—ã.',
            choices: [
                {
                    text: '–°–æ–±—Ä–∞—Ç—å –∏—Ö –¥–ª—è –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞ (+2000 –ø—Å–∞–π–∫–µ—Ä–æ–≤)',
                    action: () => {
                        this.resources.psychic += 2000;
                        this.warp.level += 3;
                        this.log('–ù–æ–≤—ã–µ –ø—Å–∞–π–∫–µ—Ä—ã —Å–æ–±—Ä–∞–Ω—ã.', 'success');
                    }
                },
                {
                    text: '–ó–∞—á–∏—Å—Ç–∫–∞ –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏ (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ –ø–æ—Ç–µ—Ä—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)',
                    action: () => {
                        this.warp.level -= 2;
                        this.log('–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è —É–Ω–∏—á—Ç–æ–∂–∏–ª–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã—Ö –ø—Å–∞–π–∫–µ—Ä–æ–≤.', 'info');
                    }
                }
            ]
        },
        {
            title: '–ö–æ—Ä–∞–±–ª—å-–ø—Ä–∏–∑—Ä–∞–∫',
            description: '–ò–∑ –≤–∞—Ä–ø–∞ –ø–æ—è–≤–∏–ª—Å—è –¥—Ä–µ–≤–Ω–∏–π –∫–æ—Ä–∞–±–ª—å –ò–º–ø–µ—Ä–∏—É–º–∞, –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–π —Ç—ã—Å—è—á–µ–ª–µ—Ç–∏—è –Ω–∞–∑–∞–¥. –ï–≥–æ —ç–∫–∏–ø–∞–∂ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª—Å—è –≤ –Ω–µ–∂–∏—Ç—å.',
            choices: [
                {
                    text: '–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å (500 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 500) {
                            this.resources.credits -= 500;
                            this.log('–ö–æ—Ä–∞–±–ª—å-–ø—Ä–∏–∑—Ä–∞–∫ —É–Ω–∏—á—Ç–æ–∂–µ–Ω.', 'info');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å (—Ä–∏—Å–∫, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã –Ω–∞—Ö–æ–¥–∫–∏)',
                    action: () => {
                        if (Math.random() > 0.5) {
                            this.resources.credits += 2000;
                            this.log('–û–±–Ω–∞—Ä—É–∂–µ–Ω –¥—Ä–µ–≤–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç!', 'success');
                        } else {
                            this.resources.military -= 1;
                            this.warp.level += 5;
                            this.log('–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–¥–≤–µ—Ä–≥–ª–∏—Å—å –≤–∞—Ä–ø-–∑–∞—Ä–∞–∂–µ–Ω–∏—é!', 'critical');
                        }
                    }
                }
            ]
        },
        {
            title: '–≠—Ö–æ –ì–æ—Ä–∞',
            description: '–í–∞—Ä–ø —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç —Å –ø–∞–º—è—Ç—å—é –æ –ï—Ä–µ—Å–∏ –ì–æ—Ä–∞. –î—Ä–µ–≤–Ω–∏–µ —Ä–∞–Ω—ã –≤—Å–µ–ª–µ–Ω–Ω–æ–π –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤–Ω–æ–≤—å.',
            choices: [
                {
                    text: '–ú–∞—Å—Å–æ–≤–æ–µ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–µ (50 –ø—Å–∞–π–∫–µ—Ä–æ–≤)',
                    action: () => {
                        if (this.resources.psykers >= 50) {
                            this.resources.psykers -= 50;
                            this.warp.level -= 15;
                            this.astronomican.efficiency += 10;
                            this.log('–ñ–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–µ —É—Å–ø–æ–∫–æ–∏–ª–æ –≤–∞—Ä–ø.', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Å–∞–π–∫–µ—Ä–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò–∑–æ–ª—è—Ü–∏—è (3000 –∫—Ä–µ–¥–∏—Ç–æ–≤, –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ä–∞)',
                    action: () => {
                        if (this.resources.credits >= 3000) {
                            this.resources.credits -= 3000;
                            this.warp.level -= 5;
                            this.log('–ê–Ω–æ–º–∞–ª–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞.', 'info');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ñ–¥–∞—Ç—å (—Ä–∏—Å–∫ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã)',
                    action: () => {
                        if (Math.random() < 0.7) {
                            this.warp.level += 20;
                            this.astronomican.efficiency -= 15;
                            this.log('–≠—Ö–æ —É—Å–∏–ª–∏–ª–æ—Å—å! –í–∞—Ä–ø –Ω–µ—Å—Ç–∞–±–∏–ª–µ–Ω!', 'critical');
                            this.sounds.warning();
                        } else {
                            this.warp.level -= 5;
                            this.log('–≠—Ö–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ –∑–∞—Ç–∏—Ö–ª–æ.', 'info');
                        }
                    }
                }
            ]
        },
        {
            title: '–¢–µ–Ω—å –≤ –≤–∞—Ä–ø–µ',
            description: '–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –æ–±–Ω–∞—Ä—É–∂–∏–ª –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å –æ–≥—Ä–æ–º–Ω–æ–π —Å–∏–ª—ã –≤ –∏–º–º–∞—Ç–µ—Ä–∏—É–º–µ. –û–Ω–∞ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è.',
            choices: [
                {
                    text: '–£—Å–∏–ª–∏—Ç—å –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω (10000 –∫—Ä–µ–¥–∏—Ç–æ–≤, 100 –ø—Å–∞–π–∫–µ—Ä–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 10000 && this.resources.psykers >= 100) {
                            this.resources.credits -= 10000;
                            this.resources.psykers -= 100;
                            this.astronomican.efficiency += 20;
                            this.warp.level -= 20;
                            this.log('–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –æ—Ç–æ–≥–Ω–∞–ª —Å—É—â–Ω–æ—Å—Ç—å.', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ü—Ä–∏–∑–≤–∞—Ç—å –ø–æ–º–æ—â—å –≠–ª—å–¥–∞—Ä (—Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ)',
                    action: () => {
                        if (Math.random() < 0.5) {
                            this.warp.level -= 15;
                            this.resources.credits -= 2000; // –≠–ª—å–¥–∞—Ä —Ç—Ä–µ–±—É—é—Ç –ø–ª–∞—Ç—É
                            this.log('–≠–ª—å–¥–∞—Ä –ø–æ–º–æ–≥–ª–∏ –æ—Ç—Ä–∞–∑–∏—Ç—å —É–≥—Ä–æ–∑—É... –∑–∞ —Ü–µ–Ω—É.', 'info');
                        } else {
                            this.warp.level += 10;
                            this.log('–≠–ª—å–¥–∞—Ä –ø—Ä–µ–¥–∞–ª–∏ –Ω–∞—Å!', 'critical');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ú–æ–ª–∏—Ç—å—Å—è –ò–º–ø–µ—Ä–∞—Ç–æ—Ä—É',
                    action: () => {
                        if (Math.random() < 0.3) {
                            this.astronomican.efficiency += 25;
                            this.warp.level -= 10;
                            this.log('–ò–º–ø–µ—Ä–∞—Ç–æ—Ä —É—Å–ª—ã—à–∞–ª –º–æ–ª–∏—Ç–≤—ã!', 'success');
                        } else {
                            this.warp.level += 15;
                            this.log('–°—É—â–Ω–æ—Å—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø—Ä–∏–±–ª–∏–∂–∞—Ç—å—Å—è...', 'warning');
                        }
                    }
                }
            ]
        }
    ];
    
    const anomaly = anomalies[Math.floor(Math.random() * anomalies.length)];
    this.showChoiceEvent(anomaly);
};

// ==================== –ê–¢–ê–ö–ê –í–†–ê–ì–û–í ====================
Game.generateEnemyAttack = function() {
    const enemyNames = {
        chaos: '–°–∏–ª—ã –•–∞–æ—Å–∞',
        tyranids: '–§–ª–æ—Ç-—É–ª–µ–π —Ç–∏—Ä–∞–Ω–∏–¥–æ–≤',
        necrons: '–õ–µ–≥–∏–æ–Ω—ã –Ω–µ–∫—Ä–æ–Ω–æ–≤',
        orks: '–û—Ä–æ—á–∏–π –í–∞–∞–∞–≥—Ö!',
        tau: '–≠–∫—Å–ø–µ–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–ª—ã –¢–∞—É',
        eldar: '–ù–∞–ª—ë—Ç—á–∏–∫–∏ —ç–ª—å–¥–∞—Ä'
    };
    
    const enemyType = Object.keys(this.enemies)[Math.floor(Math.random() * Object.keys(this.enemies).length)];
    const enemy = this.enemies[enemyType];
    const sector = this.sectors.find(s => s.status !== 'lost');
    
    if (!sector) return;
    
    this.showChoiceEvent({
        title: `–ê—Ç–∞–∫–∞: ${enemyNames[enemyType]}`,
        description: `${enemyNames[enemyType]} –∞—Ç–∞–∫—É–µ—Ç ${sector.name}! –¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ä–æ—á–Ω–∞—è –≤–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞.`,
        choices: [
            {
                text: '–ü–æ–ª–Ω–æ–µ –≤–æ–µ–Ω–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ (5000 –∫—Ä–µ–¥–∏—Ç–æ–≤, 10 –º–ª–Ω –∞—Ä–º–∏–∏)',
                action: () => {
                    if (this.resources.credits >= 5000 && this.resources.military >= 10) {
                        this.resources.credits -= 5000;
                        this.resources.military -= 10;
                        enemy.strength -= 5;
                        sector.stability += 20;
                        this.stats.enemiesKilled += 300;
                        this.log(`${enemyNames[enemyType]} —Ä–∞–∑–≥—Ä–æ–º–ª–µ–Ω—ã –≤ ${sector.name}!`, 'success');
                    } else {
                        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤!', 'warning');
                        this.sounds.warning();
                    }
                }
            },
            {
                text: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (2000 –∫—Ä–µ–¥–∏—Ç–æ–≤, 5 –º–ª–Ω –∞—Ä–º–∏–∏)',
                action: () => {
                    if (this.resources.credits >= 2000 && this.resources.military >= 5) {
                        this.resources.credits -= 2000;
                        this.resources.military -= 5;
                        sector.stability += 10;
                        this.stats.enemiesKilled += 100;
                        this.log(`–ê—Ç–∞–∫–∞ –≤ ${sector.name} –æ—Ç–±–∏—Ç–∞ —Å –ø–æ—Ç–µ—Ä—è–º–∏.`, 'warning');
                    } else {
                        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤!', 'warning');
                        this.sounds.warning();
                    }
                }
            },
            {
                text: '–ú–µ—Å—Ç–Ω–∞—è –æ–±–æ—Ä–æ–Ω–∞ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–æ–ª—å—à–∏–µ –ø–æ—Ç–µ—Ä–∏)',
                action: () => {
                    sector.stability -= 15;
                    sector.population -= 10;
                    sector.military -= 3;
                    this.log(`${sector.name} —Å–∏–ª—å–Ω–æ –ø–æ—Å—Ç—Ä–∞–¥–∞–ª –æ—Ç –∞—Ç–∞–∫–∏.`, 'critical');
                }
            }
        ]
    });
};

// ==================== –û–¢–ö–†–´–¢–ò–Ø ====================
Game.generateDiscovery = function() {
    const discoveries = [
        {
            title: '–§—Ä–∞–≥–º–µ–Ω—Ç –®–¢–ö',
            description: '–ê—Ä—Ö–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —ç–∫—Å–ø–µ–¥–∏—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –®–∞–±–ª–æ–Ω–∞ –ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏—è!',
            choices: [
                {
                    text: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ',
                    action: () => {
                        this.resources.credits += 5000;
                        this.resourceChanges.credits += 50;
                        this.log('–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —á–µ—Ä—Ç–µ–∂–∏ —É–ª—É—á—à–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π!', 'success');
                    }
                }
            ]
        },
        {
            title: '–ú–∏—Ä-—Ç–∞–π–Ω–∏–∫',
            description: '–û–±–Ω–∞—Ä—É–∂–µ–Ω –∑–∞–±—ã—Ç—ã–π –∏–º–ø–µ—Ä—Å–∫–∏–π –º–∏—Ä-—Ç–∞–π–Ω–∏–∫ —Å –æ–≥—Ä–æ–º–Ω—ã–º–∏ –∑–∞–ø–∞—Å–∞–º–∏.',
            choices: [
                {
                    text: '–ó–∞–±—Ä–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã (+10000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        this.resources.credits += 10000;
                        this.log('–†–µ—Å—É—Ä—Å—ã –º–∏—Ä–∞-—Ç–∞–π–Ω–∏–∫–∞ –∏–∑—ä—è—Ç—ã!', 'success');
                    }
                }
            ]
        },
        {
            title: '–î—Ä–µ–≤–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç',
            description: '–ù–∞–π–¥–µ–Ω –∑–∞–≥–∞–¥–æ—á–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è.',
            choices: [
                {
                    text: '–ò–∑—É—á–∏—Ç—å (–≤–æ–∑–º–æ–∂–Ω—ã –±–æ–Ω—É—Å—ã)',
                    action: () => {
                        const outcomes = [
                            () => {
                                this.astronomican.efficiency += 10;
                                this.log('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç —É—Å–∏–ª–∏–ª –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω!', 'success');
                            },
                            () => {
                                this.warp.level += 10;
                                this.log('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç –æ–∫–∞–∑–∞–ª—Å—è –≤–∞—Ä–ø-–∑–∞—Ä–∞–∂—ë–Ω–Ω—ã–º!', 'critical');
                                this.sounds.warning();
                            },
                            () => {
                                this.resources.credits += 3000;
                                this.log('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç –ø—Ä–æ–¥–∞–Ω –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–∞–º.', 'info');
                            }
                        ];
                        outcomes[Math.floor(Math.random() * outcomes.length)]();
                    }
                },
                {
                    text: '–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å (–±–µ–∑–æ–ø–∞—Å–Ω–æ)',
                    action: () => {
                        this.log('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç —É–Ω–∏—á—Ç–æ–∂–µ–Ω –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏.', 'info');
                    }
                }
            ]
        }
    ];
    
    const discovery = discoveries[Math.floor(Math.random() * discoveries.length)];
    this.showChoiceEvent(discovery);
};

// ==================== –°–û–ë–´–¢–ò–Ø –ü–ï–†–°–û–ù–ê–õ–ê ====================
Game.generatePersonnelEvent = function() {
    const events = [
        {
            title: '–ù–æ–≤—ã–π —Ç–∞–ª–∞–Ω—Ç–ª–∏–≤—ã–π –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä',
            description: '–ú–æ–ª–æ–¥–æ–π –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –ø—Ä–æ—Å–∏—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –≤–∞—à–µ–π —Å–ª—É–∂–±–µ. –û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª—å—à–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª.',
            choices: [
                {
                    text: '–ü—Ä–∏–Ω—è—Ç—å (1500 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 1500) {
                            this.resources.credits -= 1500;
                            this.changeReputation('inquisition', 5, '–ù–∞–π–º –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä–∞');
                            this.personnel.inquisitors.push({
                                id: this.personnel.inquisitors.length + 1,
                                name: '–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä ' + this.generateGovernorName(),
                                ordo: ['–ö—Å–µ–Ω–æ—Å', '–ï—Ä–µ—Ç–∏–∫—É—Å', '–ú–∞–ª–ª–µ—É—Å'][Math.floor(Math.random() * 3)],
                                level: 5,
                                experience: 0,
                                status: 'available',
                                missions: 0,
                                kills: 0
                            });
                            this.log('–ù–æ–≤—ã–π –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è!', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–û—Ç–∫–∞–∑–∞—Ç—å',
                    action: () => {
                        this.log('–ò–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –¥—Ä—É–≥–æ–π —Å–µ–∫—Ç–æ—Ä.', 'info');
                    }
                }
            ]
        },
        {
            title: '–¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É—Å–ª—É–≥–∏',
            description: '–û–ø—ã—Ç–Ω—ã–π –º–∞–≥–æ—Å –ê–¥–µ–ø—Ç—É—Å –ú–µ—Ö–∞–Ω–∏–∫—É—Å –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–≤–æ–∏ —É—Å–ª—É–≥–∏.',
            choices: [
                {
                    text: '–ù–∞–Ω—è—Ç—å (2000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 2000) {
                            this.resources.credits -= 2000;
                            this.resources.techpriests += 1;
                            this.resourceChanges.credits += 20;
                            this.changeReputation('mechanicus', 5, '–ù–∞–π–º —Ç–µ—Ö–Ω–æ–∂—Ä–µ—Ü–∞');
                            this.log('–ù–æ–≤—ã–π —Ç–µ—Ö–Ω–æ–∂—Ä–µ—Ü —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ!', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–û—Ç–∫–∞–∑–∞—Ç—å',
                    action: () => {
                        this.log('–ú–∞–≥–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –∫—É–∑–Ω–∏ –ú–∞—Ä—Å–∞.', 'info');
                    }
                }
            ]
        },
        {
            title: '–ì–µ—Ä–æ–π –≤–µ—Ä–Ω—É–ª—Å—è –∏–∑ –∫—Ä–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∞',
            description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –≥–µ–Ω–µ—Ä–∞–ª –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ–ª–≥–æ–≥–æ –∫—Ä–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∞ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–≤–æ–∏ —É—Å–ª—É–≥–∏.',
            choices: [
                {
                    text: '–ü—Ä–∏–Ω—è—Ç—å –≤ –∫–æ–º–∞–Ω–¥–æ–≤–∞–Ω–∏–µ (3000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 3000) {
                            this.resources.credits -= 3000;
                            this.resourceChanges.military += 1;
                            this.log('–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –≥–µ–Ω–µ—Ä–∞–ª –ø–æ–≤—ã—à–∞–µ—Ç –±–æ–µ–≤–æ–π –¥—É—Ö!', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π —Ñ—Ä–æ–Ω—Ç',
                    action: () => {
                        this.log('–ì–µ–Ω–µ—Ä–∞–ª –Ω–∞–∑–Ω–∞—á–µ–Ω –≤ –¥—Ä—É–≥–æ–π —Å–µ–∫—Ç–æ—Ä.', 'info');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –ü–†–ò–ë–´–¢–ò–ï –ß–Å–†–ù–û–ì–û –ö–û–†–ê–ë–õ–Ø ====================
Game.generateBlackShipArrival = function() {
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–∏–∏ –ø—Å–∞–π–∫–µ—Ä–æ–≤
    const batchSize = 800 + Math.floor(Math.random() * 400); // 800-1200 –ø—Å–∞–π–∫–µ—Ä–æ–≤
    const psykerBatch = {
        total: batchSize,
        alpha: 0,
        beta: 0,
        gamma: 0,
        delta: 0
    };
    
    // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
    for (let i = 0; i < batchSize; i++) {
        const roll = Math.random();
        if (roll < this.psykerTypes.alpha.rarity) {
            psykerBatch.alpha++;
        } else if (roll < this.psykerTypes.alpha.rarity + this.psykerTypes.beta.rarity) {
            psykerBatch.beta++;
        } else if (roll < this.psykerTypes.alpha.rarity + this.psykerTypes.beta.rarity + this.psykerTypes.gamma.rarity) {
            psykerBatch.gamma++;
        } else {
            psykerBatch.delta++;
        }
    }
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –º–∞—Å—Å—É (–¥–µ–ª—å—Ç–∞ –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≥–∞–º–º–∞)
    const autoSacrifice = psykerBatch.delta + Math.floor(psykerBatch.gamma * 0.7);
    this.resources.psychic += autoSacrifice;
    this.psykerPool.delta += psykerBatch.delta;
    this.psykerPool.gamma += Math.floor(psykerBatch.gamma * 0.7);
    
    // –û—Å–æ–±—ã–µ –ø—Å–∞–π–∫–µ—Ä—ã —Ç—Ä–µ–±—É—é—Ç —Ä–µ—à–µ–Ω–∏—è
    const specialPsykers = {
        alpha: psykerBatch.alpha,
        beta: psykerBatch.beta,
        gamma: Math.ceil(psykerBatch.gamma * 0.3)
    };
    
    const hasSpecial = specialPsykers.alpha > 0 || specialPsykers.beta > 0 || specialPsykers.gamma > 5;
    
    if (!hasSpecial) {
        // –û–±—ã—á–Ω–∞—è –ø–∞—Ä—Ç–∏—è –±–µ–∑ –æ—Å–æ–±—ã—Ö –ø—Å–∞–π–∫–µ—Ä–æ–≤
        this.log(`‚ö´ –ß—ë—Ä–Ω—ã–π –ö–æ—Ä–∞–±–ª—å –ø—Ä–∏–±—ã–ª —Å ${batchSize} –ø—Å–∞–π–∫–µ—Ä–∞–º–∏. –í—Å–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∫ –¢—Ä–æ–Ω—É.`, 'info');
        this.blackShips.lastArrival = this.day;
        this.blackShips.nextArrival = this.day + this.blackShips.interval + Math.floor(Math.random() * 10);
        return;
    }
    
    // –°–æ–±—ã—Ç–∏–µ —Å –≤—ã–±–æ—Ä–æ–º –¥–ª—è –æ—Å–æ–±—ã—Ö –ø—Å–∞–π–∫–µ—Ä–æ–≤
    const event = {
        title: '‚ö´ –ü—Ä–∏–±—ã—Ç–∏–µ –ß—ë—Ä–Ω–æ–≥–æ –ö–æ—Ä–∞–±–ª—è',
        description: `
            –ß—ë—Ä–Ω—ã–π –ö–æ—Ä–∞–±–ª—å –¥–æ—Å—Ç–∞–≤–∏–ª –ø–∞—Ä—Ç–∏—é –∏–∑ ${batchSize} –ø—Å–∞–π–∫–µ—Ä–æ–≤ –∏–∑ –õ–∏–≥–∏ –ß—ë—Ä–Ω—ã—Ö –ö–æ—Ä–∞–±–ª–µ–π.
            –û—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ —É–∂–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫ –ó–æ–ª–æ—Ç–æ–º—É –¢—Ä–æ–Ω—É.
            
            –û–¥–Ω–∞–∫–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—Å–æ–±—ã–µ –ø—Å–∞–π–∫–µ—Ä—ã, —Ç—Ä–µ–±—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è:
            ${specialPsykers.alpha > 0 ? `\nüî• ${specialPsykers.alpha} –ê–ª—å—Ñ–∞-–ø—Å–∞–π–∫–µ—Ä(–æ–≤) - –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–π —Å–∏–ª—ã` : ''}
            ${specialPsykers.beta > 0 ? `\n‚ö° ${specialPsykers.beta} –ë–µ—Ç–∞-–ø—Å–∞–π–∫–µ—Ä(–æ–≤) - –≤—ã—Å–æ–∫–æ–π —Å–∏–ª—ã` : ''}
            ${specialPsykers.gamma > 5 ? `\n‚ú® ${specialPsykers.gamma} –ì–∞–º–º–∞-–ø—Å–∞–π–∫–µ—Ä(–æ–≤) - –æ—Ç–±–æ—Ä–Ω—ã–µ` : ''}
        `,
        choices: []
    };
    
    // –í—ã–±–æ—Ä 1: –í—Å–µ –∫ –¢—Ä–æ–Ω—É
    event.choices.push({
        text: '–í—Å–µ—Ö –∫ –ó–æ–ª–æ—Ç–æ–º—É –¢—Ä–æ–Ω—É (—É—Å–∏–ª–µ–Ω–∏–µ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞)',
        action: () => {
            this.resources.psychic += specialPsykers.alpha + specialPsykers.beta + specialPsykers.gamma;
            this.psykerPool.alpha += specialPsykers.alpha;
            this.psykerPool.beta += specialPsykers.beta;
            this.psykerPool.gamma += specialPsykers.gamma;
            
            const powerBonus = specialPsykers.alpha * 2 + specialPsykers.beta * 1 + specialPsykers.gamma * 0.3;
            this.astronomican.efficiency += powerBonus;
            
            this.log(`–í—Å–µ –æ—Å–æ–±—ã–µ –ø—Å–∞–π–∫–µ—Ä—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –∫ –¢—Ä–æ–Ω—É. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å +${powerBonus.toFixed(1)}%`, 'success');
            
            this.blackShips.lastArrival = this.day;
            this.blackShips.nextArrival = this.day + this.blackShips.interval + Math.floor(Math.random() * 10);
        }
    });
    
    // –í—ã–±–æ—Ä 2: –ü–µ—Ä–µ–¥–∞—Ç—å –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏
    if (specialPsykers.alpha > 0 || specialPsykers.beta > 0) {
        const inquisitionReward = 
            specialPsykers.alpha * this.psykerTypes.alpha.inquisitionValue +
            specialPsykers.beta * this.psykerTypes.beta.inquisitionValue +
            specialPsykers.gamma * this.psykerTypes.gamma.inquisitionValue;
        
        event.choices.push({
            text: `–ü–µ—Ä–µ–¥–∞—Ç—å –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏ (${inquisitionReward} –∫—Ä–µ–¥–∏—Ç–æ–≤, —Å–Ω–∏–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑—ã –•–∞–æ—Å–∞)`,
            action: () => {
                this.resources.credits += inquisitionReward;
                this.warp.level -= 5;
                
                // –û—Å—Ç–∞–≤—à–∏–µ—Å—è —Å–ª–∞–±—ã–µ –∫ –¢—Ä–æ–Ω—É
                this.resources.psychic += specialPsykers.gamma;
                this.psykerPool.gamma += specialPsykers.gamma;
                
                this.log(`–û—Å–æ–±—ã–µ –ø—Å–∞–π–∫–µ—Ä—ã –ø–µ—Ä–µ–¥–∞–Ω—ã –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏. –ü–æ–ª—É—á–µ–Ω–æ ${inquisitionReward} –∫—Ä–µ–¥–∏—Ç–æ–≤.`, 'info');
                
                this.blackShips.lastArrival = this.day;
                this.blackShips.nextArrival = this.day + this.blackShips.interval + Math.floor(Math.random() * 10);
            }
        });
    }
    
    // –í—ã–±–æ—Ä 3: –ü–µ—Ä–µ–¥–∞—Ç—å –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç—É
    if (specialPsykers.alpha > 0 || specialPsykers.beta > 0) {
        const astartesReward = 
            specialPsykers.alpha * this.psykerTypes.alpha.astartesValue +
            specialPsykers.beta * this.psykerTypes.beta.astartesValue +
            Math.floor(specialPsykers.gamma * 0.5) * this.psykerTypes.gamma.astartesValue;
        
        event.choices.push({
            text: `–ü–µ—Ä–µ–¥–∞—Ç—å –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç—É (${astartesReward} –∫—Ä–µ–¥–∏—Ç–æ–≤, —É–ª—É—á—à–µ–Ω–∏–µ –≤–æ–µ–Ω–Ω–æ–π –º–æ—â–∏)`,
            action: () => {
                this.resources.credits += astartesReward;
                this.resources.military += 5;
                
                // –ü–æ–ª–æ–≤–∏–Ω—É —Å–ª–∞–±—ã—Ö –∫ –¢—Ä–æ–Ω—É
                const toThrone = Math.ceil(specialPsykers.gamma * 0.5);
                this.resources.psychic += toThrone;
                this.psykerPool.gamma += toThrone;
                
                this.log(`–°–∏–ª—å–Ω—ã–µ –ø—Å–∞–π–∫–µ—Ä—ã –ø–µ—Ä–µ–¥–∞–Ω—ã –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ë–∏–±–ª–∏–∞—Ä–∏–µ–≤. –ü–æ–ª—É—á–µ–Ω–æ ${astartesReward} –∫—Ä–µ–¥–∏—Ç–æ–≤.`, 'info');
                
                this.blackShips.lastArrival = this.day;
                this.blackShips.nextArrival = this.day + this.blackShips.interval + Math.floor(Math.random() * 10);
            }
        });
    }
    
    this.showChoiceEvent(event);
};

// ==================== –≠–ö–û–ù–û–ú–ò–ß–ï–°–ö–ò–ï –°–û–ë–´–¢–ò–Ø ====================
Game.generateEconomicEvent = function() {
    const events = [
        {
            title: '–¢–æ—Ä–≥–æ–≤—ã–π –±—É–º',
            description: '–ù–æ–≤—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã! –≠–∫–æ–Ω–æ–º–∏–∫–∞ –ø—Ä–æ—Ü–≤–µ—Ç–∞–µ—Ç.',
            choices: [
                {
                    text: '–í–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é',
                    action: () => {
                        this.resourceChanges.credits += 100;
                        this.log('–î–æ—Ö–æ–¥ –ò–º–ø–µ—Ä–∏—É–º–∞ —É–≤–µ–ª–∏—á–µ–Ω!', 'success');
                    }
                }
            ]
        },
        {
            title: '–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –∫—Ä–∏–∑–∏—Å',
            description: '–ù–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–∏—Ä–æ–≤ —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –∫–æ–ª–ª–∞–ø—Å–æ–º.',
            choices: [
                {
                    text: '–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–æ–º–æ—â—å (5000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 5000) {
                            this.resources.credits -= 5000;
                            this.resourceChanges.credits += 50;
                            this.log('–≠–∫–æ–Ω–æ–º–∏–∫–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞.', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ü–æ–∑–≤–æ–ª–∏—Ç—å —Ä—ã–Ω–∫—É —Å–∞–º–æ–º—É —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è',
                    action: () => {
                        this.resourceChanges.credits -= 30;
                        this.log('–î–æ—Ö–æ–¥ —Å–Ω–∏–∂–µ–Ω –∏–∑-–∑–∞ –∫—Ä–∏–∑–∏—Å–∞.', 'warning');
                        this.sounds.warning();
                    }
                }
            ]
        },
        {
            title: '–ö—Ä—É–ø–Ω–æ–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ',
            description: '–ë–æ–≥–∞—Ç—ã–π –º–∏—Ä-–∫—É–∑–Ω–∏—Ü–∞ –¥–µ–ª–∞–µ—Ç —â–µ–¥—Ä–æ–µ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ –ò–º–ø–µ—Ä–∏—É–º—É.',
            choices: [
                {
                    text: '–ü—Ä–∏–Ω—è—Ç—å (+8000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        this.resources.credits += 8000;
                        this.log('–ö–∞–∑–Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∞!', 'success');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –ü–û–õ–ò–¢–ò–ß–ï–°–ö–ò–ï –°–û–ë–´–¢–ò–Ø ====================
Game.generatePoliticalEvent = function() {
    const events = [
        {
            title: '–†–∞—Å–∫–æ–ª –≤ –°–µ–Ω–∞—Ç—É–º –ò–º–ø–µ—Ä–∏–∞–ª–∏—Å',
            description: '–í—ã—Å—à–∏–µ –ª–æ—Ä–¥—ã –¢–µ—Ä—Ä—ã —Ä–∞–∑–¥–µ–ª–∏–ª–∏—Å—å –ø–æ –∫–ª—é—á–µ–≤–æ–º—É –≤–æ–ø—Ä–æ—Å—É. –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∞—à–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ.',
            choices: [
                {
                    text: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–æ—Ä–æ–≤',
                    action: () => {
                        this.astronomican.efficiency -= 5;
                        this.resourceChanges.credits += 30;
                        this.log('–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–æ—Ä—ã —É—Å–∏–ª–∏–ª–∏ —Å–≤–æ–∏ –ø–æ–∑–∏—Ü–∏–∏.', 'info');
                    }
                },
                {
                    text: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä–µ—Ñ–æ—Ä–º–∞—Ç–æ—Ä–æ–≤',
                    action: () => {
                        this.astronomican.efficiency += 5;
                        this.warp.level += 5;
                        this.log('–†–µ—Ñ–æ—Ä–º—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–º–µ–Ω–∞–º.', 'warning');
                    }
                },
                {
                    text: '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ–π—Ç—Ä–∞–ª–∏—Ç–µ—Ç',
                    action: () => {
                        this.log('–†–∞—Å–∫–æ–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –±–µ–∑ –≤–∞—à–µ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞.', 'info');
                    }
                }
            ]
        },
        {
            title: '–ó–∞–ø—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ–Ω–æ–º–∏—é',
            description: '–ë–æ–≥–∞—Ç—ã–π –∏ –º–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ–∫—Ç–æ—Ä —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ–π –∞–≤—Ç–æ–Ω–æ–º–∏–∏ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –≤–ª–∞—Å—Ç–∏.',
            choices: [
                {
                    text: '–û—Ç–∫–∞–∑–∞—Ç—å (—Ä–∏—Å–∫ –≤–æ—Å—Å—Ç–∞–Ω–∏—è)',
                    action: () => {
                        const sector = this.sectors.find(s => s.status === 'safe');
                        if (sector) sector.stability -= 10;
                        this.log('–ó–∞–ø—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ–Ω–æ–º–∏—é –æ—Ç–∫–ª–æ–Ω—ë–Ω.', 'warning');
                    }
                },
                {
                    text: '–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –∞–≤—Ç–æ–Ω–æ–º–∏—é',
                    action: () => {
                        this.resourceChanges.credits -= 20;
                        this.log('–ö–æ–º–ø—Ä–æ–º–∏—Å—Å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç.', 'info');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –°–û–ë–´–¢–ò–Ø –ï–†–ï–°–ò ====================
Game.generateHeresyEvent = function() {
    const events = [
        {
            title: '–ö—É–ª—å—Ç –•–∞–æ—Å–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω',
            description: '–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è —Ä–∞—Å–∫—Ä—ã–ª–∞ –∫—Ä—É–ø–Ω—ã–π –∫—É–ª—å—Ç –•–∞–æ—Å–∞ –Ω–∞ –æ–¥–Ω–æ–º –∏–∑ —É–ª—å–µ–≤—ã—Ö –º–∏—Ä–æ–≤.',
            choices: [
                {
                    text: '–ú–∞—Å—Å–æ–≤–∞—è –∑–∞—á–∏—Å—Ç–∫–∞ (1500 –∫—Ä–µ–¥–∏—Ç–æ–≤, -5 –º–ª—Ä–¥ –Ω–∞—Å–µ–ª–µ–Ω–∏—è)',
                    action: () => {
                        if (this.resources.credits >= 1500) {
                            this.resources.credits -= 1500;
                            this.resources.population -= 5;
                            this.warp.level -= 8;
                            this.log('–ö—É–ª—å—Ç –•–∞–æ—Å–∞ –∏—Å–∫–æ—Ä–µ–Ω—ë–Ω.', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–¢–æ—á–µ—á–Ω—ã–µ —É–¥–∞—Ä—ã –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏ (500 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 500) {
                            this.resources.credits -= 500;
                            this.warp.level -= 3;
                            this.log('–õ–∏–¥–µ—Ä—ã –∫—É–ª—å—Ç–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω—ã.', 'info');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
                            this.sounds.warning();
                        }
                    }
                },
                {
                    text: '–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (–∫—É–ª—å—Ç —Ä–∞—Å—Ç—ë—Ç)',
                    action: () => {
                        this.warp.level += 10;
                        this.log('–ö—É–ª—å—Ç –•–∞–æ—Å–∞ –Ω–∞–±–∏—Ä–∞–µ—Ç —Å–∏–ª—É!', 'critical');
                    }
                }
            ]
        },
        {
            title: '–ì—É–±–µ—Ä–Ω–∞—Ç–æ—Ä –æ–±–≤–∏–Ω—ë–Ω –≤ –µ—Ä–µ—Å–∏',
            description: '–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è –ø—Ä–µ–¥—ä—è–≤–∏–ª–∞ –æ–±–≤–∏–Ω–µ–Ω–∏—è –≤ –µ—Ä–µ—Å–∏ –ø–ª–∞–Ω–µ—Ç–∞—Ä–Ω–æ–º—É –≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä—É.',
            choices: [
                {
                    text: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ò–Ω–∫–≤–∏–∑–∏—Ü–∏—é',
                    action: () => {
                        const sector = this.sectors.find(s => s.status !== 'lost');
                        if (sector) {
                            sector.governor = this.generateGovernorName();
                            sector.stability -= 5;
                        }
                        this.warp.level -= 5;
                        this.log('–ï—Ä–µ—Ç–∏–∫-–≥—É–±–µ—Ä–Ω–∞—Ç–æ—Ä –∫–∞–∑–Ω—ë–Ω.', 'success');
                    }
                },
                {
                    text: '–ü–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤',
                    action: () => {
                        if (Math.random() > 0.5) {
                            this.log('–û–±–≤–∏–Ω–µ–Ω–∏—è –æ–∫–∞–∑–∞–ª–∏—Å—å –ª–æ–∂–Ω—ã–º–∏.', 'info');
                        } else {
                            this.warp.level += 5;
                            this.log('–ï—Ä–µ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!', 'critical');
                            this.sounds.warning();
                        }
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –ö–û–ù–¢–ê–ö–¢ –° –ö–°–ï–ù–û–°–ê–ú–ò ====================
Game.generateXenosContact = function() {
    const events = [
        {
            title: '–ü–æ—Å–ª–∞–Ω–Ω–∏–∫ –≠–ª—å–¥–∞—Ä',
            description: '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞—Ä—Å–∏—Ä —ç–ª—å–¥–∞—Ä –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–∞–¥–≤–∏–≥–∞—é—â–µ–π—Å—è –æ–ø–∞—Å–Ω–æ—Å—Ç–∏.',
            choices: [
                {
                    text: '–í—ã—Å–ª—É—à–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ',
                    action: () => {
                        this.warp.level -= 5;
                        this.log('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —ç–ª—å–¥–∞—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º.', 'info');
                    }
                },
                {
                    text: '–ê—Ä–µ—Å—Ç–æ–≤–∞—Ç—å –∫—Å–µ–Ω–æ—Å–∞',
                    action: () => {
                        this.log('–≠–ª—å–¥–∞—Ä –∏—Å—á–µ–∑ –ø—Ä–µ–∂–¥–µ —á–µ–º –µ–≥–æ —Å—Ö–≤–∞—Ç–∏–ª–∏.', 'warning');
                        this.sounds.warning();
                    }
                }
            ]
        },
        {
            title: '–¢–æ—Ä–≥–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¢–∞—É',
            description: '–ò–º–ø–µ—Ä–∏—è –¢–∞—É –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ç–æ—Ä–≥–æ–≤–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ.',
            choices: [
                {
                    text: '–û—Ç–∫–∞–∑–∞—Ç—å (–≤–µ—Ä–Ω–æ—Å—Ç—å –ò–º–ø–µ—Ä–∞—Ç–æ—Ä—É)',
                    action: () => {
                        this.log('–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∫—Å–µ–Ω–æ—Å–æ–≤ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–æ.', 'info');
                    }
                },
                {
                    text: '–¢–∞–π–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è (—Ä–∏—Å–∫, –Ω–æ –ø—Ä–∏–±—ã–ª—å)',
                    action: () => {
                        if (Math.random() > 0.3) {
                            this.resources.credits += 3000;
                            this.log('–¢–∞–π–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è —Å –¢–∞—É –ø—Ä–∏–Ω–æ—Å–∏—Ç –ø—Ä–∏–±—ã–ª—å.', 'success');
                        } else {
                            this.warp.level += 5;
                            this.log('–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ —Å–¥–µ–ª–∫—É —Å –∫—Å–µ–Ω–æ—Å–∞–º–∏!', 'critical');
                            this.sounds.warning();
                        }
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –°–û–ë–´–¢–ò–Ø –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ô ====================
Game.generateResearchEvent = function() {
    const events = [
        {
            title: '–ê—Ä—Ö–µ–æ—Ç–µ—Ö-–Ω–∞—Ö–æ–¥–∫–∞',
            description: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —ç–∫—Å–ø–µ–¥–∏—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ –¥—Ä–µ–≤–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –¢—ë–º–Ω–æ–π –≠—Ä—ã –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π.',
            choices: [
                {
                    text: '–ò–∑—É—á–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ (—Ä–∏—Å–∫ –∑–∞—Ä–∞–∂–µ–Ω–∏—è)',
                    action: () => {
                        if (Math.random() < 0.7) {
                            this.resources.credits += 10000;
                            this.astronomican.efficiency += 5;
                            this.log('–ê—Ä—Ö–µ–æ—Ç–µ—Ö —É—Å–ø–µ—à–Ω–æ –∏–∑—É—á–µ–Ω!', 'success');
                        } else {
                            this.warp.level += 15;
                            this.log('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç –æ–∫–∞–∑–∞–ª—Å—è –≤–∞—Ä–ø-–∑–∞—Ä–∞–∂—ë–Ω–Ω—ã–º!', 'critical');
                        }
                    }
                },
                {
                    text: '–ü–µ—Ä–µ–¥–∞—Ç—å –ú–µ—Ö–∞–Ω–∏–∫—É—Å—É (–±–µ–∑–æ–ø–∞—Å–Ω–æ, -5000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 5000) {
                            this.resources.credits -= 5000;
                            this.astronomican.throneCondition += 10;
                            this.changeReputation('mechanicus', 10, '–ü–µ—Ä–µ–¥–∞—á–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞');
                            this.log('–ú–µ—Ö–∞–Ω–∏–∫—É—Å –∏–∑—É—á–∏–ª –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤', 'warning');
                        }
                    }
                },
                {
                    text: '–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏',
                    action: () => {
                        this.log('–ê—Ä—Ç–µ—Ñ–∞–∫—Ç —É–Ω–∏—á—Ç–æ–∂–µ–Ω', 'info');
                    }
                }
            ]
        },
        {
            title: '–ü—Ä–æ—Ä—ã–≤ –≤ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤–∞—Ä–ø-–¥–≤–∏–≥–∞—Ç–µ–ª–µ–π',
            description: '–ú–∞–≥–æ—Å –æ—Ç–∫—Ä—ã–ª –Ω–æ–≤—É—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤–∞—Ä–ø-–¥–≤–∏–≥–∞—Ç–µ–ª—è, –Ω–æ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —Ç—Ä–µ–±—É—é—Ç—Å—è —Ä–µ—Å—É—Ä—Å—ã.',
            choices: [
                {
                    text: '–í–Ω–µ–¥—Ä–∏—Ç—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é (-15000 –∫—Ä–µ–¥–∏—Ç–æ–≤, +50 —Ñ–ª–æ—Ç)',
                    action: () => {
                        if (this.resources.credits >= 15000) {
                            this.resources.credits -= 15000;
                            this.resources.fleet += 50;
                            this.resourceChanges.fleet += 2;
                            this.log('–ù–æ–≤–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∞!', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤', 'warning');
                        }
                    }
                },
                {
                    text: '–û—Ç–∫–ª–æ–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
                    action: () => {
                        this.log('–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ', 'info');
                    }
                }
            ]
        },
        {
            title: '–ù–∞—Ö–æ–¥–∫–∞ –®–¢–ö-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞',
            description: '–û–±–Ω–∞—Ä—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –®–∞–±–ª–æ–Ω –ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –±–æ–µ–ø—Ä–∏–ø–∞—Å–æ–≤.',
            choices: [
                {
                    text: '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ',
                    action: () => {
                        this.resourceChanges.military += 5;
                        this.resourceChanges.credits += 500;
                        this.log('–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –±–æ–µ–ø—Ä–∏–ø–∞—Å–æ–≤ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ!', 'success');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –î–ò–ü–õ–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –°–û–ë–´–¢–ò–Ø ====================
Game.generateDiplomaticEvent = function() {
    const events = [
        {
            title: '–≠–ª—å–¥–∞—Ä –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–æ—é–∑',
            description: '–§–∞—Ä—Å–∏—Ä —Å –∫–æ—Ä–∞–±–ª—è-–º–∏—Ä–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–∞–¥–≤–∏–≥–∞—é—â–µ–π—Å—è —É–≥—Ä–æ–∑–µ –¢–∏—Ä–∞–Ω–∏–¥–æ–≤ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ.',
            choices: [
                {
                    text: '–ü—Ä–∏–Ω—è—Ç—å —Å–æ—é–∑ (—Ä–∏—Å–∫ –æ—Å—É–∂–¥–µ–Ω–∏—è –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏)',
                    action: () => {
                        // –î–æ–±–∞–≤–∏–º —Ä–µ–ø—É—Ç–∞—Ü–∏—é –ø–æ–∑–∂–µ –≤ —Å–µ–∫—Ü–∏–∏ 3
                        this.warp.level -= 10;
                        this.resources.military += 20;
                        this.log('–í—Ä–µ–º–µ–Ω–Ω—ã–π —Å–æ—é–∑ —Å –≠–ª—å–¥–∞—Ä –∑–∞–∫–ª—é—á—ë–Ω', 'info');
                    }
                },
                {
                    text: '–û—Ç–∫–∞–∑–∞—Ç—å –∫—Å–µ–Ω–æ—Å–∞–º',
                    action: () => {
                        this.log('–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≠–ª—å–¥–∞—Ä –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ', 'info');
                    }
                }
            ]
        },
        {
            title: '–£–ª—å—Ç—Ä–∞–º–∞—Ä –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏—è',
            description: '–†–æ–±–∞—É—Ç –ñ–∏–ª–ª–∏–º–∞–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ü—Ä–∏–º–∞—Ä–∏—Å –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç–Ω–∏–∫–æ–≤ –≤ –ø–æ–º–æ—â—å –æ–±–æ—Ä–æ–Ω–µ –¢–µ—Ä—Ä—ã.',
            choices: [
                {
                    text: '–ü—Ä–∏–Ω—è—Ç—å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏—è',
                    action: () => {
                        this.resources.military += 50;
                        this.log('–ü—Ä–∏–º–∞—Ä–∏—Å –ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç–Ω–∏–∫–∏ –ø—Ä–∏–±—ã–ª–∏!', 'success');
                    }
                }
            ]
        },
        {
            title: '–ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤ –ê–¥–µ–ø—Ç—É—Å –¢–µ—Ä—Ä–∞',
            description: '–ü–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ç—Ä–∏–≥–∏ –≤ –ò–º–ø–µ—Ä—Å–∫–æ–º –°–µ–Ω–∞—Ç–µ –º–æ–≥—É—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Å–Ω–∞–±–∂–µ–Ω–∏–µ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞.',
            choices: [
                {
                    text: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–æ—Ä–æ–≤ (-5000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 5000) {
                            this.resources.credits -= 5000;
                            this.resourceChanges.psychic += 100;
                            this.log('–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–æ—Ä—ã –ø–æ–±–µ–¥–∏–ª–∏', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤', 'warning');
                        }
                    }
                },
                {
                    text: '–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä–µ—Ñ–æ—Ä–º–∏—Å—Ç–æ–≤ (-3000 –∫—Ä–µ–¥–∏—Ç–æ–≤)',
                    action: () => {
                        if (this.resources.credits >= 3000) {
                            this.resources.credits -= 3000;
                            this.resourceChanges.credits += 200;
                            this.log('–†–µ—Ñ–æ—Ä–º–∏—Å—Ç—ã –ø–æ–±–µ–¥–∏–ª–∏', 'success');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤', 'warning');
                        }
                    }
                },
                {
                    text: '–ù–µ –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è',
                    action: () => {
                        this.log('–í—ã –æ—Å—Ç–∞–ª–∏—Å—å –≤ —Å—Ç–æ—Ä–æ–Ω–µ', 'info');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –í–ù–£–¢–†–ï–ù–ù–ò–ï –ö–†–ò–ó–ò–°–´ ====================
Game.generateInternalCrisis = function() {
    const events = [
        {
            title: '–í–æ–ª–Ω–µ–Ω–∏—è –≤ –ò–º–ø–µ—Ä—Å–∫–∏—Ö —É–ª–∏—è—Ö',
            description: '–ú–∞—Å—Å–æ–≤—ã–µ –±–µ—Å–ø–æ—Ä—è–¥–∫–∏ –≤ —É–ª–∏—è—Ö –Ω–∏–∂–Ω–∏—Ö —É—Ä–æ–≤–Ω–µ–π. –ì—Ä–∞–∂–¥–∞–Ω–µ —Ç—Ä–µ–±—É—é—Ç —Å–Ω–∏–∂–µ–Ω–∏—è –¥–µ—Å—è—Ç–∏–Ω—ã.',
            choices: [
                {
                    text: '–ü–æ–¥–∞–≤–∏—Ç—å —Å–∏–ª–æ–π (-20 –∞—Ä–º–∏—è)',
                    action: () => {
                        if (this.resources.military >= 20) {
                            this.resources.military -= 20;
                            this.resources.population -= 5;
                            this.log('–ë–µ—Å–ø–æ—Ä—è–¥–∫–∏ –ø–æ–¥–∞–≤–ª–µ–Ω—ã', 'warning');
                        } else {
                            this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–æ–π—Å–∫', 'warning');
                        }
                    }
                },
                {
                    text: '–°–Ω–∏–∑–∏—Ç—å –Ω–∞–ª–æ–≥–∏ (-1000 –∫—Ä–µ–¥–∏—Ç–æ–≤/–¥–µ–Ω—å)',
                    action: () => {
                        this.resourceChanges.credits -= 1000;
                        this.resources.population += 2;
                        this.log('–ù–∞–ª–æ–≥–∏ —Å–Ω–∏–∂–µ–Ω—ã, –Ω–∞—Å–µ–ª–µ–Ω–∏–µ —É—Å–ø–æ–∫–æ–∏–ª–æ—Å—å', 'success');
                    }
                },
                {
                    text: '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø—Ä–æ–ø–æ–≤–µ–¥–Ω–∏–∫–æ–≤ –≠–∫–∫–ª–µ–∑–∏–∞—Ä—Ö–∏–∏',
                    action: () => {
                        this.log('–ü—Ä–æ–ø–æ–≤–µ–¥–Ω–∏–∫–∏ —É—Å–ø–æ–∫–æ–∏–ª–∏ –Ω–∞—Ä–æ–¥', 'info');
                    }
                }
            ]
        },
        {
            title: '–°–∞–±–æ—Ç–∞–∂ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ',
            description: '–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å–µ—Ç—å –µ—Ä–µ—Ç–∏–∫–æ–≤-—Å–∞–±–æ—Ç–∞–∂–Ω–∏–∫–æ–≤ –Ω–∞ –æ—Ä—É–∂–µ–π–Ω—ã—Ö –∑–∞–≤–æ–¥–∞—Ö –ú–∞—Ä—Å–∞.',
            choices: [
                {
                    text: '–†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ò–Ω–∫–≤–∏–∑–∏—Ü–∏–∏',
                    action: () => {
                        this.resourceChanges.military -= 2;
                        this.warp.level -= 5;
                        this.log('–ò–Ω–∫–≤–∏–∑–∏—Ü–∏—è –≤–µ–¥—ë—Ç —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', 'info');
                    }
                },
                {
                    text: '–ú–∞—Å—Å–æ–≤—ã–µ —á–∏—Å—Ç–∫–∏ (-50 –Ω–∞—Å–µ–ª–µ–Ω–∏–µ)',
                    action: () => {
                        this.resources.population -= 50;
                        this.resourceChanges.military += 1;
                        this.log('–ü—Ä–æ–≤–µ–¥–µ–Ω—ã –º–∞—Å—Å–æ–≤—ã–µ —á–∏—Å—Ç–∫–∏', 'warning');
                    }
                }
            ]
        }
    ];
    
    const event = events[Math.floor(Math.random() * events.length)];
    this.showChoiceEvent(event);
};

// ==================== –ü–û–ö–ê–ó–ê–¢–¨ –°–û–ë–´–¢–ò–ï –° –í–´–ë–û–†–û–ú ====================
Game.showChoiceEvent = function(event) {
    this.currentEvent = event;
    this.eventStats.totalEvents++;
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    const modal = document.getElementById('modal-choice');
    const title = document.getElementById('choice-title');
    const content = document.getElementById('choice-content');
    const options = document.getElementById('choice-options');
    
    title.textContent = event.title;
    content.innerHTML = `<p style="line-height: 1.8; color: #ccc;">${event.description}</p>`;
    
    options.innerHTML = '';
    event.choices.forEach((choice, index) => {
        const button = document.createElement('button');
        button.className = 'button';
        button.style.flex = '1';
        button.style.minWidth = '200px';
        button.style.position = 'relative';
        
        // –ê–Ω–∞–ª–∏–∑ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞
        let affordable = true;
        let costHtml = '';
        
        if (choice.text.includes('(') && choice.text.includes(')')) {
            const costMatch = choice.text.match(/\(([^)]+)\)/);
            if (costMatch) {
                costHtml = `<div style="font-size: 0.75em; color: #888; margin-top: 5px;">${costMatch[1]}</div>`;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (–ø—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞)
                if (costMatch[1].includes('–∫—Ä–µ–¥–∏—Ç–æ–≤')) {
                    const amount = parseInt(costMatch[1].match(/\d+/)?.[0] || '0');
                    if (this.resources.credits < amount) affordable = false;
                }
                if (costMatch[1].includes('–ø—Å–∞–π–∫–µ—Ä–æ–≤')) {
                    const amount = parseInt(costMatch[1].match(/\d+/)?.[0] || '0');
                    if (this.resources.psykers < amount) affordable = false;
                }
            }
        }
        
        // –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
        if (!affordable) {
            button.style.opacity = '0.5';
            button.style.borderColor = '#666';
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ª—É—á—à–µ–≥–æ –≤—ã–±–æ—Ä–∞ (—Å—Ä–µ–¥–Ω–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –æ–±—ã—á–Ω–æ –æ–ø—Ç–∏–º–∞–ª–µ–Ω)
        if (index === 1 && affordable) {
            button.style.borderColor = 'var(--imperial-gold)';
            button.style.boxShadow = '0 0 10px rgba(212,175,55,0.3)';
        }
        
        button.innerHTML = choice.text.replace(/\([^)]+\)/, '') + costHtml;
        
        button.onclick = () => {
            if (!affordable) {
                this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ –≤—ã–±–æ—Ä–∞!', 'warning');
                this.sounds.warning();
                return;
            }
            choice.action();
            this.closeModal('choice');
            this.updateUI();
        };
        options.appendChild(button);
    });
    
    modal.style.display = 'flex';
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
    this.log(`‚ö° –°–û–ë–´–¢–ò–ï: ${event.title}`, 'warning');
};

// ==================== –ó–ê–ö–†–´–¢–¨ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û ====================
Game.closeModal = function(modalType) {
    const modal = document.getElementById(`modal-${modalType}`);
    if (modal) {
        modal.style.display = 'none';
    }
};

// ==================== –ü–û–ö–ê–ó–ê–¢–¨ –î–ï–¢–ê–õ–ò –í–ê–†–ü–ê ====================
Game.showWarpDetails = function() {
    const modal = document.getElementById('modal-info');
    const title = document.getElementById('info-title');
    const content = document.getElementById('info-content');
    
    title.textContent = '–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—Ä–ø–µ';
    
    const warpStatus = this.warp.level < 20 ? '–°–ø–æ–∫–æ–π–Ω–æ' :
                       this.warp.level < 40 ? '–£–º–µ—Ä–µ–Ω–Ω–æ' :
                       this.warp.level < 60 ? '–ü–æ–≤—ã—à–µ–Ω–Ω–æ' :
                       this.warp.level < 80 ? '–í—ã—Å–æ–∫–æ' : '–ö–†–ò–¢–ò–ß–ù–û';
    
    const threatLevel = this.warp.demonThreat < 30 ? '–ù–∏–∑–∫–∞—è' :
                       this.warp.demonThreat < 60 ? '–°—Ä–µ–¥–Ω—è—è' :
                       this.warp.demonThreat < 80 ? '–í—ã—Å–æ–∫–∞—è' : '–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø';
    
    content.innerHTML = `
        <div style="margin-bottom: 20px;">
            <h3 style="color: var(--gold); margin-bottom: 10px;">–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∞—Ä–ø–∞</h3>
            <div class="metric">
                <span>–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:</span>
                <span style="color: ${this.warp.level > 60 ? 'var(--critical-red)' : 'var(--warning-orange)'}">${Math.round(this.warp.level)}% - ${warpStatus}</span>
            </div>
            <div class="metric">
                <span>–í–∞—Ä–ø-—à—Ç–æ—Ä–º–æ–≤:</span>
                <span>${this.warp.storms}</span>
            </div>
            <div class="metric">
                <span>–£–≥—Ä–æ–∑–∞ –¥–µ–º–æ–Ω–æ–≤:</span>
                <span style="color: ${this.warp.demonThreat > 60 ? 'var(--critical-red)' : 'var(--warning-orange)'}">${threatLevel}</span>
            </div>
            <div class="metric">
                <span>–í—Ç–æ—Ä–∂–µ–Ω–∏–π –•–∞–æ—Å–∞:</span>
                <span>${this.warp.chaosIncursions}</span>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: var(--gold); margin-bottom: 10px;">–í–ª–∏—è—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã</h3>
            <p style="line-height: 1.8; color: #aaa;">
                ‚Ä¢ –°–∏–ª—å–Ω—ã–π –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –ø–æ–¥–∞–≤–ª—è–µ—Ç –≤–∞—Ä–ø<br>
                ‚Ä¢ –ú–∞—Å—Å–æ–≤—ã–µ –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏—è —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –≤–∞—Ä–ø-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å<br>
                ‚Ä¢ –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –•–∞–æ—Å–∞ —É—Å–∏–ª–∏–≤–∞–µ—Ç –≤–∞—Ä–ø<br>
                ‚Ä¢ –í–∞—Ä–ø-—à—Ç–æ—Ä–º—ã –ø–æ–≤—ã—à–∞—é—Ç —É–≥—Ä–æ–∑—É –¥–µ–º–æ–Ω–æ–≤<br>
                ‚Ä¢ –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ –≤–∞—Ä–ø–∞ –≤–æ–∑–º–æ–∂–Ω—ã —Ä–∞–∑–ª–æ–º—ã –∏ –≤—Ç–æ—Ä–∂–µ–Ω–∏—è
            </p>
        </div>
        
        <div>
            <h3 style="color: var(--gold); margin-bottom: 10px;">–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è</h3>
            <p style="line-height: 1.8; color: #aaa;">
                ${this.warp.level < 40 ? '‚Ä¢ –í–∞—Ä–ø —Å–ø–æ–∫–æ–µ–Ω, –Ω–∞–≤–∏–≥–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–∞' :
                  this.warp.level < 60 ? '‚Ä¢ –í–æ–∑–º–æ–∂–Ω—ã –ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏<br>‚Ä¢ –ü—Å–∞–π–∫–µ—Ä—ã –±–æ–ª–µ–µ —É—è–∑–≤–∏–º—ã' :
                  this.warp.level < 80 ? '‚Ä¢ –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –º—É—Ç–∞—Ü–∏–π –ø—Å–∞–π–∫–µ—Ä–æ–≤<br>‚Ä¢ –í–æ–∑–º–æ–∂–Ω—ã –≤–∞—Ä–ø-—à—Ç–æ—Ä–º—ã<br>‚Ä¢ –î–µ–º–æ–Ω—ã –∞–∫—Ç–∏–≤–∏–∑–∏—Ä—É—é—Ç—Å—è' :
                  '‚Ä¢ –ö–†–ò–¢–ò–ß–ù–û! –ú–∞—Å—Å–æ–≤—ã–µ –≤–∞—Ä–ø-—Ä–∞–∑–ª–æ–º—ã!<br>‚Ä¢ –í—Ç–æ—Ä–∂–µ–Ω–∏—è –¥–µ–º–æ–Ω–æ–≤!<br>‚Ä¢ –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ó–æ–ª–æ—Ç–æ–≥–æ –¢—Ä–æ–Ω–∞ —É—Å–∫–æ—Ä–µ–Ω–∞!'}
            </p>
        </div>
    `;
    
    modal.style.display = 'flex';
};

// –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ Game

// ==================== –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–ë–ù–û–í–õ–ï–ù–ò–Ø UI ====================
Game.updateUI = function() {
    if (!this.running) return;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
    this.updateResourceDisplay();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞
    this.updateAstronomicanDisplay();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–ø–∞
    this.updateWarpDisplay();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    this.updateStatistics();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
    this.updateActiveTab();

    // –û–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –ß—ë—Ä–Ω–æ–≥–æ –ö–æ—Ä–∞–±–ª—è
    const daysUntilShip = Math.max(0, this.blackShips.nextArrival - this.day);
    const shipElement = document.getElementById('res-blackship');
    if (shipElement) {
        shipElement.textContent = daysUntilShip + ' –¥–Ω–µ–π';
        shipElement.parentElement.style.opacity = daysUntilShip <= 3 ? '1' : '0.7';
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏
    Object.keys(this.reputation).forEach(faction => {
        const rep = this.reputation[faction];
        
        const statusEl = document.getElementById(`rep-${faction}-status`);
        const barEl = document.getElementById(`rep-${faction}-bar`);
        const levelEl = document.getElementById(`rep-${faction}-level`);
        const bonusEl = document.getElementById(`rep-${faction}-bonus`);
        
        if (statusEl) {
            const statusNames = {
                hostile: '–í—Ä–∞–∂–¥–µ–±–Ω—ã',
                unfriendly: '–ù–µ–¥—Ä—É–∂–µ–ª—é–±–Ω—ã',
                neutral: '–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã',
                friendly: '–î—Ä—É–∂–µ–ª—é–±–Ω—ã',
                allied: '–°–æ—é–∑–Ω–∏–∫–∏'
            };
            statusEl.textContent = statusNames[rep.status] || rep.status;
            
            const statusColors = {
                hostile: '#ff0000',
                unfriendly: '#ff8800',
                neutral: '#ffaa00',
                friendly: '#00ff00',
                allied: '#00ffff'
            };
            statusEl.style.color = statusColors[rep.status];
        }
        
        if (barEl) {
            barEl.style.width = rep.level + '%';
        }
        
        if (levelEl) {
            levelEl.textContent = Math.floor(rep.level);
        }
        
        if (bonusEl) {
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –±–æ–Ω—É—Å
            const firstBonus = Object.values(rep.benefits)[0] || 0;
            bonusEl.textContent = firstBonus;
        }
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
    this.updateModifiersUI();
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –†–ï–°–£–†–°–û–í ====================
Game.updateResourceDisplay = function() {
    // –ü—Å–∏—Ö–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è
    document.getElementById('res-psychic').textContent = Math.floor(this.resources.psychic);
    const psychicChange = document.getElementById('res-psychic-change');
    psychicChange.textContent = (this.resourceChanges.psychic >= 0 ? '+' : '') + 
                                Math.floor(this.resourceChanges.psychic) + '/–¥–µ–Ω—å';
    psychicChange.className = 'resource-change ' + 
                             (this.resourceChanges.psychic >= 0 ? 'positive' : 'negative');
    
    // –ö—Ä–µ–¥–∏—Ç—ã
    document.getElementById('res-credits').textContent = Math.floor(this.resources.credits);
    const creditsChange = document.getElementById('res-credits-change');
    creditsChange.textContent = (this.resourceChanges.credits >= 0 ? '+' : '') + 
                                Math.floor(this.resourceChanges.credits) + '/–¥–µ–Ω—å';
    creditsChange.className = 'resource-change ' + 
                             (this.resourceChanges.credits >= 0 ? 'positive' : 'negative');
    
    // –ù–∞—Å–µ–ª–µ–Ω–∏–µ
    document.getElementById('res-population').textContent = Math.floor(this.resources.population);
    const popChange = document.getElementById('res-population-change');
    popChange.textContent = (this.resourceChanges.population >= 0 ? '+' : '') + 
                           this.resourceChanges.population.toFixed(1) + '/–¥–µ–Ω—å';
    popChange.className = 'resource-change ' + 
                         (this.resourceChanges.population >= 0 ? 'positive' : 'negative');
    
    // –ê—Ä–º–∏—è
    document.getElementById('res-military').textContent = Math.floor(this.resources.military);
    const milChange = document.getElementById('res-military-change');
    milChange.textContent = (this.resourceChanges.military >= 0 ? '+' : '') + 
                           this.resourceChanges.military.toFixed(1) + '/–¥–µ–Ω—å';
    milChange.className = 'resource-change ' + 
                         (this.resourceChanges.military >= 0 ? 'positive' : 'negative');
    
    // –§–ª–æ—Ç
    document.getElementById('res-fleet').textContent = Math.floor(this.resources.fleet);
    
    // –¢–µ—Ö–Ω–æ–∂—Ä–µ—Ü—ã
    document.getElementById('res-tech').textContent = Math.floor(this.resources.techpriests);
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù–ê ====================
Game.updateAstronomicanDisplay = function() {
    const astro = this.astronomican;
    
    // –°—Ç–∞—Ç—É—Å –¢—Ä–æ–Ω–∞
    const status = document.getElementById('throne-status');
    if (astro.throneCondition > 80) {
        status.textContent = '–°–¢–ê–ë–ò–õ–¨–ù–û';
        status.style.color = 'var(--success-green)';
    } else if (astro.throneCondition > 50) {
        status.textContent = '–£–•–£–î–®–ê–ï–¢–°–Ø';
        status.style.color = 'var(--warning-orange)';
    } else {
        status.textContent = '–ö–†–ò–¢–ò–ß–ù–û';
        status.style.color = 'var(--critical-red)';
    }
    
    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –¢—Ä–æ–Ω–∞
    document.getElementById('throne-condition').textContent = Math.floor(astro.throneCondition) + '%';
    document.getElementById('throne-condition').className = 'metric-value ' + 
        (astro.throneCondition < 50 ? 'critical' : astro.throneCondition < 80 ? 'warning' : '');
    
    // –ú–æ—â–Ω–æ—Å—Ç—å –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞
    const power = Math.max(0, Math.min(100, astro.power));
    document.getElementById('astro-power-pct').textContent = Math.floor(power) + '%';
    document.getElementById('astro-power-fill').style.width = power + '%';
    document.getElementById('astro-power-label').textContent = Math.floor(power) + '%';
    
    const powerFill = document.getElementById('astro-power-fill');
    powerFill.className = 'progress-fill';
    if (power < 30) powerFill.classList.add('critical');
    else if (power < 60) powerFill.classList.add('warning');
    
    // –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
    const stability = Math.max(0, Math.min(100, astro.stability));
    document.getElementById('stability-pct').textContent = Math.floor(stability) + '%';
    document.getElementById('stability-fill').style.width = stability + '%';
    document.getElementById('stability-label').textContent = Math.floor(stability) + '%';
    
    const stabilityFill = document.getElementById('stability-fill');
    stabilityFill.className = 'progress-fill';
    if (stability < 30) stabilityFill.classList.add('critical');
    else if (stability < 60) stabilityFill.classList.add('warning');
    
    // –°–∫–æ—Ä–æ—Å—Ç—å –∂–µ—Ä—Ç–≤–æ–ø—Ä–∏–Ω–æ—à–µ–Ω–∏–π
    document.getElementById('sacrifice-rate').textContent = astro.sacrificeRate + '/–¥–µ–Ω—å';
    
    // –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    document.getElementById('sacrifice-efficiency').textContent = Math.floor(astro.efficiency) + '%';
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–ê–†–ü–ê ====================
Game.updateWarpDisplay = function() {
    const warp = this.warp;
    const level = Math.max(0, Math.min(100, warp.level));
    
    // –£—Ä–æ–≤–µ–Ω—å –≤–∞—Ä–ø–∞
    document.getElementById('warp-level-pct').textContent = Math.floor(level) + '%';
    document.getElementById('warp-level-fill').style.width = level + '%';
    
    const warpLabel = document.getElementById('warp-level-label');
    if (level < 20) {
        warpLabel.textContent = '–°–ø–æ–∫–æ–π–Ω–æ';
    } else if (level < 40) {
        warpLabel.textContent = '–£–º–µ—Ä–µ–Ω–Ω–æ';
    } else if (level < 60) {
        warpLabel.textContent = '–ü–æ–≤—ã—à–µ–Ω–æ';
    } else if (level < 80) {
        warpLabel.textContent = '–í—ã—Å–æ–∫–æ';
    } else {
        warpLabel.textContent = '–ö–†–ò–¢–ò–ß–ù–û!';
    }
    
    const warpFill = document.getElementById('warp-level-fill');
    warpFill.className = 'progress-fill';
    if (level > 60) warpFill.classList.add('critical');
    else if (level > 40) warpFill.classList.add('warning');
    
    // –£–≥—Ä–æ–∑–∞ –¥–µ–º–æ–Ω–æ–≤
    const threatLevel = warp.demonThreat < 30 ? '–ù–∏–∑–∫–∞—è' :
                       warp.demonThreat < 60 ? '–°—Ä–µ–¥–Ω—è—è' :
                       warp.demonThreat < 80 ? '–í—ã—Å–æ–∫–∞—è' : '–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø';
    document.getElementById('demon-threat').textContent = threatLevel;
    document.getElementById('demon-threat').className = 'metric-value ' +
        (warp.demonThreat > 60 ? 'critical' : warp.demonThreat > 30 ? 'warning' : '');
    
    // –í–∞—Ä–ø-—à—Ç–æ—Ä–º—ã
    document.getElementById('warp-storms').textContent = warp.storms;
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò ====================
Game.updateStatistics = function() {
    document.getElementById('stat-day').textContent = this.day;
    document.getElementById('stat-sacrifices').textContent = Math.floor(this.stats.totalSacrifices);
    
    const controlledSectors = this.sectors.filter(s => s.status !== 'lost').length;
    document.getElementById('stat-sectors').textContent = controlledSectors;
    
    const lostSectors = this.sectors.filter(s => s.status === 'lost').length;
    document.getElementById('stat-lost-worlds').textContent = lostSectors;
    
    document.getElementById('stat-enemies-killed').textContent = this.stats.enemiesKilled;
    document.getElementById('stat-missions').textContent = this.stats.missionsCompleted;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤ —Å–µ–∫—Ç–æ—Ä–æ–≤
    document.getElementById('sectors-safe').textContent = 
        this.sectors.filter(s => s.status === 'safe').length;
    document.getElementById('sectors-threatened').textContent = 
        this.sectors.filter(s => s.status === 'threatened').length;
    document.getElementById('sectors-war').textContent = 
        this.sectors.filter(s => s.status === 'war').length;
    document.getElementById('sectors-lost').textContent = lostSectors;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ–µ–Ω–Ω—ã—Ö —Å–∏–ª
    document.getElementById('military-guardsmen').textContent = 
        Math.floor(this.resources.military) + 'M';
    document.getElementById('military-fleet').textContent = 
        Math.floor(this.resources.fleet);
};

// ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ê–ö–¢–ò–í–ù–û–ô –í–ö–õ–ê–î–ö–ò ====================
Game.updateActiveTab = function() {
    const activeTab = document.querySelector('.tab-content.active');
    if (!activeTab) return;
    
    const tabId = activeTab.id.replace('tab-', '');
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    // –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤–∫–ª–∞–¥–æ–∫ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –°–ï–ö–¢–û–†–û–í ====================
Game.renderSectors = function() {
    const container = document.getElementById('sectors-grid');
    container.innerHTML = '';
    
    this.sectors.forEach(sector => {
        const card = document.createElement('div');
        card.className = 'card';
        
        const statusColors = {
            safe: 'var(--success-green)',
            threatened: 'var(--warning-orange)',
            war: 'var(--critical-red)',
            lost: '#666'
        };
        
        const statusText = {
            safe: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ',
            threatened: '–ü–æ–¥ —É–≥—Ä–æ–∑–æ–π',
            war: '–í–æ–π–Ω–∞',
            lost: '–ü–æ—Ç–µ—Ä—è–Ω'
        };
        
        const threatText = sector.threat ? 
            `<div style="color: ${statusColors[sector.status]}; font-size: 0.85em; margin-top: 5px;">
                –£–≥—Ä–æ–∑–∞: ${this.getEnemyName(sector.threat)}
            </div>` : '';
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">${sector.name}</div>
                <div class="card-level" style="background: ${statusColors[sector.status]}; color: #fff;">
                    ${statusText[sector.status]}
                </div>
            </div>
            <div class="card-desc">
                –ì—É–±–µ—Ä–Ω–∞—Ç–æ—Ä: ${sector.governor}<br>
                –ù–∞—Å–µ–ª–µ–Ω–∏–µ: ${sector.population} –º–ª—Ä–¥<br>
                –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ: ${sector.production}<br>
                –ê—Ä–º–∏—è: ${sector.military} –º–ª–Ω
            </div>
            ${threatText}
            <div style="margin-top: 10px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span style="font-size: 0.85em; color: #888;">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</span>
                    <span style="font-size: 0.85em; color: var(--gold);">${Math.floor(sector.stability)}%</span>
                </div>
                <div class="progress-bar" style="height: 8px;">
                    <div class="progress-fill ${sector.stability < 30 ? 'critical' : sector.stability < 60 ? 'warning' : ''}" 
                         style="width: ${sector.stability}%"></div>
                </div>
            </div>
            ${sector.status !== 'lost' ? `
                <div class="card-footer" style="margin-top: 15px;">
                    <button class="button" style="width: 100%; padding: 8px; font-size: 0.85em;" 
                            onclick="Game.manageSector(${sector.id})">
                        –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    </button>
                </div>
            ` : ''}
        `;
        
        container.appendChild(card);
    });
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –ü–ï–†–°–û–ù–ê–õ–ê ====================
Game.renderPersonnel = function(category) {
    const container = document.getElementById('personnel-grid');
    container.innerHTML = '';
    
    const personnel = this.personnel[category] || [];
    
    if (personnel.length === 0) {
        container.innerHTML = `
            <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">
                –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            </div>
        `;
        return;
    }
    
    personnel.forEach(person => {
        const card = document.createElement('div');
        card.className = 'card';
        
        const statusColors = {
            available: 'var(--success-green)',
            deployed: 'var(--warning-orange)',
            injured: 'var(--critical-red)',
            deceased: '#666'
        };
        
        let details = '';
        
        if (category === 'inquisitors') {
            details = `
                <div class="card-stats">
                    <div class="card-stat">–û—Ä–¥–µ–Ω: <span class="card-stat-value">${person.ordo}</span></div>
                    <div class="card-stat">–£—Ä–æ–≤–µ–Ω—å: <span class="card-stat-value">${person.level}</span></div>
                    <div class="card-stat">–ú–∏—Å—Å–∏–π: <span class="card-stat-value">${person.missions || 0}</span></div>
                    <div class="card-stat">–£–±–∏–π—Å—Ç–≤: <span class="card-stat-value">${person.kills || 0}</span></div>
                </div>
                ${person.traits ? `<div style="font-size: 0.8em; color: #888; margin-top: 10px;">
                    –ß–µ—Ä—Ç—ã: ${person.traits.join(', ')}
                </div>` : ''}
            `;
        } else if (category === 'techpriests') {
            details = `
                <div class="card-stats">
                    <div class="card-stat">–†–∞–Ω–≥: <span class="card-stat-value">${person.rank}</span></div>
                    <div class="card-stat">–£—Ä–æ–≤–µ–Ω—å: <span class="card-stat-value">${person.level}</span></div>
                    <div class="card-stat">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: <span class="card-stat-value">${person.specialty}</span></div>
                </div>
                ${person.bonus ? `<div style="font-size: 0.8em; color: var(--gold); margin-top: 10px;">
                    –ë–æ–Ω—É—Å—ã: ${Object.entries(person.bonus).map(([k,v]) => `${k} +${v}%`).join(', ')}
                </div>` : ''}
            `;
        } else if (category === 'generals') {
            details = `
                <div class="card-stats">
                    <div class="card-stat">–†–∞–Ω–≥: <span class="card-stat-value">${person.rank}</span></div>
                    <div class="card-stat">–£—Ä–æ–≤–µ–Ω—å: <span class="card-stat-value">${person.level}</span></div>
                    <div class="card-stat">–ö–∞–º–ø–∞–Ω–∏–π: <span class="card-stat-value">${person.campaigns}</span></div>
                    <div class="card-stat">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: <span class="card-stat-value">${person.specialty}</span></div>
                </div>
            `;
        } else {
            details = `
                <div class="card-stats">
                    <div class="card-stat">–£—Ä–æ–≤–µ–Ω—å: <span class="card-stat-value">${person.level || 'N/A'}</span></div>
                    ${person.specialty ? `<div class="card-stat">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: <span class="card-stat-value">${person.specialty}</span></div>` : ''}
                </div>
            `;
        }
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">${person.name}</div>
                <div class="card-level" style="background: ${statusColors[person.status] || statusColors.available};">
                    ${person.status || 'available'}
                </div>
            </div>
            ${details}
        `;
        
        container.appendChild(card);
    });
};

Game.showPersonnelCategory = function(category) {
    this.renderPersonnel(category);
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ô ====================
Game.renderResearch = function(category) {
    const container = document.getElementById('research-grid');
    container.innerHTML = '';
    
    const researches = this.researchDatabase[category] || [];
    
    researches.forEach(research => {
        const isCompleted = this.research.completed.includes(research.id);
        const isCurrent = this.research.current && this.research.current.id === research.id;
        const canStart = research.unlocked && !isCompleted && !this.research.current;
        
        const card = document.createElement('div');
        card.className = 'card' + (research.unlocked ? '' : ' locked');
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">${research.name}</div>
                ${isCompleted ? '<div class="card-level" style="background: var(--success-green);">‚úì</div>' : ''}
                ${isCurrent ? '<div class="card-level" style="background: var(--tech-blue);">–í –ø—Ä–æ—Ü–µ—Å—Å–µ</div>' : ''}
            </div>
            <div class="card-desc">${research.description}</div>
            <div class="card-stats">
                <div class="card-stat">–°—Ç–æ–∏–º–æ—Å—Ç—å: <span class="card-stat-value">${research.cost} –∫—Ä–µ–¥–∏—Ç–æ–≤</span></div>
                <div class="card-stat">–í—Ä–µ–º—è: <span class="card-stat-value">${research.time} –¥–Ω–µ–π</span></div>
            </div>
            ${research.requirements.length > 0 ? `
                <div style="font-size: 0.8em; color: #888; margin-top: 10px;">
                    –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: ${research.requirements.map(r => {
                        const req = Object.values(this.researchDatabase).flat().find(res => res.id === r);
                        return req ? req.name : r;
                    }).join(', ')}
                </div>
            ` : ''}
            ${isCurrent ? `
                <div style="margin-top: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="font-size: 0.85em;">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
                        <span style="font-size: 0.85em; color: var(--gold);">${Math.floor(this.research.progress)}%</span>
                    </div>
                    <div class="progress-bar" style="height: 12px;">
                        <div class="progress-fill" style="width: ${this.research.progress}%"></div>
                    </div>
                </div>
            ` : ''}
            ${canStart ? `
                <button class="button success" style="width: 100%; margin-top: 15px;" 
                        onclick="Game.startResearch('${research.id}', '${category}')">
                    –ù–∞—á–∞—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
                </button>
            ` : ''}
            ${!research.unlocked ? `
                <div style="text-align: center; padding: 10px; color: #666; margin-top: 15px;">
                    üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
                </div>
            ` : ''}
        `;
        
        container.appendChild(card);
    });
};

Game.showResearchCategory = function(category) {
    this.renderResearch(category);
};

Game.startResearch = function(researchId, category) {
    const research = this.researchDatabase[category].find(r => r.id === researchId);
    
    if (!research) return;
    
    if (this.resources.credits < research.cost) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= research.cost;
    this.research.current = research;
    this.research.progress = 0;
    
    this.log(`–ù–∞—á–∞—Ç–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: ${research.name}`, 'info');
    this.notify('–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞—Ç–æ!', 'success');
    
    this.renderResearch(category);
    this.updateUI();
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –í–û–ï–ù–ù–´–• –°–ò–õ ====================
Game.renderMilitary = function() {
    const container = document.getElementById('military-recruitment-grid');
    container.innerHTML = '';
    
    const recruitmentOptions = [
        {
            name: '–ì–≤–∞—Ä–¥–µ–π—Å–∫–∏–π –ø–æ–ª–∫',
            cost: 1000,
            type: 'military',
            amount: 5,
            description: '–ù–∞–±—Ä–∞—Ç—å –∏ –æ–±—É—á–∏—Ç—å 5 –º–ª–Ω –≥–≤–∞—Ä–¥–µ–π—Ü–µ–≤',
            icon: '‚öîÔ∏è'
        },
        {
            name: '–≠—Å–∫–∞–¥—Ä–∏–ª—å—è –∫–æ—Ä–∞–±–ª–µ–π',
            cost: 3000,
            type: 'fleet',
            amount: 3,
            description: '3 –Ω–æ–≤—ã—Ö –∫–æ—Ä–∞–±–ª—è –¥–ª—è –ò–º–ø–µ—Ä—Å–∫–æ–≥–æ —Ñ–ª–æ—Ç–∞',
            icon: 'üöÄ'
        },
        {
            name: '–ö–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç–Ω–∏–∫–∏',
            cost: 5000,
            type: 'spacemarines',
            amount: 100,
            description: '–ó–∞–ø—Ä–æ—Å–∏—Ç—å 100 –∫–æ—Å–º–æ–¥–µ—Å–∞–Ω—Ç–Ω–∏–∫–æ–≤',
            icon: 'üõ°Ô∏è'
        },
        {
            name: '–¢–∏—Ç–∞–Ω-–ª–µ–≥–∏–æ–Ω',
            cost: 10000,
            type: 'titans',
            amount: 1,
            description: '–ó–∞–∫–∞–∑–∞—Ç—å –±–æ–µ–≤–æ–≥–æ —Ç–∏—Ç–∞–Ω–∞',
            icon: 'ü§ñ'
        }
    ];
    
    recruitmentOptions.forEach(option => {
        const card = document.createElement('div');
        card.className = 'card';
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">${option.icon} ${option.name}</div>
            </div>
            <div class="card-desc">${option.description}</div>
            <div class="card-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å: ${option.cost} –∫—Ä–µ–¥–∏—Ç–æ–≤</div>
            <button class="button" style="width: 100%; margin-top: 15px;" 
                    onclick="Game.recruitMilitary('${option.type}', ${option.amount}, ${option.cost})">
                –ü—Ä–æ–∏–∑–≤–µ—Å—Ç–∏
            </button>
        `;
        
        container.appendChild(card);
    });
};

Game.recruitMilitary = function(type, amount, cost) {
    if (this.resources.credits < cost) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= cost;
    
    switch(type) {
        case 'military':
            this.resources.military += amount;
            this.log(`–ù–∞–±—Ä–∞–Ω–æ ${amount} –º–ª–Ω –≥–≤–∞—Ä–¥–µ–π—Ü–µ–≤.`, 'success');
            break;
        case 'fleet':
            this.resources.fleet += amount;
            this.log(`–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ ${amount} –∫–æ—Ä–∞–±–ª–µ–π —Ñ–ª–æ—Ç–∞.`, 'success');
            break;
        case 'spacemarines':
        case 'titans':
            this.log(`–ó–∞–∫–∞–∑ —Ä–∞–∑–º–µ—â—ë–Ω.`, 'success');
            break;
    }
    
    this.notify('–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'success');
    this.updateUI();
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –í–†–ê–ì–û–í ====================
Game.renderEnemies = function() {
    const container = document.getElementById('enemies-grid');
    container.innerHTML = '';
    
    const enemyData = {
        chaos: { name: '–°–∏–ª—ã –•–∞–æ—Å–∞', icon: '‚ò†Ô∏è', color: 'var(--chaos-red)' },
        tyranids: { name: '–¢–∏—Ä–∞–Ω–∏–¥—ã', icon: 'üëæ', color: 'var(--tyranid-purple)' },
        necrons: { name: '–ù–µ–∫—Ä–æ–Ω—ã', icon: 'üíÄ', color: 'var(--necron-green)' },
        orks: { name: '–û—Ä–∫–∏', icon: 'üëπ', color: 'var(--ork-green)' },
        tau: { name: '–ò–º–ø–µ—Ä–∏—è –¢–∞—É', icon: 'üî∑', color: 'var(--tau-cyan)' },
        eldar: { name: '–≠–ª—å–¥–∞—Ä', icon: '‚ú®', color: 'var(--eldar-blue)' }
    };
    
    Object.entries(this.enemies).forEach(([type, enemy]) => {
        const data = enemyData[type];
        const card = document.createElement('div');
        card.className = 'card';
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title" style="color: ${data.color};">${data.icon} ${data.name}</div>
            </div>
            <div class="card-stats">
                <div class="card-stat">–°–∏–ª–∞: <span class="card-stat-value">${enemy.strength}</span></div>
                <div class="card-stat">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: <span class="card-stat-value">${enemy.activity}%</span></div>
                <div class="card-stat">–°–µ–∫—Ç–æ—Ä–æ–≤: <span class="card-stat-value">${enemy.sectors.length}</span></div>
            </div>
            <div style="margin-top: 15px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span style="font-size: 0.85em;">–£–≥—Ä–æ–∑–∞</span>
                    <span style="font-size: 0.85em; color: ${data.color};">${enemy.activity}%</span>
                </div>
                <div class="progress-bar" style="height: 10px;">
                    <div class="progress-fill" style="width: ${enemy.activity}%; background: ${data.color};"></div>
                </div>
            </div>
        `;
        
        container.appendChild(card);
    });
    
    // –ê–∫—Ç–∏–≤–Ω—ã–µ —É–≥—Ä–æ–∑—ã
    const threatsContainer = document.getElementById('active-threats-container');
    threatsContainer.innerHTML = '';
    
    const threatenedSectors = this.sectors.filter(s => s.status === 'war' || s.status === 'threatened');
    
    if (threatenedSectors.length === 0) {
        threatsContainer.innerHTML = `
            <div style="text-align: center; padding: 40px; color: #666;">
                –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —É–≥—Ä–æ–∑
            </div>
        `;
    } else {
        threatenedSectors.forEach(sector => {
            const threat = document.createElement('div');
            threat.className = 'card';
            threat.style.borderLeft = `4px solid ${sector.status === 'war' ? 'var(--critical-red)' : 'var(--warning-orange)'}`;
            
            threat.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-weight: 700; color: var(--gold);">${sector.name}</div>
                        <div style="font-size: 0.85em; color: #888; margin-top: 5px;">
                            ${sector.threat ? this.getEnemyName(sector.threat) : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —É–≥—Ä–æ–∑–∞'}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="color: ${sector.status === 'war' ? 'var(--critical-red)' : 'var(--warning-orange)'}; font-weight: 700;">
                            ${sector.status === 'war' ? '–í–û–ô–ù–ê' : '–£–ì–†–û–ó–ê'}
                        </div>
                        <div style="font-size: 0.85em; color: #666;">
                            –°—Ç–∞–±.: ${Math.floor(sector.stability)}%
                        </div>
                    </div>
                </div>
            `;
            
            threatsContainer.appendChild(threat);
        });
    }
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –£–õ–£–ß–®–ï–ù–ò–ô ====================
Game.renderUpgrades = function(category) {
    const container = document.getElementById('upgrades-grid');
    container.innerHTML = '';
    
    const upgrades = this.upgradesDatabase[category] || [];
    
    upgrades.forEach(upgrade => {
        const currentLevel = this.upgrades[upgrade.id]?.level || 0;
        const canUpgrade = currentLevel < upgrade.maxLevel;
        const cost = upgrade.cost * (currentLevel + 1);
        
        const card = document.createElement('div');
        card.className = 'card';
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">${upgrade.name}</div>
                <div class="card-level">–£—Ä. ${currentLevel}/${upgrade.maxLevel}</div>
            </div>
            <div class="card-desc">${upgrade.description}</div>
            <div class="card-stats">
                <div class="card-stat">
                    –≠—Ñ—Ñ–µ–∫—Ç: 
                    <span class="card-stat-value">
                        ${Object.entries(upgrade.effect).map(([k,v]) => `${k} ${v > 0 ? '+' : ''}${v}`).join(', ')}
                    </span>
                </div>
            </div>
            ${currentLevel > 0 ? `
                <div style="margin-top: 10px; padding: 10px; background: rgba(0,255,0,0.1); border-left: 3px solid var(--success-green);">
                    <div style="font-size: 0.85em; color: var(--success-green);">
                        –¢–µ–∫—É—â–∏–π –±–æ–Ω—É—Å: ${Object.entries(upgrade.effect).map(([k,v]) => `${k} ${v > 0 ? '+' : ''}${v * currentLevel}`).join(', ')}
                    </div>
                </div>
            ` : ''}
            ${canUpgrade ? `
                <div class="card-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è: ${cost} –∫—Ä–µ–¥–∏—Ç–æ–≤</div>
                <button class="button success" style="width: 100%; margin-top: 15px;" 
                        onclick="Game.purchaseUpgrade('${upgrade.id}', ${cost})">
                    –£–ª—É—á—à–∏—Ç—å
                </button>
            ` : `
                <div style="text-align: center; padding: 15px; color: var(--gold); background: rgba(212,175,55,0.1); margin-top: 15px; border-radius: 4px;">
                    ‚úì –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
                </div>
            `}
        `;
        
        container.appendChild(card);
    });
};

Game.showUpgradeCategory = function(category) {
    this.renderUpgrades(category);
};

Game.purchaseUpgrade = function(upgradeId, cost) {
    if (this.resources.credits < cost) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= cost;
    
    if (!this.upgrades[upgradeId]) {
        this.upgrades[upgradeId] = { level: 0, active: false };
    }
    
    this.upgrades[upgradeId].level++;
    this.upgrades[upgradeId].active = true;
    
    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã —É–ª—É—á—à–µ–Ω–∏—è
    const upgrade = Object.values(this.upgradesDatabase)
        .flat()
        .find(u => u.id === upgradeId);
    
    if (upgrade && upgrade.effect) {
        Object.entries(upgrade.effect).forEach(([effect, value]) => {
            this.applyUpgradeEffect(effect, value);
        });
    }
    
    this.log(`–£–ª—É—á—à–µ–Ω–∏–µ "${upgrade.name}" –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–æ!`, 'success');
    this.notify('–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–æ!', 'success');
    
    // –ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    const currentCategory = upgrade.category;
    this.renderUpgrades(currentCategory);
    this.updateUI();
};

Game.applyUpgradeEffect = function(effect, value) {
    switch(effect) {
        case 'throneDegradation':
            // –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ updateAstronomican
            break;
        case 'throneStability':
            this.astronomican.stability += value;
            break;
        case 'astronomicPower':
            this.astronomican.power += value;
            break;
        case 'sacrificeEfficiency':
            this.astronomican.efficiency += value;
            break;
        case 'income':
            this.resourceChanges.credits += value;
            break;
        // ... –¥—Ä—É–≥–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
    }
};

// ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================

Game.getEnemyName = function(type) {
    const names = {
        chaos: '–°–∏–ª—ã –•–∞–æ—Å–∞',
        tyranids: '–¢–∏—Ä–∞–Ω–∏–¥—ã',
        necrons: '–ù–µ–∫—Ä–æ–Ω—ã',
        orks: '–û—Ä–∫–∏',
        tau: '–ò–º–ø–µ—Ä–∏—è –¢–∞—É',
        eldar: '–≠–ª—å–¥–∞—Ä'
    };
    return names[type] || type;
};

Game.manageSector = function(sectorId) {
    const sector = this.sectors.find(s => s.id === sectorId);
    if (!sector) return;
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–æ–º
    this.showSectorDetails(sector);
};

Game.showSectorDetails = function(sector) {
    const modal = document.getElementById('modal-info');
    const title = document.getElementById('info-title');
    const content = document.getElementById('info-content');
    
    title.textContent = sector.name;
    
    const statusText = {
        safe: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ',
        threatened: '–ü–æ–¥ —É–≥—Ä–æ–∑–æ–π',
        war: '–°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ–π–Ω—ã',
        lost: '–ü–æ—Ç–µ—Ä—è–Ω'
    };
    
    content.innerHTML = `
        <div class="stats-grid">
            <div class="stat-box">
                <span class="stat-label">–°—Ç–∞—Ç—É—Å</span>
                <span class="stat-number" style="font-size: 1.5em;">${statusText[sector.status]}</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</span>
                <span class="stat-number" style="font-size: 1.5em;">${Math.floor(sector.stability)}%</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–ù–∞—Å–µ–ª–µ–Ω–∏–µ</span>
                <span class="stat-number" style="font-size: 1.5em;">${sector.population}B</span>
            </div>
        </div>
        
        <div style="margin: 20px 0;">
            <div class="metric">
                <span>–ì—É–±–µ—Ä–Ω–∞—Ç–æ—Ä:</span>
                <span style="color: var(--gold);">${sector.governor}</span>
            </div>
            <div class="metric">
                <span>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:</span>
                <span style="color: var(--gold);">${sector.production}</span>
            </div>
            <div class="metric">
                <span>–í–æ–µ–Ω–Ω—ã–µ —Å–∏–ª—ã:</span>
                <span style="color: var(--gold);">${sector.military} –º–ª–Ω</span>
            </div>
            ${sector.threat ? `
                <div class="metric">
                    <span>–£–≥—Ä–æ–∑–∞:</span>
                    <span style="color: var(--critical-red);">${this.getEnemyName(sector.threat)}</span>
                </div>
            ` : ''}
        </div>
        
        ${sector.status !== 'lost' ? `
            <div class="button-group">
                <button class="button" onclick="Game.reinforceSector(${sector.id}); Game.closeModal('info');">
                    –£—Å–∏–ª–∏—Ç—å –æ–±–æ—Ä–æ–Ω—É (1000 –∫—Ä–µ–¥–∏—Ç–æ–≤)
                </button>
                <button class="button" onclick="Game.stabilizeSectorDirect(${sector.id}); Game.closeModal('info');">
                    –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å (500 –∫—Ä–µ–¥–∏—Ç–æ–≤)
                </button>
            </div>
        ` : ''}
    `;
    
    modal.style.display = 'flex';
};

Game.reinforceSector = function(sectorId) {
    const sector = this.sectors.find(s => s.id === sectorId);
    if (!sector || this.resources.credits < 1000) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= 1000;
    sector.military += 5;
    sector.stability += 10;
    
    this.log(`–°–µ–∫—Ç–æ—Ä ${sector.name} —É—Å–∏–ª–µ–Ω.`, 'success');
    this.updateUI();
};

Game.stabilizeSectorDirect = function(sectorId) {
    const sector = this.sectors.find(s => s.id === sectorId);
    if (!sector || this.resources.credits < 500) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= 500;
    sector.stability += 20;
    
    if (sector.stability > 70 && sector.status === 'threatened') {
        sector.status = 'safe';
    }
    
    this.log(`–°–µ–∫—Ç–æ—Ä ${sector.name} —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.`, 'success');
    this.updateUI();
};

// –°–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –ø–∞–Ω–µ–ª–µ–π
Game.togglePanel = function(panelId) {
    const panel = document.getElementById(panelId);
    if (!panel) return;
    
    panel.classList.toggle('collapsed');
    
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    if (!this.panelStates) this.panelStates = {};
    this.panelStates[panelId] = panel.classList.contains('collapsed');
};

// ==================== –õ–û–ì–ò–†–û–í–ê–ù–ò–ï ====================
Game.log = function(message, type = 'info') {
    const logContainer = document.getElementById('event-log');
    if (!logContainer) return;
    
    const entry = document.createElement('div');
    entry.className = `event-entry ${type}`;
    
    const timestamp = `[${String(this.day).padStart(4, '0')}.M41]`;
    
    entry.innerHTML = `
        <span class="event-timestamp">${timestamp}</span>
        <span>${message}</span>
    `;
    
    // –í—Å—Ç–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ –ª–æ–≥–∞
    logContainer.insertBefore(entry, logContainer.firstChild);
    
    // –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
    while (logContainer.children.length > 150) {
        logContainer.removeChild(logContainer.lastChild);
    }
};

Game.clearLog = function() {
    const logContainer = document.getElementById('event-log');
    if (logContainer) {
        logContainer.innerHTML = '';
        this.log('–õ–æ–≥ —Å–æ–±—ã—Ç–∏–π –æ—á–∏—â–µ–Ω.', 'info');
    }
};

// ==================== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ====================
Game.notify = function(message, type = 'info') {
    const container = document.getElementById('notification-container');
    if (!container) return;
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    notification.innerHTML = `
        <button class="notification-close" onclick="this.parentElement.remove()">√ó</button>
        <div style="padding: 5px 10px;">${message}</div>
    `;
    
    container.appendChild(notification);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–∏—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 5000);
};

// ==================== –ù–ê–°–¢–†–û–ô–ö–ê UI ====================
Game.setupUI = function() {
    console.log('‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...');
    
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫
    document.getElementById('btn-sacrifice-normal').classList.add('active');
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    this.renderSectors();
    this.renderAchievements();
    
    console.log('‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù–ê –ù–ê CANVAS ====================
Game.renderAstronomicanCanvas = function() {
    const canvas = document.getElementById('astronomican-canvas');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const time = Date.now() / 1000;
    
    // –û—á–∏—Å—Ç–∫–∞ canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // –†–∞—Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    const efficiency = this.astronomican.efficiency / 100;
    const threat = this.warp.level / 100;
    const baseRadius = 80;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤
    if (!this.astronomican.visual) return;
    const layers = this.astronomican.visual.layers;
    layers.core.rotation += 0.002;
    layers.middle.rotation -= 0.001;
    layers.outer.rotation += 0.0005;
    layers.core.pulse = Math.sin(time * 2) * 0.15 + 0.85;
    
    // –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞
    let mainColor, glowColor, glowIntensity;
    if (efficiency >= 1.0) {
        mainColor = '#FFD700';
        glowColor = '#FFFFFF';
        glowIntensity = 40;
    } else if (efficiency >= 0.75) {
        mainColor = '#D4AF37';
        glowColor = '#FFD700';
        glowIntensity = 30;
    } else if (efficiency >= 0.5) {
        mainColor = '#FFA500';
        glowColor = '#FF8C00';
        glowIntensity = 20;
    } else if (efficiency >= 0.25) {
        mainColor = '#FF6347';
        glowColor = '#FF4500';
        glowIntensity = 15;
    } else {
        mainColor = '#8B0000';
        glowColor = '#DC143C';
        glowIntensity = 10;
    }
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ª–æ—ë–≤
    this.renderStarfield(ctx, canvas.width, canvas.height, time);
    this.renderCorona(ctx, centerX, centerY, baseRadius * 1.5, layers.corona, mainColor, glowColor, efficiency, time);
    this.renderOuterLayer(ctx, centerX, centerY, baseRadius * 1.2, layers.outer, mainColor, efficiency);
    this.renderMiddleLayer(ctx, centerX, centerY, baseRadius * 0.8, layers.middle, mainColor, time);
    this.renderCore(ctx, centerX, centerY, baseRadius * 0.5, layers.core, mainColor, glowColor, glowIntensity);
    
    // –≠—Ñ—Ñ–µ–∫—Ç—ã –•–∞–æ—Å–∞
    if (threat > 0.3) {
        this.renderChaosEffects(ctx, centerX, centerY, baseRadius, threat, time);
    }
    
    // –°–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü
    this.updateAndRenderCanvasParticles(ctx, centerX, centerY, mainColor, glowColor, efficiency, threat);
    
    // –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø—ã—à–∫–∏
    const effects = this.astronomican.visual.effects;
    if (effects.flash.active) {
        this.renderFlashEffect(ctx, centerX, centerY, effects.flash);
        effects.flash.timer--;
        if (effects.flash.timer <= 0) {
            effects.flash.active = false;
        }
    }
    
    // –¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞
    this.renderStatusText(ctx, centerX, centerY + baseRadius * 2, efficiency);
};

// –ó–≤—ë–∑–¥–Ω–æ–µ –ø–æ–ª–µ
Game.renderStarfield = function(ctx, width, height, time) {
    if (!this.starfield) return;
    
    ctx.save();
    this.starfield.forEach(star => {
        const alpha = (Math.sin(time * 2 + star.twinkle) + 1) / 2 * 0.5 + 0.3;
        ctx.globalAlpha = alpha;
        ctx.fillStyle = '#FFFFFF';
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
        ctx.fill();
    });
    ctx.restore();
};

// –ö–æ—Ä–æ–Ω–∞ —Å –ª—É—á–∞–º–∏
Game.renderCorona = function(ctx, x, y, radius, corona, mainColor, glowColor, efficiency, time) {
    const beamCount = corona.beams;
    const beamLength = radius * 2;
    
    for (let i = 0; i < beamCount; i++) {
        const angle = (i * (360 / beamCount) + time * 10) * Math.PI / 180;
        
        const gradient = ctx.createLinearGradient(
            x, y,
            x + Math.cos(angle) * beamLength,
            y + Math.sin(angle) * beamLength
        );
        gradient.addColorStop(0, mainColor);
        gradient.addColorStop(0.3, mainColor + 'AA');
        gradient.addColorStop(0.7, mainColor + '44');
        gradient.addColorStop(1, 'transparent');
        
        ctx.save();
        ctx.globalAlpha = efficiency * 0.8;
        ctx.shadowBlur = 20;
        ctx.shadowColor = glowColor;
        
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(
            x + Math.cos(angle - 0.1) * beamLength,
            y + Math.sin(angle - 0.1) * beamLength
        );
        ctx.lineTo(
            x + Math.cos(angle + 0.1) * beamLength,
            y + Math.sin(angle + 0.1) * beamLength
        );
        ctx.closePath();
        ctx.fillStyle = gradient;
        ctx.fill();
        
        // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
        ctx.strokeStyle = glowColor;
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(x, y);
        ctx.lineTo(
            x + Math.cos(angle) * beamLength,
            y + Math.sin(angle) * beamLength
        );
        ctx.stroke();
        
        ctx.restore();
    }
};

// –í–Ω–µ—à–Ω–∏–π —Å–ª–æ–π
Game.renderOuterLayer = function(ctx, x, y, radius, layer, mainColor, efficiency) {
    const ringCount = 3;
    
    for (let i = 0; i < ringCount; i++) {
        const r = radius + i * 15;
        const alpha = (1 - i / ringCount) * efficiency * 0.4;
        
        const gradient = ctx.createRadialGradient(x, y, r - 5, x, y, r + 5);
        const alphaHex = Math.floor(alpha * 255).toString(16).padStart(2, '0');
        gradient.addColorStop(0, mainColor + '00');
        gradient.addColorStop(0.5, mainColor + alphaHex);
        gradient.addColorStop(1, mainColor + '00');
        
        ctx.strokeStyle = gradient;
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(x, y, r, 0, Math.PI * 2);
        ctx.stroke();
    }
};

// –°—Ä–µ–¥–Ω–∏–π —Å–ª–æ–π —Å —Ä—É–Ω–∞–º–∏
Game.renderMiddleLayer = function(ctx, x, y, radius, layer, mainColor, time) {
    if (!layer.runes) return;
    
    ctx.save();
    layer.runes.forEach((rune, index) => {
        const angle = rune.angle + layer.rotation * 100;
        const runeX = x + Math.cos(angle) * radius;
        const runeY = y + Math.sin(angle) * radius;
        
        ctx.shadowBlur = 15;
        ctx.shadowColor = mainColor;
        ctx.globalAlpha = rune.opacity;
        ctx.font = 'bold 24px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = mainColor;
        ctx.fillText(rune.symbol, runeX, runeY);
    });
    ctx.restore();
};

// –Ø–¥—Ä–æ
Game.renderCore = function(ctx, x, y, radius, core, mainColor, glowColor, glowIntensity) {
    const pulseRadius = radius * core.pulse;
    
    // –í–Ω–µ—à–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ
    const outerGlow = ctx.createRadialGradient(x, y, 0, x, y, pulseRadius * 2);
    outerGlow.addColorStop(0, glowColor + '88');
    outerGlow.addColorStop(0.5, mainColor + '44');
    outerGlow.addColorStop(1, 'transparent');
    
    ctx.fillStyle = outerGlow;
    ctx.beginPath();
    ctx.arc(x, y, pulseRadius * 2, 0, Math.PI * 2);
    ctx.fill();
    
    // –û—Å–Ω–æ–≤–Ω–æ–µ —è–¥—Ä–æ
    const coreGradient = ctx.createRadialGradient(x, y, 0, x, y, pulseRadius);
    coreGradient.addColorStop(0, '#FFFFFF');
    coreGradient.addColorStop(0.3, glowColor);
    coreGradient.addColorStop(0.7, mainColor);
    coreGradient.addColorStop(1, mainColor + 'AA');
    
    ctx.save();
    ctx.shadowBlur = glowIntensity;
    ctx.shadowColor = glowColor;
    ctx.fillStyle = coreGradient;
    ctx.beginPath();
    ctx.arc(x, y, pulseRadius, 0, Math.PI * 2);
    ctx.fill();
    
    // –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ–ª—å—Ü–∞
    ctx.globalAlpha = 0.6;
    ctx.strokeStyle = '#FFFFFF';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(x, y, pulseRadius * 0.7, 0, Math.PI * 2);
    ctx.stroke();
    ctx.beginPath();
    ctx.arc(x, y, pulseRadius * 0.4, 0, Math.PI * 2);
    ctx.stroke();
    ctx.restore();
};

// –≠—Ñ—Ñ–µ–∫—Ç—ã –•–∞–æ—Å–∞
Game.renderChaosEffects = function(ctx, x, y, radius, threat, time) {
    // –§–∏–æ–ª–µ—Ç–æ–≤—ã–µ —Ç—Ä–µ—â–∏–Ω—ã
    const crackCount = Math.floor(threat * 8);
    for (let i = 0; i < crackCount; i++) {
        const angle = (i / crackCount) * Math.PI * 2 + time;
        const length = radius * (0.5 + Math.random() * 0.5);
        
        ctx.save();
        ctx.globalAlpha = threat * 0.4;
        ctx.strokeStyle = '#6a0dad';
        ctx.lineWidth = 2;
        ctx.shadowBlur = 10;
        ctx.shadowColor = '#6a0dad';
        
        ctx.beginPath();
        ctx.moveTo(x, y);
        
        let currentLength = 0;
        let currentAngle = angle;
        while (currentLength < length) {
            currentLength += 10;
            currentAngle += (Math.random() - 0.5) * 0.3;
            ctx.lineTo(
                x + Math.cos(currentAngle) * currentLength,
                y + Math.sin(currentAngle) * currentLength
            );
        }
        ctx.stroke();
        ctx.restore();
    }
};

// –ß–∞—Å—Ç–∏—Ü—ã –Ω–∞ canvas
Game.updateAndRenderCanvasParticles = function(ctx, centerX, centerY, mainColor, glowColor, efficiency, threat) {
    const particles = this.astronomican.visual.particles;
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —á–∞—Å—Ç–∏—Ü
    if (this.settings.particlesEnabled && Math.random() < efficiency * 0.5) {
        const type = Math.random();
        let particleType;
        
        if (type < 0.6) particleType = 'golden';
        else if (type < 0.9) particleType = 'white';
        else if (threat > 0.3) particleType = 'red';
        else particleType = 'trailing';
        
        const angle = Math.random() * Math.PI * 2;
        const speed = 0.5 + Math.random() * 1.5;
        
        particles[particleType].push({
            x: centerX,
            y: centerY,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            size: Math.random() * 3 + 1,
            life: 0,
            maxLife: 60 + Math.random() * 60,
            trail: particleType === 'trailing' ? [] : null
        });
    }
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —á–∞—Å—Ç–∏—Ü
    ['golden', 'white', 'red', 'trailing'].forEach(type => {
        let color;
        switch(type) {
            case 'golden': color = mainColor; break;
            case 'white': color = '#FFFFFF'; break;
            case 'red': color = '#DC143C'; break;
            case 'trailing': color = glowColor; break;
        }
        
        for (let i = particles[type].length - 1; i >= 0; i--) {
            const p = particles[type][i];
            
            p.x += p.vx;
            p.y += p.vy;
            p.life++;
            
            if (p.trail) {
                p.trail.push({ x: p.x, y: p.y });
                if (p.trail.length > 10) p.trail.shift();
            }
            
            if (p.life > p.maxLife) {
                particles[type].splice(i, 1);
                continue;
            }
            
            const alpha = 1 - (p.life / p.maxLife);
            
            // –†–∏—Å–æ–≤–∞–Ω–∏–µ
            ctx.save();
            ctx.globalAlpha = alpha;
            ctx.shadowBlur = p.size * 2;
            ctx.shadowColor = color;
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }
    });
    
    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ
    ['golden', 'white', 'red', 'trailing'].forEach(type => {
        if (particles[type].length > 150) {
            particles[type].splice(0, particles[type].length - 150);
        }
    });
};

// –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø—ã—à–∫–∏
Game.renderFlashEffect = function(ctx, x, y, flash) {
    const intensity = flash.intensity * (1 - flash.timer / 30);
    
    const gradient = ctx.createRadialGradient(x, y, 0, x, y, 200);
    gradient.addColorStop(0, `rgba(255, 215, 0, ${intensity})`);
    gradient.addColorStop(0.5, `rgba(212, 175, 55, ${intensity * 0.5})`);
    gradient.addColorStop(1, 'transparent');
    
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(x, y, 200, 0, Math.PI * 2);
    ctx.fill();
    
    // –ö–æ–ª—å—Ü–µ–≤–∞—è –≤–æ–ª–Ω–∞
    const waveRadius = (30 - flash.timer) * 10;
    ctx.strokeStyle = `rgba(255, 215, 0, ${intensity * 0.7})`;
    ctx.lineWidth = 3;
    ctx.shadowBlur = 20;
    ctx.shadowColor = '#FFD700';
    ctx.beginPath();
    ctx.arc(x, y, waveRadius, 0, Math.PI * 2);
    ctx.stroke();
};

// –¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞
Game.renderStatusText = function(ctx, x, y, efficiency) {
    let statusText, statusColor;
    
    if (efficiency >= 1.0) {
        statusText = '–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –ú–û–©–¨';
        statusColor = '#00FF00';
    } else if (efficiency >= 0.75) {
        statusText = '–û–ü–¢–ò–ú–ê–õ–¨–ù–ê–Ø –†–ê–ë–û–¢–ê';
        statusColor = '#FFD700';
    } else if (efficiency >= 0.5) {
        statusText = '–ü–û–ù–ò–ñ–ï–ù–ù–ê–Ø –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨';
        statusColor = '#FFA500';
    } else if (efficiency >= 0.25) {
        statusText = '–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –°–û–°–¢–û–Ø–ù–ò–ï';
        statusColor = '#FF4500';
    } else {
        statusText = '–ê–í–ê–†–ò–ô–ù–´–ô –†–ï–ñ–ò–ú';
        statusColor = '#8B0000';
    }
    
    ctx.save();
    ctx.font = 'bold 14px Orbitron, monospace';
    ctx.textAlign = 'center';
    ctx.fillStyle = statusColor;
    ctx.shadowBlur = 10;
    ctx.shadowColor = statusColor;
    ctx.fillText(statusText, x, y);
    ctx.restore();
};

// –ó–∞–ø—É—Å–∫ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ canvas
Game.startCanvasRendering = function() {
    const renderLoop = () => {
        if (this.running && !this.gameOver) {
            this.renderAstronomicanCanvas();
        }
        requestAnimationFrame(renderLoop);
    };
    requestAnimationFrame(renderLoop);
};

// ==================== –°–û–ó–î–ê–ù–ò–ï –ß–ê–°–¢–ò–¶ ====================
Game.createParticles = function() {
    const display = document.getElementById('astro-display');
    if (!display) return;
    
    const createParticle = () => {
        if (!this.running || !this.settings.particlesEnabled) return;
        
        const particle = document.createElement('div');
        particle.className = 'particle';
        
        // –°–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        const angle = Math.random() * Math.PI * 2;
        const distance = 100 + Math.random() * 150;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        const duration = 2 + Math.random() * 2;
        
        particle.style.left = '50%';
        particle.style.top = '50%';
        particle.style.setProperty('--tx', tx + 'px');
        particle.style.setProperty('--ty', ty + 'px');
        particle.style.animation = `particleFloat ${duration}s linear`;
        
        display.appendChild(particle);
        
        // –£–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(() => {
            if (particle.parentNode) {
                particle.remove();
            }
        }, duration * 1000);
    };
    
    // –°–æ–∑–¥–∞–≤–∞—Ç—å —á–∞—Å—Ç–∏—Ü—ã –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
    setInterval(() => {
        if (this.running && this.settings.particlesEnabled) {
            for (let i = 0; i < 3; i++) {
                setTimeout(() => createParticle(), i * 200);
            }
        }
    }, 1000);
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–ê–†–¢–´ –ì–ê–õ–ê–ö–¢–ò–ö–ò ====================
Game.initGalaxyMap = function() {
    const canvas = document.getElementById('galaxy-map-canvas');
    if (!canvas) return;
    
    this.galaxyMap.canvas = canvas;
    this.galaxyMap.ctx = canvas.getContext('2d');
    this.galaxyMap.viewMode = 'segmentums';  // –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    canvas.addEventListener('click', (e) => this.handleMapClick(e));
    canvas.addEventListener('mousemove', (e) => this.handleMapHover(e));
    canvas.addEventListener('wheel', (e) => {
        e.preventDefault();
        const delta = e.deltaY > 0 ? -0.1 : 0.1;
        this.galaxyMapZoom(delta);
    });
    
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º UI
    this.setMapViewMode('segmentums');
    
    // –ü–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä
    this.renderGalaxyMap();
};

// ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –†–ï–ñ–ò–ú–ê –ö–ê–†–¢–´ ====================
Game.setMapViewMode = function(mode) {
    if (mode !== 'segmentums' && mode !== 'sectors') {
        console.warn('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–∂–∏–º:', mode);
        return;
    }
    
    this.galaxyMap.viewMode = mode;
    
    // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
    document.getElementById('btn-view-segmentums').classList.toggle('active', mode === 'segmentums');
    document.getElementById('btn-view-sectors').classList.toggle('active', mode === 'sectors');
    
    // –û–±–Ω–æ–≤–∏—Ç—å –ª–µ–≥–µ–Ω–¥—É
    document.getElementById('legend-segmentums').style.display = mode === 'segmentums' ? 'block' : 'none';
    document.getElementById('legend-sectors').style.display = mode === 'sectors' ? 'block' : 'none';
    
    // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–≤—è–∑–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ–∫—Ç–æ—Ä–æ–≤)
    const connectionsToggle = document.getElementById('map-connections-toggle');
    if (connectionsToggle) {
        connectionsToggle.style.display = mode === 'sectors' ? 'flex' : 'none';
    }
    
    // –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä
    this.galaxyMap.selectedSegmentum = null;
    this.galaxyMap.selectedSector = null;
    document.getElementById('map-info-panel').style.display = 'none';
    
    this.renderGalaxyMap();
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –ö–ê–†–¢–´ –ì–ê–õ–ê–ö–¢–ò–ö–ò ====================
Game.renderGalaxyMap = function() {
    if (!this.galaxyMap.ctx) return;
    
    const ctx = this.galaxyMap.ctx;
    const canvas = this.galaxyMap.canvas;
    
    // –û—á–∏—Å—Ç–∫–∞
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // –§–æ–Ω - –∑–≤—ë–∑–¥–Ω–æ–µ –ø–æ–ª–µ
    this.renderMapStarfield(ctx, canvas.width, canvas.height);
    
    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (zoom –∏ pan)
    ctx.save();
    ctx.translate(this.galaxyMap.panX, this.galaxyMap.panY);
    ctx.scale(this.galaxyMap.zoom, this.galaxyMap.zoom);
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    const showAstro = document.getElementById('map-show-astro')?.checked !== false;
    const showFleets = document.getElementById('map-show-fleets')?.checked !== false;
    const showConnections = document.getElementById('map-show-connections')?.checked !== false;
    
    if (this.galaxyMap.viewMode === 'segmentums') {
        // –†–µ–∂–∏–º —Å–µ–≥–º–µ–Ω—Ç—É–º–æ–≤
        this.renderSegmentumsView(ctx, showAstro);
    } else {
        // –†–µ–∂–∏–º —Å–µ–∫—Ç–æ—Ä–æ–≤
        this.renderSectorsView(ctx, showAstro, showFleets, showConnections);
    }
    
    ctx.restore();
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –í–ò–î–ê –°–ï–ì–ú–ï–ù–¢–£–ú–û–í ====================
Game.renderSegmentumsView = function(ctx, showAstro) {
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ—Å—è–≥–∞–µ–º–æ—Å—Ç–∏ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞ (–æ—Ç –¢–µ—Ä—Ä—ã)
    if (showAstro) {
        const terra = this.segmentums.find(s => s.id === 1); // –°–æ–ª–∞—Ä
        if (terra) {
            this.renderAstronomicanReach(ctx, terra.coordinates.x, terra.coordinates.y);
        }
    }
    
    // –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç—É–º–∞–º–∏ (–ª–∏–Ω–∏–∏)
    this.renderSegmentumConnections(ctx);
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç—É–º–∞
    this.segmentums.forEach(segmentum => {
        this.renderSegmentum(ctx, segmentum);
    });
    
    // –ú–µ—Ç–∫–∏ —É–≥—Ä–æ–∑
    this.renderSegmentumThreats(ctx);
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –°–í–Ø–ó–ï–ô –°–ï–ì–ú–ï–ù–¢–£–ú–û–í ====================
Game.renderSegmentumConnections = function(ctx) {
    // –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å–µ–≥–º–µ–Ω—Ç—É–º–∞–º–∏
    const connections = [
        [1, 2], // –°–æ–ª–∞—Ä - –û–±—Å–∫—É—Ä—É—Å
        [1, 3], // –°–æ–ª–∞—Ä - –£–ª—å—Ç–∏–º–∞
        [1, 4], // –°–æ–ª–∞—Ä - –¢–µ–º–ø–µ—Å—Ç—É—Å
        [1, 5], // –°–æ–ª–∞—Ä - –ü–∞—Ü–∏—Ñ–∏–∫—É—Å
        [2, 3], // –û–±—Å–∫—É—Ä—É—Å - –£–ª—å—Ç–∏–º–∞
        [2, 5], // –û–±—Å–∫—É—Ä—É—Å - –ü–∞—Ü–∏—Ñ–∏–∫—É—Å
        [3, 4], // –£–ª—å—Ç–∏–º–∞ - –¢–µ–º–ø–µ—Å—Ç—É—Å
        [4, 5]  // –¢–µ–º–ø–µ—Å—Ç—É—Å - –ü–∞—Ü–∏—Ñ–∏–∫—É—Å
    ];
    
    ctx.strokeStyle = 'rgba(100, 100, 100, 0.2)';
    ctx.lineWidth = 2;
    ctx.setLineDash([10, 10]);
    
    connections.forEach(([id1, id2]) => {
        const seg1 = this.segmentums.find(s => s.id === id1);
        const seg2 = this.segmentums.find(s => s.id === id2);
        
        if (seg1 && seg2) {
            ctx.beginPath();
            ctx.moveTo(seg1.coordinates.x, seg1.coordinates.y);
            ctx.lineTo(seg2.coordinates.x, seg2.coordinates.y);
            ctx.stroke();
        }
    });
    
    ctx.setLineDash([]);
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –°–ï–ì–ú–ï–ù–¢–£–ú–ê ====================
Game.renderSegmentum = function(ctx, segmentum) {
    const isHovered = this.galaxyMap.hoveredSector === `seg-${segmentum.id}`;
    const isSelected = this.galaxyMap.selectedSegmentum === segmentum.id;
    
    // –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—Ç–æ—Ä–æ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã
    const sectors = this.sectors.filter(s => s.segmentumId === segmentum.id);
    const threatCount = sectors.filter(s => s.threat).length;
    const warCount = sectors.filter(s => s.status === 'war').length;
    
    // –¶–≤–µ—Ç –æ–±–ª–∞—Å—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç—É–º–∞
    const gradient = ctx.createRadialGradient(
        segmentum.coordinates.x, segmentum.coordinates.y, 0,
        segmentum.coordinates.x, segmentum.coordinates.y, segmentum.size
    );
    
    gradient.addColorStop(0, segmentum.color + '40');
    gradient.addColorStop(0.7, segmentum.color + '20');
    gradient.addColorStop(1, segmentum.color + '00');
    
    // –û–±–ª–∞—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç—É–º–∞
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(segmentum.coordinates.x, segmentum.coordinates.y, segmentum.size, 0, Math.PI * 2);
    ctx.fill();
    
    // –û–±–≤–æ–¥–∫–∞
    if (isHovered || isSelected) {
        ctx.shadowBlur = 30;
        ctx.shadowColor = segmentum.color;
    }
    
    ctx.strokeStyle = isSelected ? '#FFD700' : segmentum.color;
    ctx.lineWidth = isSelected ? 4 : 2;
    ctx.beginPath();
    ctx.arc(segmentum.coordinates.x, segmentum.coordinates.y, segmentum.size, 0, Math.PI * 2);
    ctx.stroke();
    
    ctx.shadowBlur = 0;
    
    // –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç—É–º–∞
    ctx.fillStyle = '#FFFFFF';
    ctx.font = 'bold 16px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(segmentum.name, segmentum.coordinates.x, segmentum.coordinates.y - 10);
    
    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—Ç–æ—Ä–æ–≤
    ctx.font = '12px Arial';
    ctx.fillStyle = '#aaa';
    ctx.fillText(`–°–µ–∫—Ç–æ—Ä–æ–≤: ${sectors.length}`, segmentum.coordinates.x, segmentum.coordinates.y + 10);
    
    // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —É–≥—Ä–æ–∑
    if (threatCount > 0) {
        ctx.fillStyle = warCount > 0 ? '#ff0000' : '#ffaa00';
        ctx.font = 'bold 14px Arial';
        ctx.fillText(`‚ö† ${threatCount}`, segmentum.coordinates.x, segmentum.coordinates.y + 30);
    }
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –£–ì–†–û–ó –°–ï–ì–ú–ï–ù–¢–£–ú–û–í ====================
Game.renderSegmentumThreats = function(ctx) {
    // –ü–æ–∫–∞–∑–∞—Ç—å –∫—Ä—É–ø–Ω—ã–µ —É–≥—Ä–æ–∑—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ–≥–º–µ–Ω—Ç—É–º–æ–≤
    
    // –û–∫–æ –£–∂–∞—Å–∞ (–û–±—Å–∫—É—Ä—É—Å)
    const obscurus = this.segmentums.find(s => s.id === 2);
    if (obscurus) {
        ctx.save();
        ctx.font = '32px Arial';
        ctx.textAlign = 'center';
        ctx.fillStyle = '#6a0dad';
        ctx.shadowBlur = 20;
        ctx.shadowColor = '#6a0dad';
        ctx.fillText('üëÅ', obscurus.coordinates.x - 80, obscurus.coordinates.y - 80);
        ctx.restore();
    }
    
    // –ë–æ–ª—å—à–æ–π —Ä–∞–∑—Ä—ã–≤ (–£–ª—å—Ç–∏–º–∞)
    const ultima = this.segmentums.find(s => s.id === 3);
    if (ultima && this.warp.level > 50) {
        ctx.save();
        ctx.font = '32px Arial';
        ctx.textAlign = 'center';
        ctx.fillStyle = '#6a0dad';
        ctx.shadowBlur = 20;
        ctx.shadowColor = '#6a0dad';
        ctx.fillText('‚ö°', ultima.coordinates.x + 100, ultima.coordinates.y);
        ctx.restore();
    }
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –í–ò–î–ê –°–ï–ö–¢–û–†–û–í ====================
Game.renderSectorsView = function(ctx, showAstro, showFleets, showConnections) {
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ—Å—è–≥–∞–µ–º–æ—Å—Ç–∏ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞ (–æ—Ç –¢–µ—Ä—Ä—ã)
    if (showAstro) {
        const terra = this.sectors.find(s => s.id === 1); // –¢–µ—Ä—Ä–∞
        if (terra) {
            this.renderAstronomicanReach(ctx, terra.coordinates.x, terra.coordinates.y);
        }
    }
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Å–µ–∫—Ç–æ—Ä–∞–º–∏
    if (showConnections) {
        this.renderSectorConnections(ctx);
    }
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–∞—Ä–ø-—à—Ç–æ—Ä–º–æ–≤
    this.renderWarpStorms(ctx);
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–µ–∫—Ç–æ—Ä–æ–≤
    this.sectors.forEach(sector => {
        this.renderSector(ctx, sector);
    });
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ñ–ª–æ—Ç–æ–≤
    if (showFleets) {
        this.renderFleets(ctx);
    }
    
    // –ê–Ω–∏–º–∞—Ü–∏–∏
    this.renderMapAnimations(ctx);
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –ó–í–Å–ó–î–ù–û–ì–û –ü–û–õ–Ø –ö–ê–†–¢–´ ====================
Game.renderMapStarfield = function(ctx, width, height) {
    if (!this.mapStars) {
        this.mapStars = [];
        for (let i = 0; i < 200; i++) {
            this.mapStars.push({
                x: Math.random() * width,
                y: Math.random() * height,
                size: Math.random() * 1.5,
                opacity: 0.3 + Math.random() * 0.7
            });
        }
    }
    
    this.mapStars.forEach(star => {
        ctx.globalAlpha = star.opacity;
        ctx.fillStyle = '#FFFFFF';
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
        ctx.fill();
    });
    ctx.globalAlpha = 1;
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –î–û–°–Ø–ì–ê–ï–ú–û–°–¢–ò –ê–°–¢–†–û–ù–û–ú–ò–ö–û–ù–ê ====================
Game.renderAstronomicanReach = function(ctx, centerX, centerY) {
    const maxReach = 400;
    
    const gradient = ctx.createRadialGradient(
        centerX, centerY, 0,
        centerX, centerY,
        maxReach * (this.astronomican.power / 100)
    );
    
    const alpha = this.astronomican.efficiency / 200;
    gradient.addColorStop(0, `rgba(255, 215, 0, ${alpha * 0.3})`);
    gradient.addColorStop(0.5, `rgba(255, 215, 0, ${alpha * 0.15})`);
    gradient.addColorStop(1, 'rgba(255, 215, 0, 0)');
    
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(
        centerX, centerY,
        maxReach * (this.astronomican.power / 100),
        0, Math.PI * 2
    );
    ctx.fill();
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –°–í–Ø–ó–ï–ô –ú–ï–ñ–î–£ –°–ï–ö–¢–û–†–ê–ú–ò ====================
Game.renderSectorConnections = function(ctx) {
    const drawnConnections = new Set();
    
    this.sectors.forEach(sector => {
        sector.connections.forEach(connId => {
            const targetSector = this.sectors.find(s => s.id === connId);
            if (!targetSector) return;
            
            // –ò–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–∏–Ω–∏–π
            const connectionKey = [sector.id, connId].sort().join('-');
            if (drawnConnections.has(connectionKey)) return;
            drawnConnections.add(connectionKey);
            
            ctx.strokeStyle = 'rgba(100, 100, 100, 0.3)';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(sector.coordinates.x, sector.coordinates.y);
            ctx.lineTo(targetSector.coordinates.x, targetSector.coordinates.y);
            ctx.stroke();
            ctx.setLineDash([]);
        });
    });
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –í–ê–†–ü-–®–¢–û–†–ú–û–í ====================
Game.renderWarpStorms = function(ctx) {
    if (this.warp.storms <= 0) return;
    
    // –í–∞—Ä–ø-—à—Ç–æ—Ä–º—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ –≤ —Å–µ–∫—Ç–æ—Ä–∞—Ö
    const time = Date.now() / 1000;
    
    this.sectors.forEach(sector => {
        if (sector.status === 'war' || Math.random() < 0.1) {
            const stormRadius = 40 + Math.sin(time * 2 + sector.id) * 10;
            
            ctx.strokeStyle = '#6a0dad';
            ctx.lineWidth = 3;
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#6a0dad';
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.arc(sector.coordinates.x, sector.coordinates.y, stormRadius, 0, Math.PI * 2);
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.shadowBlur = 0;
        }
    });
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –°–ï–ö–¢–û–†–ê ====================
Game.renderSector = function(ctx, sector) {
    const isHovered = this.galaxyMap.hoveredSector === sector.id;
    const isSelected = this.galaxyMap.selectedSector === sector.id;
    const radius = isHovered ? 35 : 30;
    
    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –ø–æ —Å—Ç–∞—Ç—É—Å—É
    let color, glowColor;
    switch(sector.status) {
        case 'safe':
            color = '#00ff00';
            glowColor = '#00ff00';
            break;
        case 'threatened':
            color = '#ffaa00';
            glowColor = '#ffaa00';
            break;
        case 'war':
            color = '#ff0000';
            glowColor = '#ff0000';
            break;
        case 'lost':
            color = '#8b0000';
            glowColor = '#8b0000';
            break;
        default:
            color = '#666666';
            glowColor = '#666666';
    }
    
    // –ì—Ä–∞–¥–∏–µ–Ω—Ç —Å–µ–∫—Ç–æ—Ä–∞
    const gradient = ctx.createRadialGradient(
        sector.coordinates.x, sector.coordinates.y, 0,
        sector.coordinates.x, sector.coordinates.y, radius
    );
    gradient.addColorStop(0, color);
    gradient.addColorStop(0.7, color);
    gradient.addColorStop(1, 'rgba(0, 0, 0, 0.5)');
    
    // –°–≤–µ—á–µ–Ω–∏–µ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∏–ª–∏ –Ω–∞–≤–µ–¥—ë–Ω
    if (isHovered || isSelected) {
        ctx.shadowBlur = 30;
        ctx.shadowColor = glowColor;
    }
    
    // –†–∏—Å–æ–≤–∞–Ω–∏–µ –∫—Ä—É–≥–∞ —Å–µ–∫—Ç–æ—Ä–∞
    ctx.fillStyle = gradient;
    ctx.beginPath();
    ctx.arc(sector.coordinates.x, sector.coordinates.y, radius, 0, Math.PI * 2);
    ctx.fill();
    
    // –û–±–≤–æ–¥–∫–∞
    ctx.strokeStyle = isSelected ? '#FFD700' : color;
    ctx.lineWidth = isSelected ? 3 : 2;
    ctx.stroke();
    
    ctx.shadowBlur = 0;
    
    // –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ–∫—Ç–æ—Ä–∞
    ctx.fillStyle = '#FFFFFF';
    ctx.font = 'bold 12px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(sector.id.toString(), sector.coordinates.x, sector.coordinates.y);
    
    // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    if (sector.stability < 100) {
        const barWidth = 40;
        const barHeight = 4;
        const barX = sector.coordinates.x - barWidth / 2;
        const barY = sector.coordinates.y + radius + 10;
        
        ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
        ctx.fillRect(barX, barY, barWidth, barHeight);
        
        const stabilityColor = sector.stability > 70 ? '#00ff00' : 
                               sector.stability > 40 ? '#ffaa00' : '#ff0000';
        ctx.fillStyle = stabilityColor;
        ctx.fillRect(barX, barY, barWidth * (sector.stability / 100), barHeight);
    }
    
    // –ò–∫–æ–Ω–∫–∞ —É–≥—Ä–æ–∑—ã
    if (sector.threat) {
        const iconMap = {
            'chaos': '‚ò†',
            'tyranids': 'üëæ',
            'necrons': 'üíÄ',
            'orks': '‚öî',
            'tau': 'üîµ',
            'eldar': '‚ú®'
        };
        
        ctx.font = '20px Arial';
        ctx.fillText(
            iconMap[sector.threat] || '‚ö†',
            sector.coordinates.x,
            sector.coordinates.y - radius - 15
        );
    }

    const sectorModifiers = this.modifiers.active.filter(m => 
            m.effects.sectorThreat && m.affectedSector === sector.id
    );
    
    if (sectorModifiers.length > 0) {
        ctx.font = '24px Arial';
        ctx.fillText('‚ö†Ô∏è', sector.coordinates.x, sector.coordinates.y - 50);
    }

};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –§–õ–û–¢–û–í ====================
Game.renderFleets = function(ctx) {
    this.sectors.forEach(sector => {
        if (!sector.fleets) return;
        
        const totalFleets = sector.fleets.imperial + sector.fleets.enemy;
        if (totalFleets === 0) return;
        
        const fleetRadius = 8;
        const offset = 45;
        
        // –ò–º–ø–µ—Ä—Å–∫–∏–µ —Ñ–ª–æ—Ç—ã (–∑–µ–ª—ë–Ω—ã–µ)
        if (sector.fleets.imperial > 0) {
            ctx.fillStyle = '#00ff00';
            ctx.beginPath();
            ctx.arc(
                sector.coordinates.x - offset,
                sector.coordinates.y,
                fleetRadius,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            ctx.fillStyle = '#000';
            ctx.font = 'bold 10px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(
                Math.floor(sector.fleets.imperial).toString(),
                sector.coordinates.x - offset,
                sector.coordinates.y
            );
        }
        
        // –í—Ä–∞–∂–µ—Å–∫–∏–µ —Ñ–ª–æ—Ç—ã (–∫—Ä–∞—Å–Ω—ã–µ)
        if (sector.fleets.enemy > 0) {
            ctx.fillStyle = '#ff0000';
            ctx.beginPath();
            ctx.arc(
                sector.coordinates.x + offset,
                sector.coordinates.y,
                fleetRadius,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 10px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(
                Math.floor(sector.fleets.enemy).toString(),
                sector.coordinates.x + offset,
                sector.coordinates.y
            );
        }
    });
};

// ==================== –ê–ù–ò–ú–ê–¶–ò–ò –ö–ê–†–¢–´ ====================
Game.renderMapAnimations = function(ctx) {
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Ñ–ª–æ—Ç–æ–≤,
    // –≤–∞—Ä–ø-–ø—Ä—ã–∂–∫–æ–≤, –æ—Ä–±–∏—Ç–∞–ª—å–Ω—ã—Ö –±–æ–º–±–∞—Ä–¥–∏—Ä–æ–≤–æ–∫ –∏ —Ç.–¥.
};

// ==================== –û–ë–†–ê–ë–û–¢–ö–ê –ö–õ–ò–ö–ê –ù–ê –ö–ê–†–¢–£ ====================
Game.handleMapClick = function(event) {
    const canvas = this.galaxyMap.canvas;
    const rect = canvas.getBoundingClientRect();
    const x = (event.clientX - rect.left - this.galaxyMap.panX) / this.galaxyMap.zoom;
    const y = (event.clientY - rect.top - this.galaxyMap.panY) / this.galaxyMap.zoom;
    
    if (this.galaxyMap.viewMode === 'segmentums') {
        // –ö–ª–∏–∫ –ø–æ —Å–µ–≥–º–µ–Ω—Ç—É–º—É
        let clickedSegmentum = null;
        
        for (const segmentum of this.segmentums) {
            const dx = x - segmentum.coordinates.x;
            const dy = y - segmentum.coordinates.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < segmentum.size) {
                clickedSegmentum = segmentum;
                break;
            }
        }
        
        if (clickedSegmentum) {
            this.galaxyMap.selectedSegmentum = clickedSegmentum.id;
            this.showSegmentumInfo(clickedSegmentum);
            this.renderGalaxyMap();
        }
    } else {
        // –ö–ª–∏–∫ –ø–æ —Å–µ–∫—Ç–æ—Ä—É
        let clickedSector = null;
        
        for (const sector of this.sectors) {
            const dx = x - sector.coordinates.x;
            const dy = y - sector.coordinates.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 35) {
                clickedSector = sector;
                break;
            }
        }
        
        if (clickedSector) {
            this.galaxyMap.selectedSector = clickedSector.id;
            this.showSectorInfo(clickedSector);
            this.renderGalaxyMap();
        }
    }
};

// ==================== –û–ë–†–ê–ë–û–¢–ö–ê –ù–ê–í–ï–î–ï–ù–ò–Ø ====================
Game.handleMapHover = function(event) {
    const canvas = this.galaxyMap.canvas;
    const rect = canvas.getBoundingClientRect();
    const x = (event.clientX - rect.left - this.galaxyMap.panX) / this.galaxyMap.zoom;
    const y = (event.clientY - rect.top - this.galaxyMap.panY) / this.galaxyMap.zoom;
    
    let hoveredId = null;
    
    if (this.galaxyMap.viewMode === 'segmentums') {
        for (const segmentum of this.segmentums) {
            const dx = x - segmentum.coordinates.x;
            const dy = y - segmentum.coordinates.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < segmentum.size) {
                hoveredId = `seg-${segmentum.id}`;
                break;
            }
        }
    } else {
        for (const sector of this.sectors) {
            const dx = x - sector.coordinates.x;
            const dy = y - sector.coordinates.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance < 35) {
                hoveredId = sector.id;
                break;
            }
        }
    }
    
    if (this.galaxyMap.hoveredSector !== hoveredId) {
        this.galaxyMap.hoveredSector = hoveredId;
        this.renderGalaxyMap();
    }
};

// ==================== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –°–ï–ì–ú–ï–ù–¢–£–ú–ï ====================
Game.showSegmentumInfo = function(segmentum) {
    const panel = document.getElementById('map-info-panel');
    if (!panel) return;
    
    const nameEl = document.getElementById('map-info-name');
    const detailsEl = document.getElementById('map-info-details');
    const actionsEl = document.getElementById('map-info-actions');
    
    nameEl.textContent = segmentum.name;
    
    // –ü–æ–ª—É—á–∏—Ç—å —Å–µ–∫—Ç–æ—Ä—ã —Å–µ–≥–º–µ–Ω—Ç—É–º–∞
    const sectors = this.sectors.filter(s => s.segmentumId === segmentum.id);
    const totalFleets = sectors.reduce((sum, s) => sum + (s.fleets?.imperial || 0), 0);
    const totalEnemies = sectors.reduce((sum, s) => sum + (s.fleets?.enemy || 0), 0);
    const avgStability = sectors.reduce((sum, s) => sum + s.stability, 0) / sectors.length;
    const threats = sectors.filter(s => s.threat);
    
    detailsEl.innerHTML = `
        <div style="margin: 5px 0; color: #aaa;">
            ${segmentum.description}
        </div>
        <div style="margin: 10px 0; padding-top: 10px; border-top: 1px solid #444;">
            <div style="margin: 5px 0;">
                <strong>–°–µ–∫—Ç–æ—Ä–æ–≤:</strong> ${sectors.length}
            </div>
            <div style="margin: 5px 0;">
                <strong>–°—Ä–µ–¥–Ω—è—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> ${Math.floor(avgStability)}%
            </div>
            <div style="margin: 5px 0;">
                <strong>–§–ª–æ—Ç –ò–º–ø–µ—Ä–∏—É–º–∞:</strong> ${Math.floor(totalFleets)}
            </div>
            ${totalEnemies > 0 ? `
            <div style="margin: 5px 0; color: #ff0000;">
                <strong>–í—Ä–∞–∂–µ—Å–∫–∏–µ —Å–∏–ª—ã:</strong> ${Math.floor(totalEnemies)}
            </div>
            ` : ''}
            ${threats.length > 0 ? `
            <div style="margin: 5px 0; color: #ff4500;">
                <strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö —É–≥—Ä–æ–∑:</strong> ${threats.length}
            </div>
            ` : ''}
        </div>
    `;
    
    // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
    actionsEl.innerHTML = '';
    
    // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º —Å–µ–∫—Ç–æ—Ä–æ–≤
    const btnViewSectors = document.createElement('button');
    btnViewSectors.className = 'button';
    btnViewSectors.textContent = 'üó∫Ô∏è –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ç–æ—Ä—ã';
    btnViewSectors.style.gridColumn = '1 / -1';
    btnViewSectors.onclick = () => {
        this.setMapViewMode('sectors');
    };
    actionsEl.appendChild(btnViewSectors);
    
    panel.style.display = 'block';
};

// ==================== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –°–ï–ö–¢–û–†–ï ====================
Game.showSectorInfo = function(sector) {
    const panel = document.getElementById('map-info-panel');
    if (!panel) return;
    
    const nameEl = document.getElementById('map-info-name');
    const detailsEl = document.getElementById('map-info-details');
    const actionsEl = document.getElementById('map-info-actions');
    
    // –ü–æ–ª—É—á–∏—Ç—å —Å–µ–≥–º–µ–Ω—Ç—É–º
    const segmentum = this.segmentums.find(s => s.id === sector.segmentumId);
    
    nameEl.textContent = sector.name;
    
    const statusText = {
        'safe': '–ë–µ–∑–æ–ø–∞—Å–Ω–æ',
        'threatened': '–ü–æ–¥ —É–≥—Ä–æ–∑–æ–π',
        'war': '–ò–¥—ë—Ç –≤–æ–π–Ω–∞',
        'lost': '–ü–æ—Ç–µ—Ä—è–Ω–æ'
    };
    
    detailsEl.innerHTML = `
        <div style="margin: 5px 0; color: #888;">
            ${segmentum ? segmentum.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç—É–º'}
        </div>
        <div style="margin: 10px 0; padding-top: 10px; border-top: 1px solid #444;">
            <div style="margin: 5px 0;">
                <strong>–°—Ç–∞—Ç—É—Å:</strong> 
                <span style="color: ${sector.status === 'safe' ? '#00ff00' : sector.status === 'threatened' ? '#ffaa00' : '#ff0000'};">
                    ${statusText[sector.status]}
                </span>
            </div>
            <div style="margin: 5px 0;">
                <strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:</strong> ${Math.floor(sector.stability)}%
            </div>
            <div style="margin: 5px 0;">
                <strong>–ù–∞—Å–µ–ª–µ–Ω–∏–µ:</strong> ${sector.population} –º–ª—Ä–¥
            </div>
            <div style="margin: 5px 0;">
                <strong>–§–ª–æ—Ç –ò–º–ø–µ—Ä–∏—É–º–∞:</strong> ${Math.floor(sector.fleets?.imperial || 0)}
            </div>
            ${sector.fleets?.enemy > 0 ? `
            <div style="margin: 5px 0; color: #ff0000;">
                <strong>–í—Ä–∞–∂–µ—Å–∫–∏–µ —Å–∏–ª—ã:</strong> ${Math.floor(sector.fleets.enemy)}
            </div>
            ` : ''}
            ${sector.threat ? `
            <div style="margin: 5px 0; color: #ff4500;">
                <strong>–£–≥—Ä–æ–∑–∞:</strong> ${sector.threat}
            </div>
            ` : ''}
            ${sector.specialFeatures && sector.specialFeatures.length > 0 ? `
            <div style="margin: 10px 0; padding-top: 10px; border-top: 1px solid #444;">
                <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong>
                <div style="font-size: 0.85em; color: #aaa; margin-top: 5px;">
                    ${sector.specialFeatures.map(f => `‚Ä¢ ${f}`).join('<br>')}
                </div>
            </div>
            ` : ''}
        </div>
    `;
    
    // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
    actionsEl.innerHTML = '';
    
    if (sector.status === 'threatened' || sector.status === 'war') {
        const btn = document.createElement('button');
        btn.className = 'button';
        btn.textContent = '‚öî –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–ª–æ—Ç';
        btn.onclick = () => this.sendFleetToSector(sector.id);
        actionsEl.appendChild(btn);
    }
    
    if (sector.stability < 70) {
        const btn = document.createElement('button');
        btn.className = 'button';
        btn.textContent = 'üõ° –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å';
        btn.onclick = () => this.stabilizeSectorFromMap(sector.id);
        actionsEl.appendChild(btn);
    }
    
    panel.style.display = 'block';
};

// ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ú–ê–°–®–¢–ê–ë–û–ú ====================
Game.galaxyMapZoom = function(delta) {
    this.galaxyMap.zoom = Math.max(0.5, Math.min(2.0, this.galaxyMap.zoom + delta));
    this.renderGalaxyMap();
};

Game.galaxyMapReset = function() {
    this.galaxyMap.zoom = 1.0;
    this.galaxyMap.panX = 0;
    this.galaxyMap.panY = 0;
    this.renderGalaxyMap();
};

Game.updateGalaxyMap = function() {
    this.renderGalaxyMap();
};

// ==================== –î–ï–ô–°–¢–í–ò–Ø –ù–ê –ö–ê–†–¢–ï ====================
Game.sendFleetToSector = function(sectorId) {
    const sector = this.sectors.find(s => s.id === sectorId);
    if (!sector) return;
    
    const cost = 1000;
    const fleetSize = 20;
    
    if (this.resources.credits < cost) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–ª–æ—Ç–∞!', 'warning');
        return;
    }
    
    if (this.resources.fleet < fleetSize) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–æ—Ä–∞–±–ª–µ–π!', 'warning');
        return;
    }
    
    this.resources.credits -= cost;
    this.resources.fleet -= fleetSize;
    
    if (!sector.fleets) sector.fleets = { imperial: 0, enemy: 0 };
    sector.fleets.imperial += fleetSize;
    
    this.log(`–§–ª–æ—Ç –∏–∑ ${fleetSize} –∫–æ—Ä–∞–±–ª–µ–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ ${sector.name}`, 'success');
    this.notify(`–§–ª–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ ${sector.name}!`, 'success');
    
    this.renderGalaxyMap();
    this.updateUI();
};

Game.stabilizeSectorFromMap = function(sectorId) {
    const sector = this.sectors.find(s => s.id === sectorId);
    if (!sector) return;
    
    const cost = 500;
    
    if (this.resources.credits < cost) {
        this.notify('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤!', 'warning');
        return;
    }
    
    this.resources.credits -= cost;
    sector.stability = Math.min(100, sector.stability + 20);
    
    this.log(`–°–µ–∫—Ç–æ—Ä ${sector.name} —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω`, 'success');
    this.notify(`${sector.name} —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω!`, 'success');
    
    this.renderGalaxyMap();
    this.showSectorInfo(sector);
    this.updateUI();
};

// ==================== –°–û–•–†–ê–ù–ï–ù–ò–ï –ò–ì–†–´ ====================
Game.save = function() {
    try {
        const saveData = {
            version: this.version,
            timestamp: Date.now(),
            day: this.day,
            running: this.running,
            resources: this.resources,
            personnel: this.personnel,
            astronomican: {
                efficiency: this.astronomican.efficiency,
                stability: this.astronomican.stability
            },
            warp: this.warp,
            sectors: this.sectors,
            research: this.research,
            upgrades: this.upgrades,
            achievements: this.achievements,
            stats: this.stats,
            missions: this.missions,
            settings: this.settings,
            panelStates: this.panelStates || {}
        };
        
        localStorage.setItem('astronomican_save', JSON.stringify(saveData));
        
        // –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        this.showSaveIndicator();
        
        console.log('üíæ –ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞');
        return true;
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
        this.notify('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!', 'critical');
        return false;
    }
};

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
Game.showSaveIndicator = function() {
    // –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    let indicator = document.getElementById('save-indicator');
    if (!indicator) {
        indicator = document.createElement('div');
        indicator.id = 'save-indicator';
        indicator.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: var(--imperial-gold);
            padding: 10px 20px;
            border: 2px solid var(--imperial-gold);
            border-radius: 4px;
            font-family: Orbitron, monospace;
            font-size: 0.9em;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
        `;
        indicator.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
        document.body.appendChild(indicator);
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    indicator.style.opacity = '1';
    
    // –°–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        indicator.style.opacity = '0';
    }, 2000);
};

// ==================== –ê–í–¢–û–°–û–•–†–ê–ù–ï–ù–ò–ï ====================
Game.autoSave = function() {
    if (!this.settings.autoSave || this.gameOver) return;
    
    this.save();
    console.log('üíæ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ');
};

// ==================== –ó–ê–ì–†–£–ó–ö–ê –ò–ì–†–´ ====================
Game.load = function() {
    try {
        const saveData = localStorage.getItem('astronomican_save');
        
        if (!saveData) {
            this.notify('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!', 'warning');
            return false;
        }
        
        const data = JSON.parse(saveData);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏
        if (data.version !== this.version) {
            console.warn('‚ö†Ô∏è –í–µ—Ä—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç');
        }
        
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        this.day = data.day || 1;
        this.hour = data.hour || 0;
        
        this.resources = { ...data.resources };
        this.resourceChanges = { ...data.resourceChanges };
        
        this.astronomican = { ...data.astronomican };
        this.warp = { ...data.warp, rifts: [] };
        
        this.stats = { ...data.stats };
        
        this.sectors = data.sectors.map(s => ({ ...s }));
        this.personnel = JSON.parse(JSON.stringify(data.personnel));
        
        this.research = {
            current: data.research.current ? { ...data.research.current } : null,
            progress: data.research.progress || 0,
            completed: [...(data.research.completed || [])]
        };
        
        this.upgrades = { ...data.upgrades };
        this.enemies = JSON.parse(JSON.stringify(data.enemies));
        
        this.missions = data.missions ? data.missions.map(m => ({ ...m })) : [];
        this.achievements = data.achievements ? data.achievements.map(a => ({ ...a })) : this.achievements;
        
        this.lastEventDay = data.lastEventDay || 0;
        
        if (data.settings) {
            this.settings = { ...this.settings, ...data.settings };
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        this.updateUI();
        this.renderSectors();
        this.renderAchievements();
        
        this.log('–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.', 'success');
        this.notify('–ò–≥—Ä–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!', 'success');
        
        console.log('üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞');
        return true;
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
        this.notify('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–≥—Ä—ã!', 'critical');
        return false;
    }
};

// ==================== –†–ï–ù–î–ï–†–ò–ù–ì –î–û–°–¢–ò–ñ–ï–ù–ò–ô ====================
Game.renderAchievements = function() {
    const container = document.getElementById('achievements-grid');
    if (!container) return;
    
    container.innerHTML = '';
    
    this.achievements.forEach(achievement => {
        const card = document.createElement('div');
        card.className = 'card' + (achievement.unlocked ? '' : ' locked');
        
        card.innerHTML = `
            <div class="card-header">
                <div class="card-title">
                    ${achievement.icon} ${achievement.name}
                </div>
                ${achievement.unlocked ? '<div class="card-level" style="background: var(--success-green);">‚úì</div>' : ''}
            </div>
            <div class="card-desc">${achievement.description}</div>
            ${!achievement.unlocked ? `
                <div style="text-align: center; padding: 10px; color: #666; margin-top: 15px;">
                    üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
                </div>
            ` : `
                <div style="text-align: center; padding: 10px; color: var(--gold); margin-top: 15px; background: rgba(212,175,55,0.1); border-radius: 4px;">
                    ‚úì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!
                </div>
            `}
        `;
        
        container.appendChild(card);
    });
};

// ==================== –ü–†–û–í–ï–†–ö–ê GAME OVER ====================
Game.checkGameOver = function() {
    // –£—Å–ª–æ–≤–∏—è –ø—Ä–æ–∏–≥—Ä—ã—à–∞
    const conditions = [];
    
    // –ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑—Ä—É—à–µ–Ω
    if (this.astronomican.throneCondition <= 0) {
        conditions.push('–ó–æ–ª–æ—Ç–æ–π –¢—Ä–æ–Ω —Ä–∞–∑—Ä—É—à–µ–Ω');
    }
    
    // –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –ø–æ–≥–∞—Å
    if (this.astronomican.power <= 0) {
        conditions.push('–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –ø–æ–≥–∞—Å');
    }
    
    // –í—Å–µ —Å–µ–∫—Ç–æ—Ä—ã –ø–æ—Ç–µ—Ä—è–Ω—ã
    const controlledSectors = this.sectors.filter(s => s.status !== 'lost').length;
    if (controlledSectors === 0) {
        conditions.push('–í—Å–µ —Å–µ–∫—Ç–æ—Ä—ã –ò–º–ø–µ—Ä–∏—É–º–∞ –ø–æ—Ç–µ—Ä—è–Ω—ã');
    }
    
    // –í–∞—Ä–ø –ø–æ–≥–ª–æ—Ç–∏–ª –¢–µ—Ä—Ä—É
    if (this.warp.level >= 100) {
        conditions.push('–í–∞—Ä–ø –ø–æ–≥–ª–æ—Ç–∏–ª –°–≤—è—â–µ–Ω–Ω—É—é –¢–µ—Ä—Ä—É');
    }
    
    // –ï—Å–ª–∏ –µ—Å—Ç—å —É—Å–ª–æ–≤–∏—è –ø—Ä–æ–∏–≥—Ä—ã—à–∞
    if (conditions.length > 0) {
        this.triggerGameOver(conditions);
    }
};

// ==================== GAME OVER ====================
Game.triggerGameOver = function(reasons) {
    this.gameOver = true;
    this.running = false;
    
    console.log('‚ò†Ô∏è GAME OVER');
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ Game Over
    const modal = document.getElementById('modal-gameover');
    const statsContainer = document.getElementById('gameover-stats');
    
    statsContainer.innerHTML = `
        <div style="background: rgba(139,0,0,0.2); padding: 20px; border: 2px solid var(--critical-red); border-radius: 4px; margin-bottom: 20px;">
            <h3 style="color: var(--critical-red); margin-bottom: 15px;">–ü—Ä–∏—á–∏–Ω—ã –ø–∞–¥–µ–Ω–∏—è:</h3>
            ${reasons.map(r => `<div style="margin: 5px 0;">‚Ä¢ ${r}</div>`).join('')}
        </div>
        
        <div class="stats-grid">
            <div class="stat-box">
                <span class="stat-label">–î–Ω–µ–π –ø—Ä–æ—Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª –ò–º–ø–µ—Ä–∏—É–º</span>
                <span class="stat-number">${this.day}</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–ñ–µ—Ä—Ç–≤ –ø—Ä–∏–Ω–µ—Å–µ–Ω–æ</span>
                <span class="stat-number">${Math.floor(this.stats.totalSacrifices)}</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–ö—Ä–µ–¥–∏—Ç–æ–≤ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</span>
                <span class="stat-number">${Math.floor(this.stats.totalCreditsEarned)}</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–í—Ä–∞–≥–æ–≤ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–æ</span>
                <span class="stat-number">${this.stats.enemiesKilled}</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–ú–∏—Å—Å–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ</span>
                <span class="stat-number">${this.stats.missionsCompleted}</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ</span>
                <span class="stat-number">${this.stats.researchCompleted}</span>
            </div>
        </div>
    `;
    
    modal.style.display = 'flex';
    
    this.log('‚ò†Ô∏è –ò–ú–ü–ï–†–ò–£–ú –ü–ê–õ!', 'critical');
};

// ==================== –ü–ï–†–ï–ó–ê–ü–£–°–ö –ò–ì–†–´ ====================
Game.restart = function() {
    console.log('üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã...');
    
    // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    document.getElementById('modal-gameover').style.display = 'none';
    
    // –°–±—Ä–æ—Å –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    this.day = 1;
    this.hour = 0;
    this.gameOver = false;
    
    // –†–µ—Å—É—Ä—Å—ã
    this.resources = {
        psychic: 5000,
        credits: 10000,
        population: 1000,
        military: 100,
        fleet: 50,
        techpriests: 10
    };
    
    this.resourceChanges = {
        psychic: -1000,
        credits: 100,
        population: 1,
        military: 0.5,
        fleet: 0,
        techpriests: 0
    };
    
    // –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω
    this.astronomican = {
        power: 100,
        stability: 100,
        throneCondition: 100,
        sacrificeRate: 1000,
        efficiency: 100,
        emergencyMode: false,
        emergencyTurns: 0
    };
    
    // –í–∞—Ä–ø
    this.warp = {
        level: 25,
        storms: 0,
        rifts: [],
        demonThreat: 10,
        chaosIncursions: 0
    };
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    this.stats = {
        totalSacrifices: 0,
        totalCreditsEarned: 0,
        enemiesKilled: 0,
        missionsCompleted: 0,
        sectorsLost: 0,
        projectsCompleted: 0,
        researchCompleted: 0
    };
    
    // –°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
    this.initializeSectors();
    this.initializePersonnel();
    this.initializeResearch();
    this.initializeUpgrades();
    this.initializeAchievements();
    
    // –°–±—Ä–æ—Å–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ –º–∏—Å—Å–∏–∏
    this.research = {
        current: null,
        progress: 0,
        completed: []
    };
    
    this.missions = [];
    this.lastEventDay = 0;
    
    // –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥
    this.clearLog();
    
    // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    this.updateUI();
    this.renderSectors();
    this.renderAchievements();
    
    // –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É
    this.running = true;
    this.lastTick = Date.now();
    
    this.log('–ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω. –ò–º–ø–µ—Ä–∏—É–º –≤–æ–∑—Ä–æ–∂–¥–∞–µ—Ç—Å—è.', 'success');
    this.notify('–ò–≥—Ä–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞!', 'success');
    
    console.log('‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω');
};

// ==================== –ü–û–ö–ê–ó –ù–ê–°–¢–†–û–ï–ö ====================
Game.showSettings = function() {
    const modal = document.getElementById('modal-info');
    const title = document.getElementById('info-title');
    const content = document.getElementById('info-content');
    
    title.textContent = '–ù–∞—Å—Ç—Ä–æ–π–∫–∏';
    
    content.innerHTML = `
        <div style="margin-bottom: 20px;">
            <h3 style="color: var(--gold); margin-bottom: 15px;">–ò–≥—Ä–∞</h3>
            
            <div style="margin: 15px 0;">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="checkbox" id="setting-autosave" 
                           ${this.settings.autoSave ? 'checked' : ''}
                           onchange="Game.toggleAutoSave()"
                           style="margin-right: 10px; width: 20px; height: 20px;">
                    <span>–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)</span>
                </label>
            </div>
            
            <div style="margin: 15px 0;">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="checkbox" id="setting-particles" 
                           ${this.settings.particlesEnabled ? 'checked' : ''}
                           onchange="Game.toggleParticles()"
                           style="margin-right: 10px; width: 20px; height: 20px;">
                    <span>–ß–∞—Å—Ç–∏—Ü—ã (–≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã)</span>
                </label>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: var(--gold); margin-bottom: 15px;">–°–ª–æ–∂–Ω–æ—Å—Ç—å</h3>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                <button class="button ${this.settings.difficulty === 'easy' ? 'success' : ''}" 
                        onclick="Game.setDifficulty('easy')">
                    –õ—ë–≥–∫–∞—è
                </button>
                <button class="button ${this.settings.difficulty === 'normal' ? 'success' : ''}" 
                        onclick="Game.setDifficulty('normal')">
                    –°—Ä–µ–¥–Ω—è—è
                </button>
                <button class="button ${this.settings.difficulty === 'hard' ? 'success' : ''}" 
                        onclick="Game.setDifficulty('hard')">
                    –°–ª–æ–∂–Ω–∞—è
                </button>
                <button class="button ${this.settings.difficulty === 'nightmare' ? 'success' : ''}" 
                        onclick="Game.setDifficulty('nightmare')">
                    –ö–æ—à–º–∞—Ä
                </button>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h3 style="color: var(--gold); margin-bottom: 15px;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="metric">
                <span>–í–µ—Ä—Å–∏—è –∏–≥—Ä—ã:</span>
                <span style="color: var(--gold);">${this.version}</span>
            </div>
            <div class="metric">
                <span>–°–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã:</span>
                <span style="color: var(--gold);">${this.tickSpeed}ms/—Ç–∏–∫</span>
            </div>
        </div>
        
        <div>
            <h3 style="color: var(--gold); margin-bottom: 15px;">–î–µ–π—Å—Ç–≤–∏—è</h3>
            <div class="button-group">
                <button class="button" onclick="Game.exportSave()">
                    –≠–∫—Å–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                </button>
                <button class="button" onclick="Game.importSave()">
                    –ò–º–ø–æ—Ä—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                </button>
                <button class="button danger" onclick="Game.confirmReset()">
                    –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É
                </button>
            </div>
        </div>
    `;
    
    modal.style.display = 'flex';
};

// ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
Game.toggleAutoSave = function() {
    this.settings.autoSave = document.getElementById('setting-autosave').checked;
    this.notify('–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ' + (this.settings.autoSave ? '–≤–∫–ª—é—á–µ–Ω–æ' : '–≤—ã–∫–ª—é—á–µ–Ω–æ'), 'info');
};

Game.toggleParticles = function() {
    this.settings.particlesEnabled = document.getElementById('setting-particles').checked;
    this.notify('–ß–∞—Å—Ç–∏—Ü—ã ' + (this.settings.particlesEnabled ? '–≤–∫–ª—é—á–µ–Ω—ã' : '–≤—ã–∫–ª—é—á–µ–Ω—ã'), 'info');
};

Game.setDifficulty = function(difficulty) {
    this.settings.difficulty = difficulty;
    
    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    switch(difficulty) {
        case 'easy':
            this.resourceChanges.credits = 150;
            this.astronomican.efficiency = 110;
            break;
        case 'normal':
            this.resourceChanges.credits = 100;
            this.astronomican.efficiency = 100;
            break;
        case 'hard':
            this.resourceChanges.credits = 75;
            this.astronomican.efficiency = 90;
            break;
        case 'nightmare':
            this.resourceChanges.credits = 50;
            this.astronomican.efficiency = 80;
            this.warp.level += 10;
            break;
    }
    
    this.notify(`–°–ª–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: ${difficulty}`, 'info');
    this.showSettings(); // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
};

Game.exportSave = function() {
    const saveData = localStorage.getItem('astronomican_save');
    if (!saveData) {
        this.notify('–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞!', 'warning');
        return;
    }
    
    const blob = new Blob([saveData], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `astronomican_save_${Date.now()}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    this.notify('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ!', 'success');
};

Game.importSave = function() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';
    
    input.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (event) => {
            try {
                const saveData = event.target.result;
                localStorage.setItem('astronomican_save', saveData);
                this.load();
                this.notify('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ!', 'success');
                this.closeModal('info');
            } catch (error) {
                this.notify('–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞!', 'critical');
            }
        };
        reader.readAsText(file);
    };
    
    input.click();
};

Game.confirmReset = function() {
    if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—é –∏–≥—Ä—É? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')) {
        localStorage.removeItem('astronomican_save');
        this.restart();
        this.closeModal('info');
        this.notify('–ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞!', 'success');
    }
};

Game.renderAdvancedStats = function() {
    const content = document.getElementById('advanced-stats-content');
    if (!content) return;
    
    const avgEfficiency = this.stats.totalSacrifices > 0 
        ? (this.astronomican.efficiency / this.stats.totalSacrifices).toFixed(2)
        : 0;
    
    const sectorsControlled = this.sectors.filter(s => s.controlled).length;
    const sectorsLost = 8 - sectorsControlled;
    
    const survivalRate = this.day > 0 
        ? ((this.day - this.stats.sectorsLost) / this.day * 100).toFixed(1)
        : 100;
    
    content.innerHTML = `
        <div class="stats-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div class="stat-card">
                <div class="stat-label">–°—Ä–µ–¥–Ω—è—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
                <div class="stat-value">${avgEfficiency}%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤—ã–∂–∏–≤–∞–Ω–∏—è</div>
                <div class="stat-value">${survivalRate}%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ö—Ä–µ–¥–∏—Ç–æ–≤ –Ω–∞ –¥–µ–Ω—å</div>
                <div class="stat-value">${this.day > 0 ? Math.floor(this.stats.totalCreditsEarned / this.day) : 0}</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ñ–µ—Ä—Ç–≤ –Ω–∞ –¥–µ–Ω—å</div>
                <div class="stat-value">${this.day > 0 ? (this.stats.totalSacrifices / this.day).toFixed(2) : 0}</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–°–µ–∫—Ç–æ—Ä–æ–≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è</div>
                <div class="stat-value" style="color: var(--success-green)">${sectorsControlled}/8</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–°–µ–∫—Ç–æ—Ä–æ–≤ –ø–æ—Ç–µ—Ä—è–Ω–æ</div>
                <div class="stat-value" style="color: var(--critical-red)">${sectorsLost}/8</div>
            </div>
        </div>
    `;
};

// ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª
Game.formatNumber = function(num) {
    if (num >= 1000000000) {
        return (num / 1000000000).toFixed(1) + 'B';
    } else if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
    } else if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
    }
    return Math.floor(num).toString();
};

// –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞
Game.randomChoice = function(array) {
    return array[Math.floor(Math.random() * array.length)];
};

// –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
Game.randomRange = function(min, max) {
    return Math.random() * (max - min) + min;
};

// –°–ª—É—á–∞–π–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
Game.randomInt = function(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
};

// –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (0-100)
Game.chance = function(percent) {
    return Math.random() * 100 < percent;
};

// ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –°–¢–†–ê–ù–ò–¶–´ ====================
window.addEventListener('DOMContentLoaded', function() {
    console.log('üåü –ó–∞–ø—É—Å–∫ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏–∫–æ–Ω–∞...');
    
    // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    setTimeout(() => {
        Game.init();
    }, 100);
});

// ==================== –û–ë–†–ê–ë–û–¢–ö–ê –ó–ê–ö–†–´–¢–ò–Ø –°–¢–†–ê–ù–ò–¶–´ ====================
window.addEventListener('beforeunload', function(e) {
    if (Game.settings.autoSave && Game.running && !Game.gameOver) {
        Game.save();
    }
});



</script>
</body>
</html>
